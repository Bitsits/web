var urls=new Array("http://twitter.com","http://tweetmeme.com");var timer=0;setInterval(function(){timer++},1000);var Cookie={create:function(name,value,days){if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires="; expires="+date.toGMTString()}else{var expires=""}document.cookie=name+"="+value+expires+"path=/;domain=tweetmeme.com"},erase:function(name){this.create(name,"",-1)},read:function(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1,c.length)}if(c.indexOf(nameEQ)==0){return c.substring(nameEQ.length,c.length)}}return null}};var tweet=document.getElementsByTagName("div")[1];var a=document.getElementsByTagName("a");if(a[0].innerHTML!="?"){if(Cookie.read("user")!=null&&Cookie.read("user_token")!=null){var tweets=read();var clickfunction=function(e){e=e||window.event;if(e&&e.preventDefault){e.preventDefault()}else{window.event.returnValue=false}sendrequest(tweet.id)};a[1].onclick=clickfunction;for(var i=0;i<tweets.length;i++){if(tweets[i]==tweet.id.substr(1)){disable()}}}else{addEvent(a[1],"mousedown",tracking)}}function disable(){a[1].className="retweet selected";a[1].innerHTML="tweeted";var clickfunction=function(e){e=e||window.event;if(e&&e.preventDefault){e.preventDefault()}else{window.event.returnValue=false}};a[1].onclick=clickfunction}function read(){var data=Cookie.read("tweetmeme_tweeted");if(data!=null){return data.split("-")}else{return new Array()}}function save(id){var data=read();data.push(id);Cookie.create("tweetmeme_tweeted",data.join("-"),7)}function check(linkarray){var match="";for(var i=0;i<linkarray.length;i++){var link=document.createElement("a");link.href=linkarray[i];document.body.appendChild(link);if(document.defaultView!=undefined){var color=document.defaultView.getComputedStyle(link,"").getPropertyValue("color")}else{var color=link.currentStyle["color"]}if(color=="rgb(0, 0, 0)"||color=="#000000"){match!=""?match+=","+escape(linkarray[i]):match=escape(linkarray[i])}}return match}function addEvent(a,action,func){if(a.addEventListener){a.addEventListener(action,func,false)}else{if(a.attachEvent){a.attachEvent("on"+action,func)}}}var xmlhttp;function sendrequest(id){xmlhttp=null;if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest()}else{if(window.ActiveXObject){xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}}if(xmlhttp!=null){xmlhttp.onreadystatechange=response;xmlhttp.open("POST","/ajax/tweet",true);tweet.className+=" loading";var source=document.getElementById("source").value;var service=document.getElementById("service").value;var service_api=document.getElementById("service_api").value;var links=check(urls);var params="method=tweet&id="+id.substr(1)+"&source="+source+"&service="+service+"&service_api="+service_api+"&timing="+timer;if(links!=""){params+="&visited="+links}xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xmlhttp.setRequestHeader("Content-length",params.length);xmlhttp.setRequestHeader("Connection","close");xmlhttp.send(params)}}function response(){if(xmlhttp.readyState==4){if(xmlhttp.status==200){var data=eval("("+xmlhttp.responseText+")");tweet.className="tweetmemebutton";if(data.response!="failure"){var celement=document.getElementsByTagName("span")[0];celement.innerHTML=parseInt(celement.innerHTML)+1;disable();save(tweet.id.substr(1))}else{if(data.data=="Already retweeted."){disable();save(tweet.id.substr(1))}else{}}}else{}}}function tracking(){xmlhttp=null;if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest()}else{if(window.ActiveXObject){xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}}if(xmlhttp!=null){xmlhttp.onreadystatechange=trackresponse;var url=document.getElementById("url").value;var links=check(urls);var params="url="+escape(url)+"&timing="+timer;if(links!=""){params+="&visited="+links}xmlhttp.open("GET","/track?"+params,true);xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xmlhttp.setRequestHeader("Connection","close");xmlhttp.send(params)}}function trackresponse(){};