/* Copyright (C) 2010 Microsoft Corporation */if(!window["$Do"]){$Do={};$Do.q=[]}new function(){var a=$Do;a.r=[];a.register=function c(d,f){a.r[d]=f||true;var e=a.q.length,b=0;for(;b<e;b++){var c=a.q[b];if(c.id==d&&a.c(d,c.c,c.a)){a.q.splice(b,1);b--;e--}}};a.c=function d(f,c,e){var d=a.r&&a.r[f];c=c?c:this;function g(){var d=a.r[f],g=d!==true;d=g?d:e[2];$WebWatson.wrapCallback(d,c,b(e,!g))()}if(d)setTimeout(g,0);return d};function b(b,a){return Array.prototype.slice.call(b,a?3:2)}};new function(){$css.getCN=function a(e,f,d){var b=[];if(d&&d.getElementsByTagName){var c=d.getElementsByTagName(f);for(var a=0;a<c.length;a++)if($css.has(c[a],e))b[b.length]=c[a]}return b}};$edh={e:function(a,c){var d=c||"inline";if(a.nodeName.toLowerCase()=="span"&&a.className.indexOf("c_ld")!=-1){var b=a.lastChild;if(b){a.parentNode.insertBefore(b,a);b.style.display=d;a.parentNode.removeChild(a)}}},d:function(a){if(a.nodeName.toLowerCase()=="a"&&!(a.parentNode.nodeName.toLowerCase()=="span"&&a.parentNode.className.indexOf("c_ld")!=-1)){var b=document.createElement("span");b.innerHTML=a.innerHTML;b.className=a.className?a.className+" c_ld":"c_ld";b.setAttribute("title",a.getAttribute("title"));a.style.display="none";a.parentNode.insertBefore(b,a);b.appendChild(a)}}};function $(a){return a==null||typeof a=="object"&&!(a instanceof String)?a:document.getElementById(a)}function $f(){var e=$f.w=window,c=$f.doc=document,d=$f.docEl=c.documentElement,a=[];$f.addEvent=function(d,b,c){b=!$B.IE?b.substr(2):b;$B.IE?d.attachEvent(b,c):d.addEventListener(b,c,false);a.push({target:d,event:b,func:c})};$f.removAllEvents=function(){var c,d=a.length;while(d--){c=a[d];b(c.target,c.event,c.func)}};$f.removeEvent=function(g,d,f){d=!$B.IE?d.substr(2):d;var c,e=a.length;while(e--){c=a[e];if(c.target==g&&c.event==d&&c.func==f){b(c.target,c.event,c.func);a.splice(e,1);break}}};$f.cancelEvent=function(a){a=a||window.event;a.cancelBubble=true;if(a.stopPropagation){a.preventDefault();a.stopPropagation()}else a.returnValue=false;return false};function b(c,a,b){$B.IE?c.detachEvent(a,b):c.removeEventListener(a,b,false)}$f.px=function(a){return a+"px"}}$f();$f.addEvent($f.w,"onunload",$f.removAllEvents);$f.dockIt=function(g,v,a,d,h,y,t){var f=0;h=h||false;a=typeof a=="undefined"?0:a;d=d||{x:0,y:0};if(typeof d!="object"){f=d;d={x:0,y:0}}var k=g.offsetParent,u=k==document.body||k==$f.docEl,c=$f.getLocation(g,h),b=$f.getLocation(v,h,u),n=d.x*($B.rtl?-1:1),e={x:c.bodyX+n,y:c.bodyY+d.y,width:c.width,height:c.height,targetLoc:b};if(!t){var w=$f.clientHeight(),x=$f.clientWidth(),q=b.addScrollTop!=-1?$f.scrollTop():0,o=$f.scrollLeft(),m=c.width+n,l=c.height+d.y,j=w+q-b.bottom>l,i=b.top-q>l,p=x+o-b.right>m,r=b.left-o>m;if(!j&&i){if(a<2)a+=2;else if(a==4||a==6)a+=1}else if(!i&&j)if(a>=2&&a<4)a-=2;else if(a==5||a==7)a-=1;if(!p&&r){if($B.rtl){if(a>=4&&a<6)a+=2;else if(a==1||a==3)a-=1}else if(a>5)a-=2;else if(a==0||a==2)a+=1}else if(!r&&p)if($B.rtl){if(a>5)a-=2;else if(a==0||a==2)a+=1}else if(a>=4&&a<6)a+=2;else if(a==1||a==3)a-=1}var s=a%2;if(y){e.x=d.x;e.y=d.y+b.bottom}else if(a>=0)if(a<4){e.x+=s?$B.rtl?b.left:b.right-c.width:$B.rtl?b.right-c.width:b.left;e.y+=a<2?b.bottom+f:b.top-c.height-f}else{if($B.rtl)if(a<6)a+=2;else a-=2;e.x+=a<6?b.left-c.width-f:b.right+f;e.y+=s?b.bottom-c.height:b.top}if($B.Mobile&&!i&&!j)e.y=$f.scrollTop();g.style.left=e.x+"px";g.style.top=e.y+"px";return e};$f.getLocation=function(b,g,m){var k=false,e=$f.getStyle,i="offsetTop",h="offsetLeft",l="position",a={x:b[h],y:b[i],top:0,right:0,bottom:0,left:0,bodyX:0,bodyY:0,width:b.offsetWidth,height:b.offsetHeight},c=b;while(c=c.offsetParent){k=e(c,l)=="relative";if(g!=2){a.bodyX-=c[h];a.bodyY-=c[i]}if(k){var n=$f.toInt(e(c,"padding-left")),o=$f.toInt(e(c,"padding-top"));a.x=g==1?a.x:n;a.y=g==1?a.y:o}a.x+=c[h];a.y+=c[i]}b=b.parentNode;var d=0,j=0;while(b&&b!=document.body){var f=e(b,l);if(f=="relative"){j=1;b=b.parentNode;continue}if(f=="fixed")d=1;if(!j||m)a.y-=$f.toInt(b.scrollTop);else if(f=="fixed")d=-1;b=b.parentNode}if(d==1)a.y+=$f.toInt($f.scrollTop());a.left=a.x;a.top=a.y;a.right=a.x+a.width;a.bottom=a.y+a.height;a.addScrollTop=d;return a};$f.toInt=function(a){a=parseInt(a);return isNaN(a)?0:a};$f.locCompare=function(a,b){if(a.bodyX!=b.bodyX||a.bodyY!=b.bodyY||a.top!=b.top||a.left!=b.left||a.bottom!=b.bottom||a.right!=b.right)return 1;return 0};$f.getStyle=function(c,a){var d="";if($f.doc.defaultView&&$f.doc.defaultView.getComputedStyle){var e=$f.doc.defaultView.getComputedStyle(c,"");d=e?e.getPropertyValue(a):""}else if(c.currentStyle){if(a.indexOf("-")>=0){var b=a.split("-");b[1]=b[1].substr(0,1).toUpperCase()+b[1].substr(1);a=b.join("")}d=c.currentStyle[a]}return d};window.rtl=$B.rtl;$f.isChildOf=function(b,a){try{while(a&&a!==b&&a!=document)a=a.parentNode;return a===b}catch(c){}};$f.pn=function(a,c){var d=$css.has(a,c),b=d?a:null;while(!b&&(a=a.parentNode)&&typeof a!="undefined")if($css.has(a,c))b=a;return b};$f.docHeight=function(){var b=$f.doc.documentElement.clientHeight,a=$f.doc.body.clientHeight,c=a!=undefined?a:window.innerHeight+window.scrollMaxY;return Math.max(c,b)};$f.docWidth=function(){var a=$f.doc.body.clientWidth;return a!=undefined?a:document.width};$f.scrollTop=function(){var a=$f.toInt($f.docEl.scrollTop),b=$f.toInt(window.scrollY);return Math.max(a,b)};$f.scrollLeft=function(){var a=$f.toInt($f.docEl.scrollLeft),b=$f.toInt(window.scrollX);return Math.max(a,b)};$f.clientHeight=function(){return $f.docEl.clientHeight-($B.IE?16:0)};$f.clientWidth=function(){return $f.docEl.clientWidth-($B.IE?16:0)};new function(){var e,b,a,c,g="http://",f="https://";function d(){e=window.$Config||{};b=e.Ssl||{};a=b.imu;c=b.d}d();window.$ssl={ensureSSLImageUrl:function(b){if(!c)if(document.location.href.toLowerCase().startsWith(f))if(b.toLowerCase().startsWith(g)&&a)b=a+b.encodeUrl();return b},copyOutConfig:function(a){a.$Config.Ssl={};$Utility.updateObject(a.$Config.Ssl,$Config.Ssl);a.$ssl.resetCachedValues()},resetCachedValues:d}};new function(){var e="px",i="onmouseover",k="onunload",d="style",g="width",j="parentNode",m="INPUT",l=$B.IE_M6,h=window,f=$f.doc;function b(p,o,cb,Wb,Cb,Vb,U,hc,Rb,zb,rb,cc,gc,Ab){var J=null,Ib="nextSibling",R="className",w="visibility",x="display",jb="hidden",kb="block",Lb="visible",lb="none",hb="position",xb="height",T="left",Y="top",M="onclick",gb="onkeydown",Mb="onkeyup",H="onblur",ib="onfocus",tb="onfocusin",qb="onfocusout",fb="onmouseout",Fb="onmousedown",Hb="onresize",eb="t_seli",ob="t_hov",vb="c_shad",P=J,B,ab,z,W,A,t,s,E,G=1,V,O=1,r,F=p[d],q={display:0,visibility:0},y=q,X=0,u,N=0,L,Pb,C,v,yb,sb=320,Q=[],Zb=1e3,db,jc=$f.docEl,ub=0,Tb=$f.docWidth(),wb={},I=$B.Mobile,bb=$B.BlackBerry,n=this;cb=cb||J;n.isHoverMenu=0;n.tempHoverCloseDelay=0;n.parentEl=J;n.keepHoverMenuOpen=0;n.TabEvent=new $Event;n.EnterEvent=new $Event;function ic(){p.binding=n;c(h,k,n.dispose);c(p,gb,mb);c(o,gb,mb);c(o,H,K);c(o,M,dc);c(f,Fb,S);c(f,M,S);c(f,Mb,Ob);L=o.tagName==m;n.isHoverMenu=(U=="mouseover"||U=="focus")&&!L;if(!zb){zb=250;db=1e3}rb=rb||200;if(n.isHoverMenu){c(o,fb,n.menuOnmouseout);c(o,i,n.menuOnmouseover);c(p,fb,n.menuOnmouseout);c(p,i,n.menuOnmouseover);c(o,ib,n.menuOnmouseover)}else if(U)h.setTimeout(function(){c(o,"on"+U,n.toggleState)},0);if(I&&!($B.IE&&$B.V<7)){s=f.createElement("div");s[R]="c_m_sbox";Sb(s,50);if((bb||$B.S60_Symbian)&&h["$Config"]&&$Config.ImagesBaseUrl)s[d].background="url("+$Config.ImagesBaseUrl+"/imgs/black_50.png)";f.body.insertBefore(s,f.body.firstChild);c(s,M,S)}F[w]=jb;F[x]=kb;Jb();Bb();c(h,Hb,Ub)}n.dispose=function(){a(p,gb,mb);a(o,gb,mb);a(o,H,K);a(f,Fb,S);a(f,M,S);a(f,Mb,Ob);a(h,Hb,Ub);if(n.isHoverMenu){a(o,fb,n.menuOnmouseout);a(o,i,n.menuOnmouseover);a(p,fb,n.menuOnmouseout);a(p,i,n.menuOnmouseover);a(o,ib,n.menuOnmouseover)}else if(U)a(o,"on"+U,n.toggleState);if(s)a(s,M,S);if(E)a(E,ib,Nb);if(!I)for(var b=0;b<A.length;b++){a(A[b],tb,Z);a(A[b],qb,Z)}a(z,H,K);a(W,H,K);n.TabEvent.dispose();n.EnterEvent.dispose();p.binding=o.menu=J;a(h,k,n.dispose)};function Jb(){var g=p.getElementsByTagName("*"),h;yb=0;A=[];for(var f=0;f<g.length;f++){var b=g[f];if(b.tagName=="A"||b.tagName==m){var e=Db(b);if(e==p||e.binding&&e.binding.isOpen()){A.push(b);var k,i=b[j];try{k=i.tagName=="LI"||i.tagName=="DIV"}catch(l){}if(k){if(!I){a(b,tb,Z);a(b,qb,Z);c(b,tb,Z);c(b,qb,Z);b[d].zoom="0";if($css.has(b,"uxfa_ml"))yb=1}if(!V&&$css.has(b,ob))C=b;if(u&&u.id==b.id){h=1;D(A.length)}}}}}N=A.length;if(N>0){if(O&&r)Gb();O=0;z=A[0];W=A[N-1];c(z,H,K);c(W,H,K)}else{pb();O=1}if(!h&&C)D(-1)}n.update=function(b){V=true;a(z,H,K);a(W,H,K);Jb();if(!b)Bb();V=false;if(v)setTimeout(function(){v.update(b)},0)};function Z(a){if(!L){a=a||event;var b=a.target||a.srcElement;if(b.nodeName=="A")if(a.type=="focusin")setTimeout(function(){$css.add(b,eb)},0);else setTimeout(function(){$css.remove(b,eb)},0)}}function Ub(){G=1;if(!$css.has(p,"noresize")){var a=$f.docWidth();if(Tb!=a){Tb=a;nb()}}}function Bb(){if(O)return;var k=Db(o);if(k&&k!=o)v=k.binding;else if(Rb!=undefined)cb=Rb;if(!l&&!I&&yb)F[g]=p.offsetWidth-2;if(Ab){if(V){p[d][g]="auto";$css.remove(p,"c_m_maxw")}if(p.offsetWidth>Ab){p[d][g]=Ab+e;$css.add(p,"c_m_maxw")}}var f=3,c=f,i=$B.rtl,m=1;if(!t)ec();var u=o;if($css.has(o,"c_m_usep"))u=o[j];var a={};if(!bb){var a=$f.dockIt(p,u,cb,Wb,Cb,hc,cc);wb=a.targetLoc}if(I){var b=$f.docWidth(),x=$f.docHeight(),z=sb,A=h.screen[g],B=0;if(s){s[d][xb]=x?x+e:"100%";s[d][g]=b?b+e:"100%"}if(!b||b>A&&!$B.SF_iPhone)b=A;i=0;if(b>sb&&!bb){var C=$f.getLocation(o,Cb);if(C.left>b/2){B=b-sb;i=1}m=0}else{z=b;c=0}a.x=B;p[d][T]=a.x+e;F[g]=q[g]=z-2+e;if(bb)p[d][Y]=ub+e;Yb()}var D=function(){a.height+=I&&m?f*2:0;q[w]=jb;if(!I)q[g]=a.width+e;q[xb]=a.height+e;q[T]=a.x+(i?-c:c)+e;q[Y]=a.y+(I&&m?-f:f)+e;q[w]=Lb;if(l){y[w]=jb;y[g]=a.width+c+e;y[xb]=a.height+f+e;y[T]=(i?a.x-c:a.x)+e;y[Y]=a.y+e}};if(!bb&&!$B.S60_Symbian)setTimeout(D,0);G=0;if(!r)pb();else if(V)n.show(0,1)}function ec(){t=p;while(t[R]!=vb&&t[Ib])t=t[Ib];if(!t||t[R]!=vb){t=f.createElement("div");q=t[d];q[hb]=$f.getStyle(p,hb);q[Y]=0;q[T]=0;t[R]=vb;p[j].appendChild(t);if(l){E=f.createElement("IFRAME");E.frameBorder="no";E.src="javascript:''";E.scrolling="no";y=E[d];y[hb]=q[hb];p[j].insertBefore(E,p);c(E,ib,Nb)}}q=t[d];q[x]=lb;q.backgroundColor="#000";Sb(t,20)}function Yb(){var d=0,c=[],e=p.getElementsByTagName("UL"),a;for(var b=0;b<e.length;b++){a=e[b];if($css.has(a,"c_gll")){c.push(a);bc(a);if(a.offsetTop>a.previousSibling.offsetTop)d=1}}if(d)for(var b=0;b<c.length;b++)ac(c[b])}function pb(){y[w]=q[w]=F[w]=jb;q[x]=lb;if(G){F[Y]=q[Y]=0;F[T]=q[T]=0}if(s)s[d][x]=lb;D(-1)}function Gb(){if(s)s[d][x]=kb;y[x]=q[x]=F[x]=kb;y[w]=q[w]=F[w]=Lb;if(C==z)D(0)}n.hide=nb;function nb(c,a){if(a||Kb()&&r){if(!O)pb();r=0;b.current=v;if(v){if(v.isHoverMenu)v.tempHoverCloseDelay=Zb;if($f.ie&&B)o.focus();setTimeout(function(){v.update(1)},0)}Eb()}}n.show=function(d,c){if(!c){var a=$f.scrollTop();if(ub!=a||!wb||$f.locCompare(wb,$f.getLocation(o,Cb))){ub=a;G=1}if(!r&&(G||gc))Bb()}if(!v&&b.current!=n)b.closeAll();if(!O)Gb();r=1;if(v)v.update(1);if(!V&&!d&&!n.isHoverMenu)try{o.focus()}catch(e){}Eb();b.current=n};var Qb=0;n.toggleState=function(){if(Kb()){Qb=(new Date).getTime();!r&&!fc()?n.show():nb(0,1)}};function Kb(){return (new Date).getTime()-Qb>100}n.isOpen=function(){return r};function Eb(){for(var a=0,b=Q.length;a<b;a++)try{Q[a]()}catch(c){$WebWatson.submitFromException(c,J,99)}}n.addStateListener=function(a){Q.push(a)};n.removeStateListener=function(b){for(var a=0,c=Q.length;a<c;a++)if(Q[a]==b){Q.splice(a,1);return}};n.setOffset=function(a){Wb=a;G=1};n.invalidatePosition=function(){G=1};n.setLoc=function(a){cb=a;G=1};n.menuOnmouseover=function(){if(o.unhover){clearTimeout(o.unhover);o.unhover=J}if(!r&&!o.hover){var a=zb;if(b.tempOpenDelayTimer&&db)a=1;o.hover=setTimeout(function(){n.show()},a)}};n.menuOnmouseout=function(){if(o.hover){clearTimeout(o.hover);o.hover=J}if(r&&!o.unhover&&!n.keepHoverMenuOpen){n.tempHoverCloseDelay=n.tempHoverCloseDelay||rb;o.unhover=setTimeout(function(){nb()},n.tempHoverCloseDelay);n.tempHoverCloseDelay=0;if(db){clearTimeout(b.tempOpenDelayTimer);b.tempOpenDelayTimer=setTimeout(function(){b.tempOpenDelayTimer=null},db)}}};function ac(a){a[d][x]=lb;a.previousSibling[R]=""}function bc(a){a[d][x]=kb;a.previousSibling[R]="c_gl"}function dc(){if(!L&&n.isHoverMenu){var a=o.getAttribute("href");if((!a||a.endsWith("#"))&&r&&!Vb)try{z.focus()}catch(c){}}}function S(b){b=b||event;var a=b.target||b.srcElement;if(r&&a&&!$f.isChildOf(p,a)&&o!=a&&!$f.isChildOf(o,a))n.hide()}function Ob(a){a=a||event;var d=27,b=a.target||a.srcElement,c=a.keyCode||a.which;if(c==9)ab=0;if(r)if(c==d){Pb=b.value;n.hide()}else if(!B&&P==o&&z&&!Vb)try{z.focus()}catch(e){}if(L&&b==o)if(!r&&b.value!=Pb&&b.value!="")n.show();else if(r&&b.value=="")n.hide()}function fc(){return L&&o.value==""?true:false}n.getSelectedEl=function(){return u?u:C};function mb(a){a=a||event;var d=a.target||a.srcElement,c=a.keyCode||a.which,e=0;ab=c==9;B=a.shiftKey;P=d;if(L){if(d==o){if(c==40)Xb(1);else if(c==38)Xb(-1);else if(c==13){if(d.value!="")if(u){n.EnterEvent.fire(n);u.focus();if($B.Chrome||$B.Safari)u.fireEvent(M)}else if(C){n.EnterEvent.fire(n);try{C.focus()}catch(f){}C.fireEvent(M)}}else if(ab&&!B){n.TabEvent.fire(a);D(-1);b.closeCurrent()}else if(c==27&&r)e=1}else if(ab)if(!B)if(P!=W)D(X+1);else D(-1);else if(B)D(X-1);if(e)return $f.cancelEvent(a)}}function Xb(b){if(N){var a=X+b;if(a>=N)a=0;else if(a<0)a=N-1;D(a)}}function D(a){if(N){if(u)$css.remove(u,eb);X=a;if(X>-1){u=A[X];$css.add(u,eb);$css.remove(C,ob)}else{u=J;$css.add(C,ob)}}}function K(){if(ab&&B&&P==o){n.hide();n.menuOnmouseout()}else if(!O&&(!B&&P==W||B&&P==z)){n.hide();n.menuOnmouseout()}else if(!r&&P==o)n.menuOnmouseout()}function Nb(){var a=ab&&!B?z:o;try{a.focus()}catch(c){}}function Sb(c,b){var a="opacity";if($B.IE)a="filter";c[d][a]=a=="filter"?"alpha(opacity="+b+")":.01*b}function Db(a){var b=a.binding&&a.binding.toggleState?a:null;while(!b&&(a=a.parentNode)&&typeof a!="undefined")if(a.binding&&a.binding.toggleState)b=a;return b}ic()}b.closeCurrent=function(){if(b.current)b.current.hide(0,1)};b.current=null;b.closeAll=function(){while(b.current)b.closeCurrent()};b.emptyFunction=function(){};new function(){if($B.Chrome||$B.Safari){c(h,k,n);c(f,i,b.emptyFunction)}};function n(){if($B.Chrome||$B.Safari){a(f,i,b.emptyFunction);a(h,k,n)}}function c(a,b,c){if(a)a.attachEvent(b,c)}function a(a,b,c){if(a)a.detachEvent(b,c)}b.bind=function(p,o,l,a,j,n,e,f,c,d,h,k,g,i){var m={offset:l,alt:a==undefined?0:a,nofocus:j,posabs:n,defaultLoc:e,hoverDelay:f,hoverCloseDelay:c,forceDispose:d,parentEl:h,menuEl:k,eventType:g,sourceEl:i};return b.create(p,o,m)};b.create=function(k,D,a){k=k||event;var E=k.target||k.srcElement,o=["c_ml","c_mcp","c_m"],r=E,a=a||{},A=a.offset,C=a.alt==undefined?1:a.alt,z=a.nofocus,B=a.posabs,v=a.defaultLoc,w=a.hoverDelay,t=a.hoverCloseDelay,q=a.forceDispose,h=a.parentEl,c=a.menuEl,i=a.eventType,f=a.sourceEl,s=a.skipEdgeDetection,u=a.noDockCache,y=a.maxWidth;f=f||$f.pn(r,o[0]);if(f&&typeof f.menu==="undefined"||q){h=h||$f.pn(r,o[1])||f[j];if(h){if(l&&h.tagName=="LI"&&$css.has(h[j],"c_m"))h[d][g]=h.offsetWidth+e;var n=h.childNodes,p=n.length;while(p--&&!c)c=$css.has(n[p],o[2])?n[p]:null;if(q&&c&&c.binding)c.binding.dispose();x()}}function x(){var g=false,h=0,d=1,e=2,a=h;if(c.binding)a=d;else if(c&&f){i=i||k.type;c.binding=new b(c,f,D,A,C,z,i,B,v,w,t,s,u,y);a=d;if((i=="mouseover"||i=="focus")&&f.tagName!=m)a=e;f.menu=c.binding;g=true}if(a==d)c.binding.toggleState();else if(a==e)c.binding.menuOnmouseover();return g}return false};h.$menu=b};new function(){if(window["$HIC"]){var a=[],h,i,g,f,k,l,v=function(b,c,a){this.execute=function(d){if(d.href.indexOf("?rru=home")>-1)d.href=d.href.replace(c,a);else d.href=d.href.replace(b,a)}},e=function(b,a){this.execute=function(c){var e="://"+a,d="://"+b+a;c.href=c.href.replace(e,d)}},t=function(d,b,a,c){this.execute=function(e){if(d&&e.href.indexOf("?rru=inbox")>-1){e.href=d;e.target="_self"}else if(b&&e.href.indexOf("?rru=compose")>-1){e.href=b;e.target="_self"}else if(a&&e.href.indexOf("?rru=contacts")>-1){e.href=a;e.target="_self"}else if(c&&e.href.indexOf("?rru=home")>-1){e.href=c;e.target="_self"}}};if($Config.Header){h=$Config.Header.HomeLink;i=$Config.Header.MailLink;g=$Config.Header.ContactsLink;composeLink=$Config.Header.ComposeLink;f=$Config.Header.HotmailDomain;l=$Config.Header.OldHomeDomain;k=$Config.Header.OldHotmailDomain}var w=f;if(i||composeLink||g||h)a[a.length]=new t(i,composeLink,g,h);else if(w)a[a.length]=new v(k,l,f);var c=$HIC.c;if(c&&c.length>0){c="cid-"+c;a[a.length]=new e(c+".","profile");a[a.length]=new e(c+".","photos");a[a.length]=new e(c+".","office")}var d=[],p=$css.getCN("c_hleft","div",$("c_header"))[0].getElementsByTagName("a");for(var b=p.length-1;b>=0;b--)d.push(p[b]);var q=$("c_hmc");if(q){var o=q.getElementsByTagName("a");for(var b=o.length-1;b>=0;b--)d.push(o[b])}var m=$("c_profile");if(m)d.push(m);for(var b=d.length-1;b>=0;b--){var s=d[b];s.target="_top";for(var j=a.length-1;j>=0;j--){var r=a[j];if(r)r.execute(s)}}var n="HIC";function u(){var d=window.location.host.split("."),f="."+d[d.length-2]+".com",c=new Date,b=$HIC;c.setDate(c.getDate()+b.e);var e=$Cookie.getCookie(n,1)||"|||",a=e.split("|");if(a[0]!=b.c)a[1]=a[2]=a[3]="";a[0]=b.c?b.c:a[0]||"";a[1]=b.m||b.m===0?b.m:a[1]||"";a[2]=b.l||b.l===0?b.l:a[2]||"";$Cookie.setCookie(n,a.join("|"),f,0,c,1)}$Do.register("$Header.UpdateCookie",u)}};new function(){var a=window["$Config"],d,c=-1,e=0,m=$("c_me"),k=$("c_melink"),b,f,g;if(a&&a.Header&&a.Header.baseUrl&&m)c=0;function i(c){var b=[];b.push('<div id="c_h_theme_m" class="c_om noresize t_hovl"><ul class="c_oblock c_ot" id="c_h_theme_m_ul" serviceurl="'+a.Themes.ThemeService.encodeHtmlAttribute()+'">');var j='<li class="c_omti">',i='<div class="c_clr"></div></li>',h=true,k=c?Math.min(8,c.length):8;for(var g=0;g<k;g++){h=false;if(g%4==0)b.push(j);b.push('<a href="#" onclick="return false;" info="');b.push(c?(c[g][0]+"|"+c[g][1]+"|"+c[g][2]).encodeHtmlAttribute():"");b.push('" class="c_thmb" title="');b.push(c?c[g][3].encodeHtmlAttribute():"");b.push('">'+(c?"":'<div class="c_noimg"></div>')+"</a>");if(g%4==3){h=true;b.push(i)}}if(!h)b.push(i);b.push("</ul></div>");f.innerHTML=b.join("");d=$("c_h_theme_m");if(c)$theme.bind(d,$menu.themeAreaId);d.style.display="block";e=1}function l(){if(c==0){if(!e){b=$("c_theme_menu");if(b){f=b.parentNode;b=null;i()}}if(e){if($BSI.isLoading())$BSI.addLoadedCallback(h);else h();if(k.menu)k.menu.update()}}}function h(){if(c==1)return;c=1;$menu.themeAreaId="c_h_theme_m_ul";$menu.disableThumbs=0;if(!g){g=1;$Network.fetchScript(a.handlerBaseUrl+"/Handlers/ThemePickerJS.mvc"+a.Themes.ThemeJSParms,j);$Network.fetchScript(a.Header.baseUrl+"themes.js",j)}setTimeout(n,5)}function n(){new function a(){if("undefined"==typeof $theme)$menu.themeCallback=a;else{$theme.renderThemePicker=function(a){var g=a.length;window.themejs=null;var b=1,c,d,e=g-1;for(var f=b;f<a.length;f++){c=Math.floor(Math.random()*e)+b;d=Math.floor(Math.random()*e)+b;var h=a[c];a[c]=a[d];a[d]=h}i(a)};$Do.register("$theme.renderThemePicker",$theme.renderThemePicker)}}}$Do.register("$ThemeMenuInit",l);function j(){}};new function(){function i(){if(window.$Logout&&$Logout.doLogout)$Logout.doLogout()}var h=$("c_signout");if(h)h.onclick=i;function j(e){try{var b=$("c_me");if(!b)return;b=b.getElementsByTagName("UL")[0];var g=document.createElement("span");g.className="c_ms";b.lastChild.appendChild(g);var h=e.CIDLIST,d=e.CredNameList,c=Math.min(h.length,d.length),f=$Config.Header.MemberName;while(c--){var k=document.createElement("li"),a=document.createElement("a");a.href=$Config.Header.SwitchLinkedIdUrl+"&cid="+h[c];a.target="_top";a.onclick=i;if(d[c]===f){a.className="sel";a.title=$Config.Header.CurrentIdString.replace("{0}",f)}else a.title=$Config.Header.SwitchIdString.replace("{0}",d[c]);a.innerHTML=d[c];k.appendChild(a);b.appendChild(k)}var j=$("c_melink").menu;if(j)j.update()}catch(l){$WebWatson.submitFromException(l)}}$Do.register("BuildLinkedIdMenu",j);var a=$("c_me"),d="onmouseover",f="onfocus",e="onunload",g;if(window.$Config&&$Config.Header&&$Config.Header.LinkedIdUrl)if(a){window.attachEvent(e,c);a.attachEvent(d,b);a.attachEvent(f,b)}function c(){window.detachEvent(e,c);a.detachEvent(d,b);a.detachEvent(f,b)}function b(){if(!g){g=1;c();$Network.fetchScript($Config.Header.LinkedIdUrl,k)}}function k(){}};new function(){var b=$("uxp_ftr_control_mini"),f=$("uxp_ftr_hidechevron"),c=$("uxp_ftr_control_cc");if(!b)return;function a(b,a,d){c.style.display=a;if(d){b.returnValue=false;return false}}function g(b){return a(b,"none",true)}function h(b){return a(b,"",true)}function d(a,b){return a&&(a.id===b||d(a.parentElement,b))}function e(e){if(c.style.display===""&&!d(e.srcElement,b.id))return a(e,"none",false)}$f.addEvent(document,"onclick",e);$f.addEvent(b,"onclick",h);$f.addEvent(f,"onclick",g)};function $menu_themes(g,d,f,b){$menu.optionsElement=g;$menu.themeAreaId=d;$menu.disableThumbs=b;var a="c_themes",c=$(a);if(!c)$newScript(f+"themes.js",a);new function e(){if("undefined"==typeof $theme)$menu.themeCallback=e;else try{$theme.bind($menu.optionsElement,$menu.themeAreaId)}catch(a){}}}var CollapsingMenu=function(k,o,b,g,i,d){var l=" &#9660;",m=$B.ltr?" &#9658;":" &#9668;",a=b.lastChild.childNodes[1],n=b.firstChild,c=false;if(!d){d=a.parentNode;c=true}this.redraw=function(){var l=$css.getCN("c_collRem","a",a)[0];if(l){var i=l.parentNode;i.parentNode.removeChild(i)}var e=b.childNodes.length-1;while(e<k&&a.childNodes.length!=0){j(a.firstChild,false);b.insertBefore(a.firstChild,b.lastChild);e++}while(e>k){f();e--}a.parentNode.style.display=g;while(h())f();if(a.childNodes.length==0)a.parentNode.style.display="none";else{a.parentNode.style.display=g;d=a.parentNode;var m=c;c=false;if(h())f();c=m}};function h(){var f,a=c?d.previousSibling:d;if(a){if($B.ltr)f=b.parentNode.offsetWidth+e(b.parentNode)<a.offsetWidth+e(a)+i+20;else f=e(b.parentNode)>e(a)-(i+20);return b.childNodes.length>o&&f||n.offsetTop<a.offsetTop-a.offsetHeight}else return false}function e(a){var b=a.offsetLeft;while(a.nodeName.toLowerCase()!="body"&&a.nodeName.toLowerCase()!="html"){a=a.offsetParent;b+=a.offsetLeft}return b}function f(){var c=b.lastChild.previousSibling;j(c,true);a.insertBefore(c,a.firstChild)}function j(b,d){if(b.childNodes.length>1&&b.childNodes[1].nodeName.toLowerCase()=="ul"){var c=b.getElementsByTagName("SPAN");for(var a=0;a<c.length;a++)if(c[a].className=="c_chev"){c[a].innerHTML=d?m:l;break}}}};$windowResize=new $Event;$CommandBar={};new function(){var d,e,a=0;$windowResize.Start=function(){$f.addEvent(window,"onresize",c)};$windowResize.Stop=function(){$f.removeEvent(window,"onresize",c)};function c(){if(!a){a=1;b()}}function b(){var f=$f.docWidth(),c=$f.docHeight();if(f!=e||c!=d){e=f;d=c;setTimeout(b,10)}else{a=0;$windowResize.fire()}}function f(){var d=$css.getCN("c_c","div",document);for(var c=0;c<d.length;c++){var a=d[c];a.collapse=new CollapsingMenu(a.m,a.i,a.firstChild,a.s,14);if(a.r)a.collapse.redraw();a.DisableCommand=function(b){var c=a.getElementsByTagName("a")[b];$edh.d(c)};a.EnableCommand=function(b){var c=a.getElementsByTagName("a")[b].parentNode;$edh.e(c)};a.dispose=function(){};var b=window["$Config"];if(b&&b.CommandBar&&b.CommandBar.resize){$windowResize.attach(a.collapse.redraw);$windowResize.Start();a.dispose=function(){$windowResize.detach(a.collapse.redraw);if($windowResize._handlers.length==0)$windowResize.Stop()}}}}$CommandBar.init=f;$f.addEvent(window,"onload",f)};var $AdServeMsngr=new function(){var a=this,d=0,c=[],b=false;a.toFrame=function(b,c,d,a){f(b,c,d,"htof",a)};a.toHost=function(b,c,a){f(null,b,c,"ftoh",a)};function f(f,i,d,g,c){if(g=="htof"&&!f||!c||!i)return;d=d?a.serialize(d,"##","$$"):"";var h=a.serialize({frameName:f,message:d,fn:i},":",";");if(window["postMessage"]){var j=g=="htof"?window.frames[f]:window.parent;if(j)j.postMessage(h,"*")}else{var b=c.split("/");if(g=="ftoh"&&!(b.length>=3&&(b[0]=="http:"||b[0]=="https:")&&(b[2].indexOf(".live.com")!=-1||b[2].indexOf(".live-int.com")!=-1)))return;e(c+(c.indexOf("?")!=-1?"&":"?")+"c={cachebrk}"+"#"+h)}}function e(f){if(!b){b=true;var i="adNegFrm";d=d==0?1:0;f=f.replace("{cachebrk}",d);if(!window.frames[i]){var e=document.createElement("iframe");e.id=e.name=i;h(e,"load",g);e.src=f;var j="adservtmp",a=$(j);if(!a){a=document.createElement("div");a.setAttribute("id",j);a.style.display="none";document.body.appendChild(a)}a.appendChild(e)}else window.frames[i].location.replace(f)}else c.push(f)}function g(){b=false;if(c.length>0)e(c.shift())}a.receiveMessage=function(k){var f=k||event;if(!f||!f.data||!f.origin)return;var d=f.origin,c=null;if(window["$AdConfig"]&&(d.endsWith(".wlxrs.com")||d.endsWith(".wlxrs-int.com")||d.endsWith(".shared-dev.live-int.com")))c="ftoh";else if(window["$WLXRmAd"]&&(d.endsWith(".live.com")||d.endsWith(".live-int.com")))c="htof";if(!c)return;var b=a.deSerialize(f.data,":",";");if(!b||!b.fn)return;if(c=="htof"){if(!(b.fn=="$AdServe.refreshAd"||b.fn=="$AdServe.getRadIds"))return}else if(c=="ftoh"){if(!(b.fn=="$Acb.setRadIds"||b.fn=="$RmAdHandler.processMsg"||b.fn=="$RmAdHandler.processMsgFromHeader"))return}else return;var g=window;if(window["postMessage"])g=window;else{var h=b.frameName;if(c=="htof"&&h&&(h.endsWith("_frm")||h.endsWith("_hfrm")))g=window.parent.frames[h];else if(c=="ftoh")g=window.parent.parent}var j=b.fn.split("."),e=null;for(var i=0;i<j.length;++i){e=e?e[j[i]]:g[j[i]];if(!e)return}e(b.message?a.deSerialize(b.message,"##","$$"):null)};a.serialize=function(a,e,d){if(!a)return "";var c=[];if(typeof a=="object")for(var b in a)if(a[b]&&(typeof a[b]==="string"||typeof a[b]==="number"||typeof a[b]==="boolean"))c.push([encodeURIComponent(b),encodeURIComponent(a[b])].join(e||":"));return c.join(d||";")};a.deSerialize=function(e,g,f){var c={};if(!e)return c;var d=e.split(f||";");for(var b=0;b<d.length;++b){var a=d[b].split(g||":");if(a[0])c[decodeURIComponent(a[0])]=a[1]?decodeURIComponent(a[1]):""}return c};function h(a,b,c){if(a.addEventListener)a.addEventListener(b,c,false);else a.attachEvent("on"+b,c)}},$Ads=new function(){var a=this,c=$Cookie.getCookie,d=$Utility.deserialize;a.Tags={SDN:"SDN",SCT:"SCT",KW:"KW",PV:"PV"};a.Init=function(a){if(b()&&(!a||$AdConfig.ear))window.setTimeout(f,$AdConfig.rd)};function f(){if(!$Ads.IsInit)for(var c=0;c<$AdConfig.Data.length;++c){var b=$AdConfig.Data[c],d=b[4].indexOf("Crm")>=0?$AdConfig.crmrd:0;if(d>0)e(b,d);else a.InitAd(b)}}function e(c,b){window.setTimeout(function(){a.InitAd(c)},b)}a.InitAd=function(a){if(!a||!b()||!$(a[0]))return;if($AdConfig._dispose)return;if(!a.isInit){var c=$(a[0]+"_adchoice");if(c)c.style.display="block";$AdLoader.renderAd(a,true);a.isInit=true}if(!$Ads.IsInit){$Ads.IsInit=true;$Ads._lr=new Date;$Ads._ac=0}if($Acb._initSkipped&&!$Acb._initRetried){$Acb.init();$Acb._initRetried=true}};a.Refresh=function(){if(!b())return;if($AdConfig._dispose)return;if(!$Ads.IsInit)a.Init();else if(++$Ads._ac>=$AdConfig.ar){var c=new Date;if($AdConfig.mi<(c-$Ads._lr)/1e3){$Ads._lr=c;$Ads._ac=0;$AdLoader.refreshAds();if($AdConfig.rCb)$AdConfig.rCb()}}};a.Dispose=function(){if(!b())return;$AdLoader.dispose()};a.SetTag=function(d,c){if(!b())return;if(!c)c="";if(d){c=c.trim();if(d==$Ads.Tags.SCT&&!$AdConfig.dSDTags){if(c.match($AdConfig.rx_SCT))a.SetSDTag("SCT="+c.encodeURIComponent())}else if(d==$Ads.Tags.PV&&!$AdConfig.dPVTag){if(c!="I"&&c!="R")c="";var e=function(a){a["pvTag"]=c};$AdConfig.Data.forEach(e)}}};a.SetSDTag=function(a){if(!b()||$AdConfig.dSDTags)return;if(!(a&&a.indexOf&&(a.indexOf("SDN=")>=0||a.indexOf("SCT=")>=0)))a="";var c=function(b){if(b[5])b["sdTag"]=a};$AdConfig.Data.forEach(c)};function b(){return typeof $AdConfig!="undefined"}a.getPGWithTags=function(a){if(!a)return "";var g=a["sdTag"]||"",f=a["pvTag"]||"",j=a[1],e=j+(g?"&"+g:"")+(f?"&WLV="+f:"");if(a[7]){var i=c("MH")||"",b=d(c("ANON")||""),h=c("MUID")||"";e+=(i?"&PN="+i:"")+(b&&b.A?"&ID="+b.A:"")+(h?"&MUID="+h:"")}return e};a.getAdData=function(b){if(b){var a=$AdConfig.itod[b];if(isNaN(parseInt(a)))return;return $AdConfig.Data[a]}}},$AdLoader=new function(){var e=this,c=0,a=false;this.renderAd=function(c,g){if(!c||!$(c[0]))return;if($BSI.isLoading()&&g)$CSIPerf.lapseTimer(c[4]);if(c[7]&&$AdConfig.ss.rurl&&!$AdConfig.fl){if(!a){if(window["postMessage"])window.attachEvent("onmessage",$AdServeMsngr.receiveMessage);$AdConfig.ss.hnegurl=$AdConfig.ss.hnegurl.replace("!domain!",encodeURIComponent(document.domain));a=true}var f=c[0]+"_frm";if(!$(f)){var e=document.createElement("IFRAME");e.id=e.name=f;e.width=c[2];e.height=c[3];e.scrolling="no";e.frameBorder="0";e.allowTransparency=true;e.src=$AdConfig.ss.rurl.replace("{0}","adloader.html")+d(c)+"#"+$AdServeMsngr.serialize(b(f,true));$(c[0]).appendChild(e)}else $AdServeMsngr.toFrame(f,"$AdServe.refreshAd",b(f,false),$AdConfig.ss.rurl.replace("{0}","AdServeMsg.html"))}else if(typeof dapMgr=="undefined"||$AdConfig.fl){var h=$(c[0]);h.innerHTML=["<img src='",$AdConfig.burl,c[4],$AdConfig.ext,"' alt=''>"].join("")}else{dapMgr.enableACB(c[0],false);dapMgr.renderAd(c[0],$Ads.getPGWithTags(c),c[2],c[3])}if(g)$Acb.display(c[0])};this.refreshAds=function(){for(var b=0;b<$AdConfig.Data.length;++b){var a=$AdConfig.Data[b];if(a.isInit&&$(a[0])){$(a[0]+"_p").parentNode.style.display="block";$Acb.closePopover();$Acb.clearRadIds(a[0]);$RmAdHandler.dispose(a[0]);e.renderAd(a,false)}}};this.dispose=function(){var d,b;$AdConfig._dispose=true;$AdConfig.fl=true;$AdConfig.ar=1e4;for(var c=0;c<$AdConfig.Data.length;++c)try{b=$AdConfig.Data[c];if(b[7]){d=$(b[0]+"_frm");if(d)d.src=$AdConfig.ss.rurl.replace("{0}","adloader.html")}else{var a=$(b[0]);while(a&&a.firstChild)a.removeChild(a.firstChild)}}catch(e){}};function d(a){var b=$AdConfig.ss.srmad,c="";if($AdConfig.intad&&(b=="1"||b=="2")&&(a[0].indexOf("300x250")!=-1||a[0].indexOf("160x600")!=-1||a[0].indexOf("300x600")!=-1))c="?srmad="+b+"&ow="+a[2]+"&oh="+a[3]+"&el=200&er=50&et=50&eb=50";return c}function b(b,e){if(!b)return {};var d=$AdConfig.itod[b.replace("_frm","")],a=$AdConfig.Data[d];if(e)return {pgqp:$Ads.getPGWithTags(a),divid:a[0],wt:a[2],ht:a[3],pg:a[6],hnegurl:$AdConfig.ss.hnegurl,hstkn:$AdConfig.ss.hs,adenv:$AdConfig.intad?"int":"",adcntr:c++};else return {pgqp:$Ads.getPGWithTags(a),adcntr:c++}}},$RmAdHandler=new function(){var b={},a=null;this.processMsg=function(e){if(e&&(e.hstkn&&e.hstkn==$AdConfig.ss.hs)&&e.adDivId&&e.act){var f=e.adDivId,g=$Ads.getAdData(f);if(!(g&&g[7]))return;if(e.act=="init"){if(!b[f]){var h={adDivId:f,width:parseInt(g[2]),height:parseInt(g[3]),left:d(e.ol),right:d(e.or),top:d(e.ot),bottom:d(e.ob)};b[f]=new $RmExpAd;b[f].init(h,true);c("Init")}}else if(e.act=="exp"){if(b[f]&&parseInt(g[8]&1)==1){b[f].expand();c("Expand")}}else if(e.act=="col"){if(b[f]&&parseInt(g[8]&1)==1){b[f].collapse();c("Collapse")}}else if(e.act=="createH"){if(!a&&parseInt(g[8]&2)==2){a={};a[f]=new $RmHeaderAd;a[f].createAdContainer(f);c("HeaderCreate")}}else c("InvalidApi")}};this.processMsgFromHeader=function(b){if(b&&(b.hstkn&&b.hstkn==$AdConfig.ss.hs)&&b.adDivId&&b.act){var f=b.adDivId,g=$Ads.getAdData(f);if(!(g&&g[7]))return;if(b.act=="initH"){if(e(f)){var h={adDivId:f,height:d(b.ht),bottom:d(b.ob)};a[f].init(h);c("HeaderInit")}}else if(b.act=="expH"||b.act=="colH"){if(e(f)){a[f].resize({easingb:d(b.easingb)},b.act=="expH");c(b.act=="expH"?"HeaderExpand":"HeaderCollapse")}}else if(b.act=="closeH"){if(e(f)){a[f].close();a[f]=null;a=null;c("HeaderClose")}}else c("InvalidApi")}};this.dispose=function(c){if(c){if(b[c]){b[c].resetUI();b[c]=null}if(a&&a[c]){a[c].resetUI();a[c]=null;a=null}}};function e(b){return b&&a&&a[b]}function d(b){var a=!isNaN(parseInt(b))?parseInt(b):0;return a>=0?a:0}function c(a){if(a)$BSI.reportEvent("ClickedSelected.Business.Ads",{RmAPI:a,RmAPIAdID:0})}};new function(){window.$RmExpAd=function(){};var a=$RmExpAd.prototype;a.init=function(l,h){if(!l)return;var m=this,b="px",a=this.params=l,i=a.adDivId;if(h){var k=[$("SkyscraperContent"),$("RadAd_Skyscraper"),$("skyScraperContainer"),$("RadAdSkyscraper")];for(var j=0;j<k.length;++j){var e=k[j];if(e){var f=e.currentStyle;if(f&&f.position&&f.position=="absolute"){e.style.overflow="visible";e.style.zIndex="2"}}}var g=$(i+"_p").style;g.position="relative";g.width=a.width+b;g.height=a.height+b}var d=$(i).style;if(h)d.position="absolute";d.width=a.width+b;d.height=a.height+b;d.top=0+b;d.left=0+b;var c=$(i+"_frm").style;if(h)c.position="absolute";c.width=a.width+a.left+b;c.height=a.height+a.top+b;c.left=-a.left+b;c.top=-a.top+b};a.expand=function(){if(!this.params)return;var f=this,b="px",a=f.params,e=a.adDivId,d=$(e).style;d.width=a.width+a.left+a.right+b;d.height=a.height+a.top+a.bottom+b;d.left=-a.left+b;d.top=-a.top+b;var c=$(e+"_frm").style;c.width=a.width+a.left+a.right+b;c.height=a.height+a.top+a.bottom+b;c.left=0+b;c.top=0+b};a.collapse=function(){if(!this.params)return;this.init(this.params,false)};a.resetUI=function(){if(!this.params)return;var g=this,e="px",f=g.params,c=f.adDivId,d=$(c).style,a=$(c+"_p").style,b=$(c+"_frm").style;d.position=a.position=b.position="static";d.top=a.top=b.top=0+e;d.left=a.left=b.left=0+e}};new function(){window.$RmHeaderAd=function(){};var a=$RmHeaderAd.prototype;a.createAdContainer=function(b){if(!b)return;if(!$("c_headerAd")){var e=document.createElement("div");e.setAttribute("id","c_headerAd");if($("c_header"))$("c_header").parentNode.insertBefore(e,$("c_header"))}if($("c_headerAd")&&!$(b+"_hfrm")){var a=document.createElement("IFRAME");a.id=a.name=b+"_hfrm";a.width="0px";a.height="0px";a.scrolling="no";a.frameBorder="0";a.allowTransparency=true;a.src=$AdConfig.ss.rurl.replace("{0}","headeradloader.html")+d()+"#"+$AdServeMsngr.serialize(c(b));$("c_headerAd").appendChild(a)}};a.init=function(e){if(!e||!$("c_headerAd"))return;var h=this,f="px",a=this.params=e,g=a.adDivId,d=$(g+"_hfrm").style;d.height=a.height+f;d.width="100%";var c=$("c_headerAd").style;c.height=a.height+f;c.width="100%";b()};a.resize=function(c,f){if(!c||!$("c_headerAd"))return;var i=this,j="px",a=i.params,g=a.adDivId,e=f?a.bottom:0,h=c.easingb>0&&c.easingb<a.bottom?c.easingb:e,d=a.height+h+j;$("c_headerAd").style.height=d;$(g+"_hfrm").style.height=d;b()};a.resetUI=a.close=function(){var a=$("c_headerAd");if(!a)return;while(a.firstChild)a.removeChild(a.firstChild);a.parentNode.removeChild(a)};function d(){var a="";if($AdConfig.intad)a="?srmad=2&ow=1800&oh=175&eb=250&el=0&et=0&rmh=1";return a}function c(a){return {divId:a,hnegurl:$AdConfig.ss.hnegurl,hstkn:$AdConfig.ss.hs,adenv:$AdConfig.intad?"int":""}}function b(){if($B.IE_M6&&$("c_header")){var a=$("c_header").style;a.display="none";a.display="block"}}};var $Acb=new function(){var a=this,l="acbc",f=null,i=false,h=false,b=null,r=null,q=false,e=[],c={Report:"c_ads_pr",ThankYou:"c_ads_pty",UpSell:"c_ads_pus"},m="c_ads_default_desctxt",d={};a.init=function(){if(!window["$AdConfig"]){$Acb._initSkipped=true;return}if(window["$AdConfig"]&&$AdConfig.dp){var a=function(){if($AdConfig.pcss)$Network.fetchCSS($AdConfig.pcss,function(){h=true;k()},null);else h=true;if($AdConfig.pjs)$Network.fetchScript($AdConfig.pjs,function(){i=true;k()},null,null);else i=true;$Network.fetchXML($AdConfig.phtml,function(a){var b=!a||a.status!=200||!a.responseText;if(!b){f=a.responseText;k()}},"GET",null,null)};setTimeout(a,$AdConfig.pd)}};a.report=function(b){$BSI.reportEvent("ClickedSelected.Business.AdControlBar",{AdControlBarAction:"Report"});a.closePopover();r=b;j(c.Report);var e=$AdConfig.Data[$AdConfig.itod[b]];if(e[7]&&!d[b])$AdServeMsngr.toFrame(e[0]+"_frm","$AdServe.getRadIds",null,$AdConfig.ss.rurl.replace("{0}","AdServeMsg.html"))};a.close=function(b,f){$BSI.reportEvent("ClickedSelected.Business.AdControlBar",{AdControlBarAction:"Close"});a.closePopover();$(b+"_p").parentNode.style.display="none";if($AdConfig.eups){var e=$Cookie.getPersistentCookie(l);if(typeof e=="undefined")$Cookie.setPersistentCookie(l,"1");else{var d=(parseInt(e)+1)%$AdConfig.usi;$Cookie.setPersistentCookie(l,d);if(d%$AdConfig.usi==$AdConfig.uso){j(c.UpSell);$BSI.reportEvent("ClickedSelected.Business.AdControlBar",{AdControlBarAction:"Upsell"})}}}if(typeof f=="function")f(b);n(b,$AdConfig.cadrsn,null)};a.closePopover=function(){if(b)b.minimize()};a.sendReport=function(){var d,f;for(var e=1;(f=$("c_ads_opt"+e))&&!d;e++)if(f.checked)d=e;j(c.ThankYou);var b=$("c_ads_desc_txt");if(b.value==b.getAttribute("defaultvalue"))b.value="";else a.ensureDescMaxLength(b,b.getAttribute("maxlength"));n(r,d,b.value)};function n(g,f,c){var b=a.getAdIds(g);for(var d in b)b[d]=b[d].encodeUrl();c=c?c.encodeUrl():"";var e=$AdConfig.furl.format(b.adid,b.pid,b.targetid,b.url,b.pg,f,$AdConfig.fcan.encodeUrl(),c)+"&cb="+(new Date).getTime();$Beacon.fire(e,$BSI.addLDToHash({}))}a.toggleSend=function(b){$("c_ads_pr_sub").disabled=!b;if(!b){var c=1,a;while(a=$("c_ads_opt"+c++))a.checked=false;o($("c_ads_desc_txt"))}};a.display=function(b){var a=$(b+"_acb");if(a)if($AdConfig.dp&&p()||!$AdConfig.dp)s(a);else e.push(a)};a.ensureDescMaxLength=function(b,a){if(isNaN(parseInt(a,10)))a=200;if(b.value.length>a){b.value=b.value.substring(0,a);return false}};this.onDescFocus=function(a){if(a.value==g(a)){$css.remove(a,m);if($B.Firefox||$B.IE)a.select();else a.value=""}};this.onDescBlur=function(a){if(a.value==""||a.value==g(a))o(a)};function o(a){$css.add(a,m);a.value=g(a)}function g(a){return a.getAttribute("defaultvalue")}var k=function(){if(e&&p()){for(var a=0;a<e.length;a++)s(e[a]);e=null}},s=function(a){if(a)a.style.display="inline"},p=function(){return h&&i&&f!=null},j=function(d){if(!(window["$UI"]&&$UI.Popover&&f))return;if(!b){var e=_ce("div");b=new $UI.Popover;e.innerHTML=f;b.width=500;b.showFooter=false;b.showHeader=false;b.body=e;b.modal=false;b.bodyPadding=5}if(!q){b.show(function(){a.closePopover();return false});q=true;t(d)}else{t(d);b.restore()}switch(d){case c.Report:$("c_ads_opt1").focus();break;case c.ThankYou:$("c_ads_pty_close").focus();break;case c.UpSell:$("c_ads_pus_close").focus()}},t=function(d){var e,b;for(e in c){b=c[e];$(b).style.display=d==b?"block":"none"}if(d==c.Report)a.toggleSend(false)};a.setRadIds=function(a){if(a&&(a.hstkn&&a.hstkn==$AdConfig.ss.hs)&&a.hostAdDivId){var b={};b.adid=a.adid||"";b.pid=a.pid||"";b.targetid=a.targetid||"";b.pg=a.pg||"";b.url=a.url||"";d[a.hostAdDivId]=b}};a.clearRadIds=function(a){if(d[a])d[a]=null};a.getAdIds=function(g){if(d[g])return d[g];var c={adid:"",pid:"",targetid:"",url:"",pg:""};try{var f=$(g).childNodes,b,c,i,j=["iframe","embed"],e,h;c["pg"]=$AdConfig.Data[$AdConfig.itod[g]][6];for(var a=0;a<f.length;a++)if((h=f[a].id)&&h.startsWith("dapIfM"))if(h.endsWith("Child"))i=f[a];else b=f[a];if(b){if(b.contentWindow["getRADIds"])e=b.contentWindow.getRADIds();b=i||b;for(var a=0;a<j.length;a++)if(innerAd=b.contentWindow.document.getElementsByTagName(j[a])[0]){c["url"]=innerAd.getAttribute("src")||"";break}}if(e){c.adid=e.adid;c.pid=e.pid;c.targetid=e.targetid}}catch(k){}return c}};$Ads.Init(true);$Acb.init();if(!window["$IS"])$IS={};new function(){var e=$IS,i=$css.has,m=Math.abs,s="top",r="left",f="height",g="width",c="px",d="backgroundPosition",k="backgroundImage",a="style",b="currentStyle",l="parentNode",y="auto",h="IMG",j="is_c",o="is_hc",q=null;e.setClass=function(m,s){if(!m)return;var j=p(m);if(j){var c=j.getElementsByTagName(h)[0],e=i(j,o);c.className=(e?"is_hcimg ":"is_img ")+s;if(e){var k=c[l],q=parseInt(c[b][d+"X"]),r=parseInt(c[b][d+"Y"]);if(!n()){c[a][g]="";c[a][f]=""}var u=parseInt(k[b][g]),t=parseInt(k[b][f]);w(c,q,r,t,u,e)}}};e.toggle=function C(x,v,q){if(!x||v==0)return;var o=p(x);if(o){var c=o.getElementsByTagName(h)[0],n=i(o,j),e=c;if(!n)e=c[l];if(q){c.alt=q;if(c.title!=null)c.title=q}var k=c[b][r]||c[a][r],m=c[b][s]||c[a][s];if(n){var t=c[a][d].split(" ");k=c[b][d+"X"]||t[0];m=c[b][d+"Y"]||t[1]}k=parseInt(k);m=parseInt(m);var z=parseInt(e[b][g]||e[a][g]),u=parseInt(e[b][f]||e[a][f]),y=m-u*v;w(c,k,y,u,z,!n)}};function w(b,e,h,j,k,i){if(i){b[a][s]=h+c;b[a][r]=e+c;if(!n()){b[a][f]=m(h)+j+c;b[a][g]=m(e)+k+c}}else b[a][d]=e+c+" "+h+c}e.Create=B;function B(n,o,r,p,m,q,i,e){var l=u("span",0,j),b=u(h,l,"is_img");b.src=m+"is/invis.gif";b[a][g]=r+c;b[a][f]=p+c;b[a][d]="-"+n+c+" -"+o+c;b[a][k]="url('"+q+"')";e=e||e==""?e:i;b.alt=i;b.title=e;t(b);return l}e.CreateFromConfig=z;function z(c,a,b){c=x(c.split(","));a=x(a.split(","));b=b?b.trim():b;var d=$B.rtl&&c[1]?c[1]:c[0];return e.Create(a[0],a[1],a[2],a[3],b,b+d,a[4])}function x(a){for(var b=0;b<a.length;b++){var c=a[b];if(c)a[b]=c.trim()}return a}function p(c){if(c){var d=c.getElementsByTagName("span"),g=d.length,h,a=-1;for(;a<g&&!h;a++){var b=a==-1?c:d[a],f=i(b,j),e=i(b,o);if(f||e)return b}}return 0}function u(d,b,c){var a=document.createElement(d);a.className=c;if(b)b.appendChild(a);return a}e.Init=t;function t(c){if(c.tagName!=h)c=p(c).getElementsByTagName(h)[0];if(c&&i(c,"is_img")){var L=c[a],r=c[l];if(r){r.dir=$B.ltr?"ltr":"rtl";var q=n();if(A(c)||!q){var s='"style="width:{2}px;height:{3}px;"',w='<span class="',C='<img src="{6}"',x="</span>",J=[w,"is_o",s,">",w,"is_i",s,">",C,'class="is_hcimg {11}"alt="{1}"{10}style="left:-{4}px;top:-{5}px;width:{7}px;height:{8}px;{9}"/>',x,x,C,'class="is_p',s,"/>"].join(""),H=r[l];if(H){var v=H.getElementsByTagName("span"),u=0;for(;u<v.length;u++)v[u][a].zoom=1}var e=L[k],z=e.indexOf("http");e=e.substr(z,e.length-z-(e.endsWith('")')?2:1));var I=parseInt(c[b][g]),G=parseInt(c[b][f]),E=m(parseInt(c[b][d+"X"])),F=m(parseInt(c[b][d+"Y"])),D,B;if(!q){D=E+I;B=F+G}var t=c.title,K=J.format(c.src.encodeHtmlAttribute(),c.alt.encodeHtmlAttribute(),I,G,E,F,(q?e:c.src).encodeHtmlAttribute(),q?y:D,q?y:B,q?"":"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e.encodeHtmlAttribute()+"',sizingMethod='crop');",t||t==""?'title="'+t.encodeHtmlAttribute()+'"':"",c.className.replace("is_img",""));$css.swap(r,j,o);r.innerHTML=K}}}}e.disposeAll=v;function v(f){var e=f.getElementsByTagName(h);for(var d=0,g=e.length;d<g;d++){var c=e[d],b=c.className;if(b=="is_img"||b=="is_hcimg"||b=="is_p"){c.onload=null;c[a][k]=""}}}function n(){return !$B.IE_M6||$B.IEM_M8}function A(c){if(q==null){var a;if(c[b])a=c[b][k];q=a=="none"}return q}$Do.register("$IS.Init",t);$Do.register("$IS.disposeAll",v)};new function(){$Trie=function(f){var b=this,a=[],d=f,c=false;b.insert=function(d,b){a.push({key:d,datum:b});c=false};b.sort=function(){if(!c)a.sort(function(c,d){var a=c.key,b=d.key;if(a>b)return 1;if(b>a)return -1;return 0});c=true};b.matchPrefix=function(l){var i=null,g=null,h=null,m=null,c=null,k=null,j=null;b.sort();i=e(l);if(i==null)return [];for(g=i;g>0;g--)if(!a[g-1].key.startsWith(l))break;for(h=i+1;h<a.length;h++)if(!a[h].key.startsWith(l))break;c=new Array(h-g);for(var f=0;f<c.length;f++)c[f]=a[g+f].datum;if(d){c.sort(d);k=[j=c[0]];for(var f=0;f<c.length;f++)if(d(j,c[f]))k.push(j=c[f]);return k}else return c};function e(d){var f=0,e=a.length-1,b=null,g=null,c=null;while(f<=e){b=Math.floor((f+e)/2);c=a[b].key.substring(0,d.length);if(d>c)f=b+1;else if(d<c)e=b-1;else return b}return null}}};function ic_onTE(a){try{var c=a.getAttribute("errsrc")||$icerrsrc;if(a.src!=c){a.className="c_ic_tile";var b=a.style;b.top=b.left=b.height=b.width="";setTimeout(function(){a.src=c;a.style.visibility=""},0)}}catch(d){}}function ic_onTL(a){try{var c=a.width,b=a.height;a.className="c_ic_tile";var j=a.width,i=a.height,e,d,l=0,m=0;if(c==0&&b==0){var k=new Image;k.src=a.src;c=k.width;b=k.height}var h=a.currentStyle;if(c==1&&b==1||h&&h.width=="1px"&&h.height=="1px"){ic_onTE(a);return}var g=Math.round;if(c&&b&&c!=b){if(c>b){d=i;e=g(i*(c/b));l=-g((e-j)/2)}else{e=j;d=g(j*(b/c));m=-g((d-i)/2)}var f=a.style;if(d&&e){f.width=e+"px";f.height=d+"px";f.left=l+"px";f.top=m+"px"}}a.style.visibility=""}catch(n){}}window.$ic={eventutil:{},dom:{},data:{},constants:{ControlDataIndex:{cid:"0",showmenu:"1",menudefault:"2",name:"3",contactid:"4",deccid:"5",address:"6",membername:"7",membernamescope:"8",additionalchickletdata:"9",thirdpartyname:"10",attachmenutobody:"11",placedintable:"12",menucustom:"13",tileitemid:"14",nameitemid:"15",psmitemid:"16",badgeitemid:"17",actiontypeurloverride:"18",childicid:"19",extradata:"20"},MenuIndex:{text:"0",url:"1",itemid:"2",callback:"3",target:"4"},InlineMenuIndex:{rm:"0",psm:"1",ut:"2"},RendeModes:{utnmpsm:"0",utnmem:"1",nmem:"2",em:"3"}},ItemType:{Tile:"Tile",Name:"Name",Message:"Message",MenuCustom:"MenuCustom"},scoped_eval:function(p_args){eval(p_args)}};new function(){var d=$ic,n,J,H,O="icTm",T=4,E,m,w,c,h,p=d.constants,g,G,Z="&nbsp;-&nbsp;",S=21,K=$B.IE,db=$B.IE_M6,gb=$B.ltr,fb=$B.IE_M7,ab=$Config,U=625,l=p.MenuIndex,a=p.ControlDataIndex,u,b,x,P,s,r="menu_ul",y="usertile",N=y+"container",o="frame_clip",Q="title",R="alt",A="onclick",v="none",I="href",L="id",q="undefined",X="c_ic_menu",M="c_ic_menu_separator",j="style",k="setAttribute",z="display",e="replace",D="innerHTML",t="parentNode",C="appendChild",i="length",B=window._ce,f=function(a){return a.join("")};function eb(){m=d.eventutil=new V;g=m.addEvent;G=m.removeEvent;w=d.dom=new W;c=w.$;h=d.data=new bb;u=h.ControlData;b=u.getItem;x=u.getObject;P=h.CommonData;s=P.getItem;E=d.menu=new cb;n=d.ic=new Y;if(!window.ic_dinit)d.ic.init()}function V(){var b=this;b.stopEventAction=function(a){K?(event.returnValue=false):a.preventDefault()};b.eventTarget=function(a){return K?event.srcElement:a.target};var a={};b.dispose=function(){for(var c in a)if(!FunctionHelper.isSpecialMember(a,c))b.removeAllICEvents(c,1);a=null;b=null};var c=function(a){return !a||a==""?"icglobalevent":a};b.addEvent=function(e,d,f,b){b=c(b);if(!a[b])a[b]=[];e.attachEvent(d,f);a[b].push({el:e,e:d,f:f})};b.removeEvent=function(h,g,j,d){d=c(d);var f=a[d],e=f[i],b;while(e--){b=f[e];if(b.el==h&&b.e==g&&b.f==j){b.el.detachEvent(b.e,b.f);a[d].splice(e,1);break}}};b.removeAllICEvents=function(b,g){b=c(b);var e=a[b],f=e[i],d;while(f--){d=e[f];d.el.detachEvent(d.e,d.f)}if(!g)delete a[b];else a[b]=null}}function W(){var a={},b=this;b.dispose=function(){a=null;b=null};var c=function(a){return a&&a.indexOf("_")>0?a.split("_")[0]:""};b.getIcIdFromAnyParent=function(d){var a=m.eventTarget(d),b=c(a.id);while(b==""&&a[t]){a=a[t];b=c(a.id)}return b};b.$=function(e,d){var b=f([e,"_",d]),c=a[b];if(!c)c=a[b]=$(b);return c};b.clearByPrefix=function(c){for(var b in a)if(b.indexOf(c)==0&&!FunctionHelper.isSpecialMember(a,b))delete a[b]}}var F=function(a,b){if(a)a.splice(a.indexOf(b),1)};function bb(){var a=this;a.dispose=function(){a.Itemid_Element_Map.dispose();a.Cid_Icid_Map.dispose();a.ControlData.dispose();a=null};a.Itemid_Element_Map=new function(){var a={},b=this;b.add=function(d,c,f){if(!d||!c||!f)return;var b=a[d];if(!b)b=a[d]={};var e=b[c];if(!e)e=b[c]=[];e.push(f)};b.remove=function(d,b,c){if(!d||!b||!c)return;var e=a[d];if(e)F(e[b],c)};b.getItem=function(d,c){var b=a[d];if(b&&b[c])return b[c];else return []};b.dispose=function(){a=null;b=null}};a.Cid_Icid_Map=new function(){var a={},b=this;b.add=function(c,d){var b=a[c];if(!b)b=a[c]=[];b.push(d)};b.remove=function(c,b){var d=a[c];F(d,b)};b.getItem=function(b){return a[b]||[]};b.dispose=function(){a=null;b=null}};a.CommonData=new function(){this.getItem=function(a){if(typeof ic_common_data!=q&&ic_common_data[a])return ic_common_data[a];return ""}};a.ControlData=new function(){var b={},a=this;a.exists=function(){return typeof ic_control_data!=q&&ic_control_data};a.getObject=function(){return b};a.removeObject=function(c){if(b[c])delete b[c];if(a.exists()&&ic_control_data[c])delete ic_control_data[c]};a.getNewObjects=function(){return a.exists()?ic_control_data:{}};a.getItem=function(c,d){var a=b[c];if(!a&&ic_control_data){a=ic_control_data[c];ic_control_data[c]=null;if(a)b[c]=a}return a&&a[d]?a[d]:""};a.dispose=function(){b=null;a=null}}}function Y(){var l=this,P=0,Q={},s={},B={},C={},L={},G={};l.init=function fb(){if(u.exists()){if(l.load)return;l.load="started";l.bind();l.load="finished";$Do.when("wlxim",0,W);$Do.register("$ic",cb)}};function cb(a){try{a()}catch(b){$WebWatson.submitFromException(b)}}function W(){var a=$WLXIM.outerWindow,b=$Utility.updateObject;if(a!=window&&!a.ic_common_data){a.ic_common_data={};ic_common_data.savedTemplates=h.savedTemplates;b(a.ic_common_data,ic_common_data);a.ic_menu_data={};b(a.ic_menu_data,ic_menu_data);a.ic_control_data={};var d=x();for(var c in ic_template_data){a.ic_control_data[c]=[];b(a.ic_control_data[c],d[c])}a.ic_template_data={};b(a.ic_template_data,ic_template_data);window.$ssl.copyOutConfig(a);a.$ic.ic.init()}}l.reinit=function(){if(u.exists())l.bind()};l.addMenuBindingRef=function(a,b){if(a)L[a]=b};l.updateMenuBindingRef=function(b){var a=L[b];if(a)a.update()};l.getICNamespaceCount=function(a){return C[a]||0};l.removeICsFromNamespace=function(a){if(P||!a)return;var b=B[a];if(b){for(var c=0;c<b[i];c++)l.removeIC(b[c],1);delete B[a]}w.clearByPrefix(a);C[a]=0};l.removeIC=function(e,r){if(P||!e)return;var k,n,j=d.ItemType,g=h.Itemid_Element_Map.remove;if(x()[e]){l.removeIC(b(e,a.childicid));if(b(e,a.showmenu)=="1"){m.removeAllICEvents(e,0);E.cleanUpMenu(e);if(c(e,o)){n=b(e,a.menucustom);for(k=0;k<n[i];++k)g(n[k][p.MenuIndex.itemid],j.MenuCustom,f([e,"_",k]))}}else{g(b(e,a.tileitemid),j.Tile,c(e,o));if(typeof uxp_p!=q)g(b(e,a.tileitemid),j.Tile,c(e,y))}h.Cid_Icid_Map.remove(b(e,a.cid),e);l.unregister(b(e,a.membername),e);g(b(e,a.nameitemid),j.Name,c(e,"name"));g(b(e,a.psmitemid),j.Message,c(e,"psm"))}u.removeObject(e);if(L[e])delete L[e];if(!r){F(B[U(e)],e);w.clearByPrefix(e+"_")}};var R=new RegExp("[https:\\/]+cid-([a-zA-z0-9]+)\\.profile","g");function ab(b){var a=R.exec(b.get_profileUrl());R.lastIndex=0;if(a&&a[i]>1)return a[1];else return null}function X(a){return K&&(a==null||a=="")?'""':a}function V(f,e){var b,a,d=f.get_addresses();for(var c=0,g=d.get_count();c<g;c++){b=d.get_item(c);a=b.get_network().get_id();if(e&&a=="WL"||!e&&a!="WL"&&a!="OCS"&&a!="YH"&&a!="SMS")return b}return 0}l.createICFromTemplate=function(l,c,m,o,w,B,A,k,q,t,s,d,I,P,E,N){var M="get_currentAddress",v="get_presence",F,G,u,p,y,j,r;if(c){y=V(c,1);j=V(c,0);B=B||ab(c);A=A||c.get_cid();if(j)p=j.get_linkedContact();k=k||$WLXIM.getDisplayName(c);u=c[M]();if(c.get_emailAddress)F=c.get_emailAddress();s=s||c[v]().get_displayPictureUrl();if(!d)d=G=c[v]().get_personalMessage();if(!t)if(m)t=m.get_id();else if(u)t=u.get_id();q=q||F;if(!o&&m){var K=m.get_network();if(K)o="n:"+K.get_id()}}o=o||"a";w=w||l;l=O+l;var g=x()[l];if(g){var b=[];window.ic_control_data=window.ic_control_data||{};for(var f=0,T=Math.max(g[i],S);f<T;f++)switch(f+""){case a.menudefault:var R=g[f];if(y){var n=[];if(!(c&&!c.get_isContact())){if(m)n.push(m.get_type()==J.MLM.IMAddressType.telephone?"si":"ss");n=n.concat(R);if(j){var L=n.indexOf("se");if(L>0)n.insert(L+1,"sm3")}}b.push(n)}else if(j){var C=["si","se","sm3","ph3","pr3"];if(c&&c.get_isContact())C.push("af");b.push(C)}else b.push(["se","vd"]);break;case a.contactid:b.push(c?c.get_id()+"":g[f]);break;case a.cid:b.push(B);break;case a.name:b.push(k);break;case a.deccid:b.push(A);break;case a.additionalchickletdata:b.push([I?I:-1,d,s?window.$ssl.ensureSSLImageUrl(s+""):0,P]);break;case a.address:b.push(q);break;case a.membername:b.push(t);break;case a.thirdpartyname:var R=g[f];if(j)b.push(p.get_network().get_name());else b.push(g[f]);break;case a.attachmenutobody:b.push(E?E:g[f]);break;case a.membernamescope:b.push(o);break;case a.actiontypeurloverride:var R=g[f];if(j)b.push({pr3:p.get_profileUrl()+"",ph3:p.get_photosUrl()+"",sm3:p.get_sendMessageUrl()+""});else b.push(g[f]);break;case a.extradata:b.push({ltnu:N});break;default:b.push(g[f])}var Q=window.ic_template_data[l]++,z=w+l+Q;window.ic_control_data[z]=b;if(d)if(!$B.Mobile&&H&&G==d)if(c)d=c[v]().createPersonalMessageElement()[D];else d=H.Messenger.MessengerUtility.emoticonEncode(d)[D];else d=d.encodeHtmlAttribute();if(k)k=k.encodeHtmlAttribute();if(q)r=q.encodeHtmlAttribute();else if(j&&!y)r=k+" ({0})".format((j.get_network().get_name()+"").encodeHtmlAttribute());else r=k;var U=h.savedTemplates[l][e](new RegExp(l,"g"),z).format(k,d?Z+d:"",d?d:"",X(r));eb();return {html:U,id:z}}return null};var M,eb=function(){if(M)clearTimeout(M);M=setTimeout(l.reinit,10)};l.getICTileSize=function(b){var a=c(b,"usertilecontainer")&&c(b,"usertilecontainer").className.split(" ");if(a&&a[1])return a[1].replace("c_ic_img_","");else return ""};l.displayICAsFav=function(a){var b=c(a,"menu_af"),d=c(a,"fstarp");if(b){b[j][z]=v;E.HideSeparatorIfLastVis(b);c(a,r).binding.update()}if(d){$css.remove(d,"c_ic_fstarp_hide");var e=c(a,"name");if(e)$css.add(e.parentNode,"c_ic_name_fstar_"+l.getICTileSize(a))}};l.dispose=function(){window.detachEvent("onunload",l.dispose);E.dispose();m.dispose();h.dispose();if(d.presence)d.presence.dispose();w.dispose();C=B=L=Q=s=G=l=_focusShowMenuTimeout=_onhoverShowMenu_ic_id=null;P=1};window.attachEvent("onunload",l.dispose);function db(){if(!h.savedTemplates)if(ic_common_data.savedTemplates)h.savedTemplates=ic_common_data.savedTemplates;else{var b={};for(var a in ic_template_data)if(!FunctionHelper.isSpecialMember(ic_template_data,a)){var c=$(a+"_template");$IS.Init(c);b[a]=c[D]}h.savedTemplates=b}}l.set_wlxim=function(){J=$WLXIM};l.set_wlximML=function(){H=J.ML};l.get_membername_id_map=function(){return Q};l.get_membername_iclist_map=function(){return s};function Y(a){ic_onTL(m.eventTarget(a))}function bb(a){ic_onTE(m.eventTarget(a))}l.getMemberFavoriteList=function(){return G};l.removeMemberFromFavoriteList=function(a){if(G[a])delete G[a]};l.register=function gb(f,e){if(!e)return;if(f){if(!s[f])s[f]=[];s[f].push(e);if(G[f])l.displayICAsFav(e)}var h=c(e,y);if(h&&!h.src){g(h,"onload",Y,e);g(h,"onerror",bb,e);var i=b(e,a.additionalchickletdata),k=p.InlineMenuIndex;if(i&&i[k.ut]){h.src=i[k.ut];if(i[k.rm]==p.RendeModes.nmem)c(e,N)[t][j][z]=v}else h.src=h.getAttribute("errsrc")||$icerrsrc;n.updateMenuBindingRef(e)}if(d.presence&&f)d.presence.updateStatusFromRegister(f,e)};l.unregister=function(a,b){if(!a||!b)return;F(s[a],b)};function U(a){return a.substring(0,a.indexOf("ic"))}l.bind=function(){var e,j,w,r,v,n=d.ItemType,m=h.Itemid_Element_Map.add;db();for(e in u.getNewObjects()){var s=U(e),t=B[s];if(!t){t=B[s]=[];C[s]=0}t.push(e);C[s]++;if(e.substring(0,T)==O){b(e,a.showmenu);continue}if(!$(e))continue;if(b(e,a.showmenu)=="1"){j=c(e,o);if(!j)continue;g(j,"onmouseover",l.initMenu,e);g(j,"onfocus",l.initMenu,e);g(j,"onclick",l.initMenu,e);w=c(e,"name");if(w)g(w,"onclick",function(){$BSI.reportEvent("icm",{c:"n"},1)},e);j[k](I,"#");j[A]=null;v=b(e,a.menucustom);for(r=0;r<v[i];++r)m(v[r][p.MenuIndex.itemid],n.MenuCustom,f([e,"_",r]))}else{m(b(e,a.tileitemid),n.Tile,c(e,o));if(typeof uxp_p!=q)m(b(e,a.tileitemid),n.Tile,c(e,y))}h.Cid_Icid_Map.add(b(e,a.cid),e);l.register(b(e,a.membername),e);m(b(e,a.nameitemid),n.Name,c(e,"name"));m(b(e,a.psmitemid),n.Message,c(e,"psm"))}window.ic_control_data=null};l.initMenu=function(a){var b=w.getIcIdFromAnyParent(a);E.initMenu(b,a);return false}}function cb(){var E=this,h={};E.dispose=function(){l=null;for(var a in h)if(!FunctionHelper.isSpecialMember(h,a))E.cleanUpMenu(a,1);h=null;E=null};function Y(a){return h[a]=function(){var b=c(a,r);if(!b.binding.isOpen())P(a,0);else P(a,2000055)}}function T(a){return function(){J(a,y);J(a,o,1)}}function V(a){return function(){K(a,y);K(a,o,1)}}E.cleanUpMenu=function(a,d){var b=c(a,r);if(b&&b.binding){if(h[a]){b.binding.removeStateListener(h[a]);if(d)h[a]=null;else delete h[a]}b.binding.dispose()}};function J(e,f,d){var a=c(e,f);if(a){var b=d?Q:R;a.alt_temp=a.getAttribute(b);a[k](b,"")}}function K(d,e,b){var a=c(d,e);if(a&&a.alt_temp)a[k](b?Q:R,a.alt_temp)}var P=function(d,b){var a=c(d,N);if(a){a[t][j].zIndex=b;a[t][t][j].zIndex=b;a[j].zIndex=b}},cb=function(){var c="c_ic_menus",a=$(c);if(!a){a=B("div");a.id=c;var b=document.body;b.insertBefore(a,b.firstChild)}return a},eb=function(b){var d=w.getIcIdFromAnyParent(b),a=c(d,r);if(a&&a.binding)a.binding.show();m.stopEventAction(b);return false},O="ntICTemConvICTemplate",W=O[i];E.initMenu=function(d,p){if(!c(d,r)){var h=c(d,o);h[j].outline=v;var i=n.initMenu;G(h,"onfocus",i,d);G(h,"onmouseover",i,d);G(h,"onclick",i,d);var l=T(d);l();g(h,"onmouseout",V(d),d);g(h,"onmouseover",l,d);g(h,A,eb,d);h[k](I,"#");var e,m;e=B("ul");e.className=X+" c_m t_hovl";e[k](L,f([d,"_",r]));m=Z(d,e);bb(d,e,m);if(b(d,a.attachmenutobody)=="1")cb()[C](e);else h[t][C](e);if(e.id.substring(0,W)==O&&!db)e[j].position="fixed";_chicletData=b(d,a.additionalchickletdata);$menu.bind(p,_chicletData[3],0,1,0,0,undefined,U,0,0,0,e);e.binding.addStateListener(Y(d));n.addMenuBindingRef(x()[d][a.childicid],e.binding)}};var Z=function(h,I){var O,C,D,L,r,z,B,M,G,t,K,R,k,m,v,S,P,w,y,E,W,N;if(typeof ic_menu_data!=q){O=b(h,a.menudefault)||[];C=b(h,a.cid);t=b(h,a.address);P=b(h,a.deccid);K=b(h,a.contactid);m=b(h,a.membername);R=b(h,a.name);E=p.InlineMenuIndex;y=b(h,a.additionalchickletdata);if(y&&y[i]>0&&y[E.rm]!=-1){var k="",J=y[E.rm];if(J==p.RendeModes.em)k=t;else{var V=0;if(d.presence)V=d.presence.getContact(m);var T=n.createICFromTemplate("InlineMenuTemplate",V,0,b(h,a.membernamescope),0,C,P,R,t,m,y[E.ut],J=="0"?y[E.psm]:t,J,0,b(h,a.attachmenutobody));k=T.html;x()[h][a.childicid]=T.id}g(c(h,o),A,u("sendim",{membername:m}),h);H(I,0,0,k,0,0,"mut",0,0,h,J);F(I,null,f([h,"_menu_utSeparator"]))}for(var Q=0;Q<O[i];++Q){v=O[Q];L=ic_menu_data[v];if(!L)continue;k=L[l.text];S=s("ru");r=z=D="";G=B=N=false;w=s("dmtrgt");var j=W=b(h,a.actiontypeurloverride);j=!j||!j[v]?L[l.url]:j[v];try{switch(v){case "ph3":case "pr3":case "sm3":r=j;k=k[e]("{0}",f(["(",b(h,a.thirdpartyname),")"]));w="_blank";break;case "ve":z=u("viewemail",{url:j,address:t,icid:h});break;case "cp":r=j;break;case "ed":case "dc":case "pr":case "gr":case "ev":case "ph":r=j[e]("$cid$",C);if(!C&&!W&&!j[v])B=true;break;case "vd":case "ct":r=j[e]("{contactid}",K);break;case "se":r=j[e]("{address}",t)[e]("{ru}",encodeURIComponent(S));B=!t;w=null;break;case "sm":r=j[e]("{address}",P)[e]("{ru}",encodeURIComponent(S))[e]("$cid$",C);break;case "ss":D=f([h,"_menu_ss"]);if(!d.presence||!d.presence.isAvailableForIC(h,0,1))B=true;z=u("sendsms",{icid:h,membername:m});w=null;break;case "si":D=f([h,"_menu_si"]);k+=f(['&nbsp;<span id="',h,'_menu_si_pr_t">{0}</span>']);var U="";if(d.presence&&d.presence.isAvailableForIC(h,1,0))U=d.presence.webImGetPresText(h);else B=true;k=k[e]("{0}",U);z=u("sendim",{icid:h,membername:m});w=null;break;case "af":D=f([h,"_menu_af"]);G=true;z=u("addtofav",{addfavUrl:j,cid:C,cnid:K,icid:h,membername:m});N=B=d.presence&&d.presence.isFavorite(m)||n.getMemberFavoriteList()[m];w=null;break;case "c4":case "c3":case "c2":case "c1":G=true;D=f([h,"_menu_c1"]);z=u("invite",{inviteUrl:j,cid:C,email:t,cnid:K,name:R,icid:h});w=null}}catch(X){r="";v=""}if(G)M=F(I,null,f([h,"_menu_inviteSeparator"]),N);H(I,G?null:M,D,k,r,z,v,B,w,h)}}return M};function u(b,a){switch(b){case "invite":return function(){var d=a.cid,g="c",h="cid";if(a.cid=="0000000000000000")if(a.cnid&&a.cnid!=""){d=a.cnid;h="cnid";g="g"}else{d=a.email;h="email";g="e"}if(typeof window.sn_frInvite!=q)window.sn_frInvite.showFor(g+d,a.name,null,function(d){if(d.hasSucceeded){var b=c(a.icid,"menu_c1");b[j][z]=v;_hideSeparatorIfLastVis(b);c(a.icid,r).binding.update()}});else{var b=a.inviteUrl;b=f([b,"&",h,"=",encodeURIComponent(d)]);b=b[e]("{name}",encodeURIComponent(a.name))[e]("$cid$",s("vcid"))[e]("{scxt}",s("socialcontext"))[e]("{ru}",encodeURIComponent(s("ru")));$BSI.navigateTo(b,"_top")}return false};case "addtofav":return function(){S(a.icid);var e=typeof window.sn_favHandler!=q,b=ab.handlerBaseUrl+"/Handlers/ICAddToFavorite.mvc?contactId={0}&cid={1}&canary={2}";b=b.format(encodeURIComponent(a.cnid),encodeURIComponent(a.cid),encodeURIComponent(s("afcanary")));var c=function(){if(d.presence&&d.presence.enabled())d.presence.addContactToWebImFavorites(a.membername);else{$Beacon.fire(b,$BSI.addLDToHash({}));n.getMemberFavoriteList()[a.membername]=1;var f=n.get_membername_iclist_map()[a.membername],c;for(var e=0;e<f[i];++e){c=f[e];if($(c))n.displayICAsFav(c)}}};if(!e||e&&window.sn_favHandler(a.icid,a.cnid,a.cid,b,c))c();return false};case "viewemail":return function(){if(typeof window.ic_viewemail!=q)window.ic_viewemail(a.address,a.icid);else window.location=a.url[e]("{rru}",encodeURIComponent("search?keyword="+encodeURIComponent("from:"+a.address)));return false};case "sendsms":case "sendim":return function(){S(a.icid);setTimeout(function(){if(d.presence)d.presence.startIM(a.membername,b=="sendsms")},0);return false};case "customonclick":return function(){try{d.scoped_eval(a)}catch(b){return false}}}}function S(b){var a=c(b,r);if(a)a.binding.hide()}E.HideSeparatorIfLastVis=_hideSeparatorIfLastVis=function(a){if(a.nextSibling==null)a.previousSibling[j][z]=v};var bb=function(h,g,f){var e,c,d,j;e=b(h,a.menucustom);while(e[i]>0){c=e.shift();d=null;if(c[l.text]&&c[l.text]==M)F(g,f);else{if(c[l.callback]){d=c[l.callback];if(typeof d=="string")d=u("customonclick",d)}H(g,f,null,c[l.text],c[l.url],d,"mc",null,c[l.target],h)}}},H=function(i,h,p,o,c,d,l,r,m,n,q){var b,a,f,e;if(d&&!c){c="#";f="return false;"}if(o){b=B("li");e=c||d?"a":"span";a=B(e);if(p)b[k](L,p);if(e=="span")a.className="link c_icinmenu"+q;if(c){a[k](I,c);if(f)a[k](A,f);if(m)a[k]("target",m)}if(l)g(a,A,function(){$BSI.reportEvent("icm",{c:l},1)},n);if(d)g(a,A,d,n);a[D]=o;if(r)b[j][z]=v;b[C](a);if(h)i.insertBefore(b,h);else i[C](b)}return b},F=function(c,b,d,e){var a=B("li");if(d)a[k](L,d);a[D]='<div class="c_ms">&nbsp;</div>';a.className=M;if(e)a[j][z]=v;if(b)c.insertBefore(a,b);else c[C](a);return a}}setTimeout(eb,0)};new function(){$Logout=new function(){var d=this,a=[],b;d.add=function(b){a.push(b)};d.doLogout=function(){var d,g=0,j=a.length;if(!event.shiftKey&&!event.ctrlKey&&!event.altKey){var b=event.srcElement;while(b){if(b.tagName=="A"){var f=b.href;if(f){var i=b.target;$f.cancelEvent(event);d=new e(f,i);setTimeout(function(){c(f,i)},1e3)}break}b=b.parentNode}}var h="$logout";d.pause(h);for(;g<j;g++)try{a[g](d)}catch(k){$WebWatson.submitFromException(k)}d.resume(h)};function c(c,a){if(!b){b=1;$BSI.navigateTo(c,a)}}function e(e,d){var b=this,a=[];b.pause=function(b){a.push(b)};b.resume=function(b){a.remove(b);if(a.length==0)c(e,d)}}}};window.$Config=window.$Config||{};new function(){var b=null;function c(){var c=this,a,L="pres",I="=",h=$Config,ub=h.handlerBaseUrl,g,l,d,F=[],y=[],e,u,v,K=3,z=0,A=K,o,V,G,E,M,f,S,C,w,q,m,P,n,r;c.outerWindow=window;c.isOff=function zb(){return !n&&(!v||x()==0)};c.isUnsupported=function pb(){return S};c.isLoading=function tb(){return !c.isOff()&&!this.isError()&&(!a||a.get_status()==d.UserStatus.signingIn||a.get_status()==d.UserStatus.signingOut)};c.isError=function vb(){return !c.isOff()&&(M||a&&a.get_status()==d.UserStatus.signedOut)};c.isWaitingToReconnect=function lb(){return !c.isOff()&&a&&a.get_status()==d.UserStatus.autoReconnectWaiting};c.hasContacts=function qb(){return m};c.hasNotify=function sb(){return s()};c.hasPresence=function rb(){return s()&&a.get_services()>d.SessionServices.notifications};c.isFull=function xb(){return s()&&a.get_services()==d.SessionServices.full};function s(){return a&&a.get_status()==d.UserStatus.signedIn}c.addStateListener=function nb(a){F.push(a)};c.removeStateListener=function mb(a){var b=F.remove(a)};c.addInnerWindowListener=function kb(a){y.push(a)};c.removeInnerWindowListener=function jb(a){var b=y.remove(a)};c.signIn=function yb(){if(a&&a.get_status()==d.UserStatus.signedIn){k(1);X()}else{n=1;r=0;i()}};c.signOut=function wb(){if(a&&a.get_status()==d.UserStatus.signedIn)D();else{n=0;r=1;i()}};c.switchPresence=function ob(b){if(a)a.get_presence().set_status(b)};function D(){k(0);if(a){a.get_settings().set_signInPreference(Microsoft.Live.Messenger.SignInPreference.manualSignIn);a.set_services(d.SessionServices.notifications)}}function X(){if(a){a.get_settings().set_signInPreference(Microsoft.Live.Messenger.SignInPreference.autoSignIn);a.set_services(d.SessionServices.full);T("Full")}}function B(){try{e.detachEvent("onunload",B)}catch(a){}c.innerWindow=e=null;N()}c.init=function Ab(b){if(e&&b==window)return;o=0;if(e)B();c.innerWindow=e=b;e.$Logout.add(function(b){if(!w&&c.hasPresence()){w=1;if(b){q=b;q.pause("wim")}a.signOut()}});b.$Do.register("$WIMP",ib);if(e==window)f=$CSIPerf.startTrace("webIM");N();e.attachEvent("onunload",B);if(z>=A)W();else if(!v){v=1;h=b.$Config;$Config.email=h.email;$Config.WebIM=g=h.WebIM;$Config.sd=h.sd;x();i();ab();eb();gb()}};function W(){if(e!=window&&e){o=0;e.$Network.fetchCSS(g.c,t);e.$Network.fetchScript(g.a,t,"window.live.shared.globalsettings.webim");e.$Network.fetchScript(g.j,t,"webimui")}}function t(){o++;if(o>=K){e&&e.$Do.register("wlximuiinner");if(V&&e&&e!=window)e.$Do.register("wlximlocalstoreready")}}function ab(){if(e==window)return;var f=e.document.getElementsByTagName("link"),g=e.document.getElementById("themecss"),a=0,j=f.length;for(;a<j;a++){var h=f[a],c=h.href;if(c&&h.type=="text/css"){A++;i(c)}}function i(a){smartSetTimeout(function(){$Network.fetchCSS(a,p)})}if(g){var b=g.innerHTML;if(b){var d=document.createElement("div"),k=_d.getElementById("head")||_dh;d.innerHTML='&nbsp;<style type="text/css">'+b+"</style>";k.appendChild(d)}}}function p(){z++;if(z==A){$Do.register("wlximuiouter");if(e==window)$Do.register("wlximuiinner");W()}}function eb(){$Network.fetchCSS(g.c,p);$Network.fetchScript(g.a,p,"window.live.shared.globalsettings.webim");$Network.fetchScript(g.j,p,"webimui")}function gb(){$Network.fetchScript(g.u+g.uf,cb,"window.Microsoft.Live.Core.Loader")}function cb(){if(f)f.lapse.push({s:"loader",t:(new Date).getTime()});if(!window.Microsoft||!Microsoft.Live||!Microsoft.Live.Core||!Microsoft.Live.Core.Loader)j(90,"Microsoft.Live.Core.Loader Not found");else{c.ML=l=Microsoft.Live;l.Core.Loader.onError(hb);var a={market:$Config.mkt,"messenger.loaderPath":g.u};if(document.location.host.toLowerCase().endsWith(".mail"+$Config.sd))a["compatibility.version"]="current";l.Core.Loader.initialize(a);l.Core.Loader.load("messenger.core",db);l.Core.Loader.load("core.localstorage",bb)}}function hb(a){j(93,"Messenger Library load error: "+a)}function bb(){V=1;$Do.register("wlximlocalstoreready");if(e&&e!=window)e.$Do.register("wlximlocalstoreready")}function db(){if(!E){if(f)f.lapse.push({s:"coreLoaded",t:(new Date).getTime()});c.MLM=d=l.Messenger;if(!d||!d.WindowsLiveAuthIdentity)j(90,"Microsoft.Live.Messenger.WindowsLiveAuthIdentity not found");else{E=1;O()}}}function ib(){if(!G){if(f){f.addCsd("firstMessengerSignIn",$Cookie.getSessionCookie("WebIM")=="1"?"false":"true");f.addCsd("endpoint",window.WIMP?"new":"existing")}G=1;O()}}function O(){if(E&&G){var a=new d.WindowsLiveAuthIdentity(null,null,window.WIMP);if(h.BSI&&h.BSI.xid)a.set_experienceId(h.BSI.xid);a.add_authenticationCompleted(fb)}}function fb(h,b){if(f)f.lapse.push({s:"auth",t:(new Date).getTime()});var e=b.get_resultCode();if(e==d.AuthenticationResultCode.failure)if(b.get_isUnsupportedBrowser()){S=1;j(-1,"Authentication Failed: unsuported browser")}else j(91,"Authentication Failed");else{c.user=a=new d.User(h);a.get_settings().set_autoReconnectEnabled(true);a.get_settings().set_displayNameMode(Microsoft.Live.Messenger.DisplayNameMode.fullName);a.get_localEndpoint().set_name(g.n);if(a.get_services()!=d.SessionServices.normal){k(a.get_status());C=1}else if(b.get_multipleEndpointsNotSupported()||a.get_settings().get_signInPreference()==Microsoft.Live.Messenger.SignInPreference.manualSignIn){k(0);D()}else{k(1);a.set_services(d.SessionServices.full);T("Full")}Z();a.signIn()}}function T(a){if(!C){C=1;$BSI.reportEvent("ClickedSelected.Messaging.IMStart",{IMMode:a},1)}}function k(a){$Cookie.setCookie(L,h.hcid+I+a,h.sd,0,0,1)}function x(){var a=$Cookie.getCookie(L,1);if(a){var b=a.indexOf(I);if(b!=-1)if(a.substr(0,b)==h.hcid){a=parseInt(a.substr(b+1));if(!isNaN(a))return a}}return 1}c._pres=x;c._inform=i;function Z(){a.add_signInCompleted(U);a.add_signedOut(Y);a.add_propertyChanged(R);a.get_contact().get_presence().add_propertyChanged(Q);window.attachEvent("onunload",J)}function J(){window.detachEvent("onunload",J);a.remove_signInCompleted(U);a.remove_signedOut(Y);a.remove_propertyChanged(R);a.get_contact().get_presence().remove_propertyChanged(Q)}function U(b,a){if(a.get_resultCode()==d.SignInResultCode.success)m=1;if(!u)$Cookie.setSessionCookie("WebIM","1");H();i()}function R(e,c){var b=c.get_propertyName();if(b=="Services"||b=="Status"){if(!m&&!P&&f&&s()){f.lapse.push({s:"signedIn",t:(new Date).getTime()});P=1}if(r&&a&&a.get_status()==d.UserStatus.signedIn){r=0;D()}if(!m&&a&&a.get_status()==d.UserStatus.signedIn)m=1;if(n&&a&&a.get_status()==d.UserStatus.signedIn){n=0;X()}i()}}function Q(b){var a=b.get_status();if(a!=d.PresenceStatus.offline)k(a)}function Y(c,b){if(b.get_reason()==0&&w){j(-1,"signed out");if(q)q.resume("wim")}else if(a.get_status()!=d.UserStatus.autoReconnectWaiting)j(94,"signed out: "+b.get_reason())}function H(){if(!u){u=1;if(f){f.endTrace();f=null}}}function j(a,c){M=1;i();H();if(a!=-1)$WebWatson.submitFromException(new Error("Web IM sign in Error"+(c?c:"")),b,a,b,1)}function i(){var a=0,b=F.clone(),c=b.length;for(;a<c;a++)$WebWatson.wrapCallback(b[a])()}function N(){var a=0,b=y.clone(),c=b.length;for(;a<c;a++)$WebWatson.wrapCallback(b[a])()}}function d(){if(!$Config.WebIM)return;var b;try{b=window!=window.parent&&window.parent.location.hostname&&window.parent.$Config.WebIM&&window.parent.$Do}catch(e){}if(b){var d=window.parent;d.$Do.when("wlxim",0,function(){window.$WLXIM=d.$WLXIM;a()})}else{window.$WLXIM=new c;a()}}function a(){var b=$WLXIM;if(!$Config.WebIM.f)if($Cookie.getSessionCookie("WebIM")=="1"||!$BSI.isLoading())b.init(window);else $BSI.addLoadedCallback(a);$Do.register("wlxim");function a(){setTimeout(function(){$BSI.removeLoadedCallback(a);b.init(window)},$Config.WebIM.delay?$Config.WebIM.delay:0)}}d()};new function(){var b=window["$Preload"]={},d,l="preload_frame",m=window["$Config"]||{},h=m.Preload||{},a,i=0,e=0,g=0;function n(){if($Config.WebIM)$Do.when("wlxim",0,j);else if($BSI.isLoading()){$BSI.addLoadedCallback(c);g=1}else c();window.attachEvent("onbeforeunload",b.dispose)}function j(){d=window["$WLXIM"];d.addStateListener(f);f();e=1}b.dispose=function o(){b.pause();if(e){d.removeStateListener(f);e=0}else if(g){$BSI.removeLoadedCallback(c);g=0}window.detachEvent("onbeforeunload",b.dispose);if(a){a.parentNode.removeChild(a);a=0}};b.resume=function p(){if(a)try{a.contentWindow.$Preload.resume()}catch(b){}};b.pause=function q(){if(a)try{a.contentWindow.$Preload.pause()}catch(b){}};function f(){if(d.hasContacts())c()}function c(){var a=h.DelayMs||0;setTimeout(k,a)}function k(){if(!i){var b=h.View;i=1;if(b){a=document.createElement("iframe");a.id=l;a.width=a.height=0;a.style.display="none";a.src="/handlers/resourcespreload.mvc?bicild=&view="+b;document.body.appendChild(a)}}}n()};$CSIPerf.lapse.push({s:"sjs",t:(new Date).getTime()});window.$sn_invite_popover=window.$sn_invite_popover||function(){return {show:function(f,d,e,a,b){m_attachElName=a;var c={screenID:"0",ID:f,IDType:d,displayName:e,isSocialContext:sn_invite_common_data.isSocialContext,appMessage:b};$sn_invite_helper.makeRequest(c,true,a)},send:function(n,l,m,h,k,i,g,f,c,e){var b="";for(var a=c.length;a--;){var d=c[a];b+=d.name.encodeHtml()+"<"+d.id.encodeHtml()+(a!=0?"<":"")}var j={screenID:"1",ID:n,IDType:l,displayName:m,firstName:h,lastName:k,isProfile:i,isPresense:g,message:f,categories:b,profileUpsell:e};$sn_invite_helper.makeRequest(j,false)},hide:function(){$sn_invite_helper.hidePopover()},update:function(){}}}();window.$sn_invite_helper=window.$sn_invite_helper||function(){var a,b;function e(){a=null;return true}function c(g,i){if(a)a.hide();var c=new $UI.Popover,d=document.createElement("div");d.innerHTML=g;var f=false;if(i){d.className+=" LargeText";c.addButton("OK",sn_invite_common_data.okStr,true,true)}else{if(!a)f=true;c.bodyPadding=false}a=c;a.modal=true;a.showHeader=false;a.width=400;a.shadow=true;a.body=d;var h=b?document.getElementById(b):null;a.show(e,h);if(f)a.hide()}function d(b){if(b&&b.readyState==4)if(b.status==200)c(b.responseText);else if(a)c(sn_invite_common_data.errorStr,true)}return {getAttachElName:function(){return b},makeRequest:function(a,h,i){b=i||b;if(h)c(sn_invite_common_data.loadingStr,true);var e="dc="+sn_invite_common_data.dc.encodeURIComponent();for(var g in a){var f=a[g];if(f)e+="&"+g+"="+f.toString().encodeURIComponent()}$Network.fetchXML(sn_invite_common_data.handlerUrl,d,"POST",e,{"Content-type":"application/x-www-form-urlencoded"})},hidePopover:function(){if(a){a.hide();a=null}}}}();$sn_fetcher=function(d){var b=d||{},e=this,a;function c(f,c){e.hidePopover();a=new $UI.Popover;a.body=document.createElement("div");var d={showHeader:false,width:400,modal:true,shadow:true,bodyPadding:c};$Utility.updateObject(d,b.popoverOptions||{});$Utility.updateObject(a,d);if(c){$css.add(a.body,"LargeText");a.addButton("OK",b.okHtml,true,true)}a.show(function(){a=null;return true},f);return a}this.fetchAndRender=function(j,i,e,h){var d={};$Utility.updateObject(d,b);$Utility.updateObject(d,h||{});if(d.loadingHtml)(d.usePopover?c(e,true).body:e).innerHTML=d.loadingHtml;var g=a,f={canary:d.canary};$Utility.updateObject(f,i);return $Network.fetchXML(d.baseUrl+j,function(h){var b=h.status!=200;if(!b||d.errorHtml){var f=d.usePopover?g==a?c(e,b).body:null:e;if(f){var i=b?d.errorHtml:h.responseText;$Utility.ajaxInnerHtml(f,i)}}},"POST",$Utility.serialize(f),{"Content-type":"application/x-www-form-urlencoded"})};this.hidePopover=function(){if(a)a.hide();a=null}};$sn_frInviter=function(g,f,d,i){var a=this,e=f,c=d,h=i;this.fetcher=g;this.attachToEl;this.callback;function b(b,c){a.callback=c;a.attachToEl=b.attachElId&&$(b.attachElId);a.fetcher.fetchAndRender("details.mvc",b,a.attachToEl)}this.show=function(f,d,g){var a=e[f];if(d)$Utility.updateObject(a,c[d]);$Utility.updateObject(a,h);b(a,g)};this.showFor=function(e,c,d,f){var a={recipientId:e};if(c)a.recipientName=c;if(d)a.attachElId=d;b(a,f)};this.hide=function(){a.fetcher.hidePopover()}};registerNamespace("$Comments");$Comments.Initialize=function(){};$Comments.Dispose=function(){if(window.$Cmt)$ic.ic.removeICsFromNamespace("cmtc");$Comments.DirtyEvent.dispose();$Comments.CommentAddSuccessfull.dispose();$Comments.DirtyEvent=null;$Comments.CommentAddSuccessfull=null;$Cmt=null;$Comments.DirtyCount=0;if(window.$HipV3)var a=$HipV3.Get("CommentHip");if(a)try{a.dispose()}catch(b){}};$Comments.DisposeSelfPageControl=function(b){$ic.ic.removeICsFromNamespace("cmtc");if($Cmt!=null){$Cmt["c_"+b]=null;$Cmt["hipCCid"]=null}$Comments.DirtyCount=0;if(window.$HipV3)var a=$HipV3.Get("CommentHip");if(a)try{a.dispose()}catch(c){}};$Comments.OnViewMoreClick=function(a){$Comments.DirtyEvent.fire();var b=$Comments.PreProcessRequest("v",a);$Comments.SendRequest(b);return false};$Comments.OnDeleteClick=function(a,e,f,c){$Comments.DirtyEvent.fire();function d(){try{var d=new $UI.Popover;d.header=$Cmt["dlpohd"];d.body=document.createElement("div");var e=false;if($Cmt["currusercid"]!=c&&$Cmt["c_"+a].isgrp=="false"&&$Cmt["c_"+a].isExt!=true)e=true;d.body.innerHTML=$Cmt["dlpocnf"]+(e?"<br /><br /><input type='CHECKBOX' id='cc_rptUser' style='vertical-align:middle'>"+$Cmt["dlporpt"]:"");var g={showHeader:true,width:400,modal:true,shadow:true,bodyPadding:true};$Utility.updateObject(d,g);d.addButton("bOK",$Cmt["btok"],true,false);d.addButton("bCancel",$Cmt["btcancel"],false,true);d.show(b,f,"bOK")}catch(h){b()}}function b(f,d){var b=true,g=false;if(f!=null&&d!=null){var h=_ge("cc_rptUser");if(h!=null)g=h.checked;f.hide();if(d=="bCancel")b=false}if(b){var i={abuse:g,creator:c},j=$Comments.PreProcessRequest("d",a,e,i);$Comments.SendRequest(j)}}if(window.$UI!=null&&window.$UI.Popover!=null)d();else $Network.fetchScript($Cmt["pourl"],d);return false};$Comments.OnPostClick=function(a){$Comments.DirtyEvent.fire();var c="c_"+a;function b(){var e=_ge("cc2_ta_"+a);if(e.Dirty==null)return true;var b=e.value;b=b.replace(/^\s+|\s+$/g,"");if(b==""){_ge("cc2_adderr_"+a).style.display="block";_ge("cc2_adderr_errimg_"+a).innerHTML="<img src='"+$Cmt["errorimgurl"]+"' />";_ge("cc2_adderrtext_"+a).innerHTML=$Cmt["emptyerrtext"]}else if(b.length>$Cmt["maxcommentlength"]){_ge("cc2_adderr_"+a).style.display="block";_ge("cc2_adderr_errimg_"+a).innerHTML="<img src='"+$Cmt["errorimgurl"]+"' />";_ge("cc2_adderrtext_"+a).innerHTML=$Cmt["longerrtext"]}else{_ge("cc2_adderr_"+a).style.display="none";var g=$Comments.PreProcessRequest("a",a,b),f=$Cmt[c],d={};if(f.ans)d["Target"]=f.ans;$Do.when("$wn.RecordComment",this,d);$Comments.SendRequest(g)}}if($Cmt["hipCCid"]!=null&&$Cmt["hipCCid"]==c)if(window.$HipV3){var d=$HipV3.Get("CommentHip");d.validate(b)}else{_ge("cc2_adderr_"+a).style.display="block";_ge("cc2_adderr_errimg_"+a).innerHTML="<img src='"+$Cmt["errorimgurl"]+"' />";_ge("cc2_adderrtext_"+a).innerHTML=$Cmt["adderrtext"]}else b();return false};$Comments.PreProcessRequest=function(i,d,g,k){var m="c_"+d,a=$Cmt[m],b={};b["id"]=d;b["isExt"]=a.isExt;if(a.cctype=="f")b["type"]="f";else if(a.cctype=="i")b["type"]="i";if(i=="v"){b["url"]=$Cmt["churl"]+$Cmt["hdlrvm"];b["method"]="GET";b["action"]="v";if(b["isExt"]!=true)b["loadBox"]=_ge("cc2_ldfl_"+d);if(b["type"]=="f"&&a.moreComments==true){if(a.deletionHappened)if(_ge("cc2_cmt_"+a.anchor)==null){a.anchor=a.fbanchor;a.fbanchor=null}b["viewAnchor"]=_ge("cc2_vmlnkfl_"+d);b["viewContainer"]=_ge("cc2_vmmainfl_"+d);b["vars"]="sparent="+a.sparentid+"&order=a&psp="+a.isPhoto+"&dir=p&cnt="+$Cmt["maxflcomments"]+"&lanchor="+a.anchor+"&ict="+$ic.ic.getICNamespaceCount("cmtc")+"&cmtid="+d+"&cid="+b["id"]+"&na="+a.notfApp+"&nct="+a.notfCt+"&bat="+a.biciAcType+"&attic="+a.attic+"&r="+Math.floor(Math.random()*1e4)}else if(b["type"]=="i")if(b["isExt"]==true){var f="";if(a.isExt)f="&ans="+a.ans+"&exccid="+a.exccid;_ge("cc2_rflnk_"+b["id"]).style.display="none";var n=_ge("cc2_noup_"+b["id"]);n.innerHTML='<img src="'+$Cmt["spinnerImgUrl"]+'" />'+"&nbsp;<span style='color:#000'>"+$Cmt["loading"]+"</span>";n.style.display="inline";b["vars"]="sparent="+a.sparentid+"&rev=true&ctype=i&ict="+$ic.ic.getICNamespaceCount("cmtc")+"&cmtid="+d+"&cid="+b["id"]+"&na="+a.notfApp+"&appname="+a.appname+f+"&nct="+a.notfCt+"&bat="+a.biciAcType+"&isExt=true&aid="+a.aparentid+"&r="+Math.floor(Math.random()*1e4)}else{b["viewAnchor"]=_ge("cc2_vmlnkinl_"+d);b["viewContainer"]=_ge("cc2_vmmaininl_"+d);b["vars"]="sparent="+a.sparentid+"&order=d&psp=false&dir=n&cnt="+a.maxfetchcnt+"&rev=true&lanchor=&ctype=i&ict="+$ic.ic.getICNamespaceCount("cmtc")+"&cmtid="+d+"&cid="+b["id"]+"&na="+a.notfApp+"&nct="+a.notfCt+"&bat="+a.biciAcType+"&isExt=false"+"&attic="+a.attic+"&fcmtid="+a.firstid+"&lcmtid="+a.lastid+ +"&r="+Math.floor(Math.random()*1e4)}if(b["isExt"]!=true){b["viewAnchor"].style.display="none";b["viewContainer"].style.display="none";b["loadBox"].style.display="block"}}else if(i=="a"){if(!window.$HipV3)$Network.fetchScript($Cmt["aurl"],function(){});b["url"]=$Cmt["churl"]+$Cmt["hdlrad"];b["addBox"]=_ge("cc2_ta_"+d);b["postButton"]=_ge("cc2_pbtn_"+d);b["addBox"].disabled=true;b["postButton"].disabled=true;var e=null;if(window.$HipV3){var l=$HipV3.Get("CommentHip");if($Cmt["hipCCid"]!=null&&$Cmt["hipCCid"]==m)e=$HipV3.Get("CommentHip").getSolutionDetails();$Cmt["hipCCid"]=null;if(l)try{l.dispose()}catch(o){}}var h=_ge("cmtDisposeDiv");if(h)h.parentNode.parentNode.removeChild(h.parentNode);try{_ge($Cmt["amcp"]+d).innerHTML='<span class="cc2_addngext"><img src="'+$Cmt["spinnerImgUrl"]+'" />'+"&nbsp;"+$Cmt["addMsg"]+"</span>"}catch(o){}if(a.isExt==null)a.isExt=false;var j=null;if(e!=null)j="&hip="+c(e.userSol)+"&hipch="+c(e.challenge)+"&hipfid="+c(e.flowId)+"&hipfh="+c(e.flowIdHash);var f="";if(a.isExt)f="&ans="+c(a.ans)+"&exccid="+c(a.exccid)+"&appname="+c(a.appname);b["vars"]="sparentid="+c(a.sparentid)+"&aparentid="+c(a.aparentid)+"&content="+c(g)+"&fname="+c($Cmt["fname"])+"&lname="+c($Cmt["lname"])+"&purl="+c($Cmt["ppic"])+"&aocid="+c(a.aocid)+"&isGrp="+c(a.isgrp)+"&type="+c(a.ptype)+"&ctype="+a.ctype+"&ccid="+c(a.sparentid)+"&ctrlid="+c(b["id"])+"&na="+c(a.notfApp)+"&nct="+c(a.notfCt)+"&bat="+c(a.biciAcType)+(a.notRecipients!=null?"&nrs="+c(a.notRecipients):"")+(a.cmtPageUrl!=null?"&cmtPageUrl="+c(a.cmtPageUrl):"")+"&hash="+c(a.hash)+"&ict="+c($ic.ic.getICNamespaceCount("cmtc").toString())+"&canary="+c($Cmt["canary"])+"&audiourl="+c($Cmt["audiourl"])+"&attic="+c(a.attic)+(e!=null?j:"")+(b["type"]=="f"?"&selfpage=true":"&selfpage=false")+"&isExt="+c(a.isExt.toString())+f;b["method"]="POST";b["action"]="a"}else if(i=="d"){b["url"]=$Cmt["churl"]+$Cmt["hdlrdl"];b["vars"]="commentid="+c(g)+"&activityid="+c(a.aparentid)+"&canary="+c($Cmt["canary"])+"&na="+c(a.notfApp)+"&nct="+c(a.notfCt)+"&bat="+c(a.biciAcType)+"&abuse="+c(k.abuse?"true":"false")+"&creatorCid="+c(k.creator);b["method"]="POST";b["commentid"]=g;b["deleteContainer"]=_ge("cc2_dlmain_"+g);b["deleteContainerHtml"]=b["deleteContainer"].innerHTML;b["deleteContainer"].innerHTML=$Cmt["dltmsg"];try{_ge("cc2_dlterr_"+b["commentid"]).style.display="none"}catch(o){}b["action"]="d"}function c(a){if(a)return a.encodeURIComponent();else return ""}return b};$Comments.SendRequest=function(a){if(a["method"]=="GET")$Network.fetchXML(a["url"]+"?"+a["vars"],b,"GET");else{var c={};c["Content-Type"]="application/x-www-form-urlencoded";$Network.fetchXML(a["url"],b,"POST",a["vars"],c)}function b(f){if($Cmt==null||$Cmt["c_"+a["id"]]==null)return;var r=!f||f.status!=200?true:false;if(r){if(a["action"]=="v")if(a["isExt"]==true){$Cmt["c_"+a["id"]].extViewError=true;if(f.responseText!=null&&f.responseText.indexOf("thirdpartyerror")>=0){var b=document.createElement("div"),p=_ge("cc2_noup_"+a["id"]);p.innerHTML="";p.appendChild(b);$Utility.ajaxInnerHtml(b,f.responseText);var l=_ge("c_"+a["id"]+"_exAdd");if(l)l.parentNode.removeChild(l)}else{_ge("cc2_noup_"+a["id"]).innerHTML="<img src='"+$Cmt["errorimgurl"]+"' />"+"&nbsp;<span class='errorText'>"+$Cmt["lderr"]+"</span>";var i=_ge("cc2_adderr_"+a["id"]);if(i)i.style.display="none"}}else{_ge("cc2_lderr_"+a["id"]).style.display="block";_ge("cc2_lderr_errimg_"+a["id"]).innerHTML="<img src='"+$Cmt["errorimgurl"]+"' />";a["loadBox"].style.display="none"}else if(a["action"]=="d"){var o=_ge("cc2_dlterr_"+a["commentid"]);o.innerHTML=$Cmt.dltnotif;o.style.display="block";a["deleteContainer"].innerHTML=a["deleteContainerHtml"]}else if(a["action"]=="a"){try{_ge($Cmt["amcp"]+a["id"]).innerHTML="";if(a["isExt"]==true&&$Cmt["c_"+a["id"]].extViewError==true){var q=_ge("cc2_noup_"+a["id"]);q.parentNode.style.display="none"}}catch(s){}var i=_ge("cc2_adderr_"+a["id"]);i.style.display="block";_ge("cc2_adderr_errimg_"+a["id"]).innerHTML="<img src='"+$Cmt["errorimgurl"]+"' />";_ge("cc2_adderrtext_"+a["id"]).innerHTML=$Cmt["adderrtext"];a["addBox"].disabled=false;a["postButton"].disabled=false}}else{if(a["action"]=="v"){var c=_ge(a["id"]+"_viewajax");if(c){if(a["isExt"]==true)c.innerHTML="";c.style.display="block";var b=document.createElement("div"),m=false;if(a["type"]=="f"){var n=$Cmt["c_"+a["id"]].lastajaxchild;if(n==null){$Cmt["c_"+a["id"]].lastajaxchild=b;c.appendChild(b)}else{c.insertBefore(b,n);$Cmt["c_"+a["id"]].lastajaxchild=b}}else{c.appendChild(b);if(a["isExt"]!=true){var h=$Cmt["c_"+a["id"]],j=_ge("cc2_cmt_"+h.lastid);if(j)j.parentNode.removeChild(j);var k=_ge(a["id"]+"_addajax");if(k){k.innerHTML="";k.style.display="none"}$Utility.ajaxInnerHtml(b,f.responseText);m=true}}if(!m)$Utility.ajaxInnerHtml(b,f.responseText)}}else if(a["action"]=="a"){try{_ge($Cmt["amcp"]+a["id"]).innerHTML="";if(a["type"]=="f"){var e=_ge("cc2_ccc_"+a["id"]);if(e!=null){var d=e.innerHTML,g=null;if(d!=null&&d!=""){g=parseInt(d.substring(1,d.length-1))+1;e.innerHTML="("+g+")"}else e.innerHTML="(1)"}}}catch(s){}var c;if(a["isExt"]==true){c=_ge(a["id"]+"_viewajax");if($Cmt["c_"+a["id"]].extViewError==true){var q=_ge("cc2_noup_"+a["id"]);q.parentNode.style.display="none"}}else c=_ge(a["id"]+"_addajax");if(c){c.style.display="block";var b=document.createElement("div");b.ajaxAddParent=true;c.appendChild(b);$Utility.ajaxInnerHtml(b,f.responseText)}}else if(a["action"]=="d"){try{if(a["type"]=="f"){var e=_ge("cc2_ccc_"+a["id"]);if(e!=null){var d=e.innerHTML,g=null;if(d!=null&&d!=""){g=parseInt(d.substring(1,d.length-1))-1;if(g<=0){e.innerHTML="";if(_ge("cc2_ta_"+a["id"])==null)_ge("cc2_main_full_"+a["id"]).style.display="none"}else e.innerHTML="("+g+")"}}}}catch(s){}$Cmt["c_"+a["id"]].deletionHappened=true;if(a["type"]=="i"){var h=$Cmt["c_"+a["id"]];if(h.lastid==a["commentid"])h.lastid="";else if(h.firstid==a["commentid"])h.firstid=""}}$Comments.PostProcess(a)}}};$Comments.PostProcess=function(a){var c=$Cmt["c_"+a["id"]];if(a["action"]=="v")if(a["isExt"]!=true){a["viewContainer"].style.display="block";if(c.moreComments==false&&a["type"]=="f"||a["type"]=="i"&&!c.showViewAll)a["viewAnchor"].parentNode.style.display="none";else if(a["type"]=="i"&&c.showViewAll)_ge("cc2_valnkinl_"+a["id"]).style.display="inline";else if(c.moreComments==true&&a["type"]=="f")a["viewAnchor"].style.display="inline";a["loadBox"].style.display="none"}else{var d=_ge("cc2_noup_"+a["id"]);if(d)if(c.moreComments==true){_ge("cc2_vae_"+a["id"]).style.display="inline";d.style.display="none"}else if($Cmt["c_"+a["id"]].showNoMoreComments){d.innerHTML='<span class="cc2_nmco">'+$Cmt.nomorecmt+"</span>";var f=_ge(a["id"]+"_viewajax");f.innerHTML="";f.style.display="none"}else{d.parentNode.style.display="none";_ge(a["id"]+"_viewajax").style.marginTop="4px"}}else if(a["action"]=="a"){a["addBox"].disabled=false;a["postButton"].disabled=false;if($Cmt["disposeTextbox"]==true){a["addBox"].value="";$Comments.OnTextBoxBlur(a["addBox"])}}else if(a["action"]=="d"){c.deletionHappened=true;var b=_ge("cc2_cmt_"+a["commentid"]),e="c_"+a["id"]+"_"+a["commentid"];if($Cmt[e]&&$Cmt[e].ajaxAdd)if(b.parentNode.ajaxAddParent)b.parentNode.parentNode.removeChild(b.parentNode);else b.parentNode.removeChild(b);else b.parentNode.removeChild(b)}};$Comments.DirtyEvent=new $Event;$Comments.CommentAddSuccessfull=new $Event;var $HipV3=function(b){var a=this,c=null;a.uniqueId=b;a.hipLoaded=false;a.hipSolution="";a.hipChallenge="";a.submitCB=null;a.customTierUpgradeCallBack=null;a.ErrorEnum=function(){if(!c)c=new $Enum("None","ServerValidationError","IncompleteSolution","InvalidSolution","ServerErrorFailedThrottled");return c};a.getFrame=function(){if(HIP&&HIP.done)return HIP.isAudio?"audio":HIP.fr;return null};a.getFlowIdHash=function(){if(HIP)return _ge("WLX_HIP_FLHASH_"+b).value;return null};a.getSolutionDetails=function(){if(HIP&&HIP.done){var c={userSol:a.hipSolution,challenge:a.hipChallenge,frame:a.getFrame(),flowId:a.getFlowId(),flowIdHash:_ge("WLX_HIP_FLHASH_"+b).value};return c}return null};a.setTierCallBack=function(b){a.customTierUpgradeCallBack=b};a.clientValidate=function(a){if(HIP&&HIP.done){HIP.clientValidation();if(!!a)HIP.setError();return !(HIP.error&&HIP.error!=0)}return false};a.validate=function(c){var b=false;if(!c)return false;a.submitCB=c;if(HIP&&HIP.done){HIP.clientValidation();HIP.setError();b=!(HIP.error&&HIP.error!=0);if(b)HIP.verify(a.hipPostSubmit,null)}else a.showGeneralError();return b};a.hipPostSubmit=function(c,b){a.hipSolution=c;a.hipChallenge=b;a.setFormValues();a.submitCB()};a.RefreshHIP=function(){if(HIP&&HIP.done)HIP.reloadHIP()};a.setFormValues=function(){var c=a.getSolutionDetails();if(c){_ge("WLX_HIP_SOL_"+b).value=c.userSol?c.userSol:"";_ge("WLX_HIP_CHLG_"+b).value=c.challenge?c.challenge:"";_ge("WLX_HIP_FLID_"+b).value=c.flowId?c.flowId:"";_ge("WLX_HIP_FRAME_"+b).value=c.frame?c.frame:"";_ge("WLX_HIP_FLHASH_"+b).value=c.flowIdHash?c.flowIdHash:""}};a.showGeneralError=function(){var b=$AleHipStrings["generalErr"],a=_ge("WLX_HIP_ERR_NOTIF");if(a&&b){a.innerHTML=b.encodeHtml();a.style.display=""}};a.getFlowId=function(){var a=_ge("WLX_HIP_FLID_"+b);if(a)return a.value;return null};a.setError=function(d){if(HIP&&d){var b=0,c=a.ErrorEnum();switch(d){case c.ServerValidationError:b=1;break;case c.IncompleteSolution:b=2;break;case c.InvalidSolution:b=3;break;case c.ServerErrorFailedThrottled:b=4;break;default:b=0}HIP.error=b;HIP.setError()}else a.showGeneralError()};a.dispose=function(b){c=null;a.uniqueId=null;a.hipLoaded=null;a.hipSolution=null;a.hipChallenge=null;a.submitCB=null;if(undefined!=HIP&&!!HIP)HIP=null;if(!!b)b()};a.tierUpgrade=function(c){if(HIP&&HIP.done)$HIP.RemoveHIPElement(b);if(a.customTierUpgradeCallBack)c=a.customTierUpgradeCallBack;a.dispose(c);return true};a.getErrorString=function(){return HIP?HIP.getError():""};a.getErrorMessage=function(b,d){a.setError(b);var c=a.getErrorString();if(HIP&&!!!d)HIP.error=0;return c}};$HipV3.Get=function(a){if(!$HipV3._global||$HipV3._global.uniqueId!=a)$HipV3._global=new $HipV3(a);return $HipV3._global};function registerNamespace(){for(var d=0;d<arguments.length;d++){var c=window,b=arguments[d].split(".");for(var a=0;a<b.length;a++){if(!c[b[a]])c[b[a]]={};c=c[b[a]]}}}registerNamespace("Spaces");Spaces.Cookie={_strDomain:"."+document.domain.split(".").slice(-3).join("."),WriteCookie:function(f,c,b,d,g,e){var a=f;if(c)a+="="+escape(c);if(b)a+=";expires="+b;a+=";domain="+(d||Spaces.Cookie._strDomain);a+=";path="+(g||"/");if(e)a+=";secure";document.cookie=a},ReadCookie:function(c){var b=document.cookie.split(";");for(var a=0;a<b.length;a++){b[a]=b[a].replace(/^\s+|\s+$/g,"");if(0==b[a].indexOf(c+"="))return unescape(b[a].substr(c.length+1))}return null}};Spaces.IsRTL=function(){if(!document.body){if("undefined"!=typeof $Debug&&$Debug.ASSERT);return false}var a="rtl"==(document.body.currentStyle?document.body.currentStyle.direction:document.defaultView.getComputedStyle(document.body,"").direction);Spaces.IsRTL=function(){return a};return a};Spaces.WriteWmpObject=function(){document.write('<object width="100%" classid="clsid:6BF52A52-394A-11D3-B153-00C04F79FAA6" id="PTMediaPlayer">')};Spaces.attachElementBindingSync=function(f,c,e,d,b){var h=Object,g=h.resolve(c),a=new g(f,d,b);a.initialize(e);return a};PathUtility=new function(){this.MapPathType={};this.MapPathType.Image="image";this.MapPathType.Css="css";this.MapPathType.Script="script";this.MapPathType.XML="xml";this.MapPathServerType={};this.MapPathServerType.SpacesWeb="SpacesWeb";this.MapPath=function(d,f,c,e){var b=null;if(e!=null)b=e.toLowerCase();var a;switch(d.toString()){case this.MapPathType.Image.toString():a=C_STATIC_IMAGES_URL;break;default:a=C_STATIC_CONTENT_URL}switch(f.toString()){case this.MapPathServerType.SpacesWeb.toString():a+="Web";break;default:alert("Unexpected MapPathServerType")}if(c!=null){if(c!=""||c[0]!="/")a+="/";a+=c}if(a[a.length-1]!="/")a+="/";switch(d.toString()){case this.MapPathType.Image.toString():a+="images";if(Spaces.IsRTL())a+="/rtl";break;case this.MapPathType.Css.toString():a+="css";break;case this.MapPathType.Script.toString():a+="script";break;case this.MapPathType.XML.toString():a+="xml"}if(b==null||b.length==0||b[0]!="/")a+="/";if(b!=null)a+=b;return a};this.GetFetchUrlService=function(c,b){var a=C_FETCH_URL_SERVICE.format(b,c.encodeUrl());if($Request.extractHost(C_FETCH_URL_SERVICE).indexOf(document.location.host)==0)return a+"&nocache="+Math.random();else return this.GetProxyUrlService(a)+"&nocache="+Math.random()};this.GetProxyUrlService=function(a){return $Request.extractHost(document.location.href,true)+"/pr.aspx?url="+a.encodeUrl()}};var _de=document.documentElement,_deScr=$B.RE_WebKit?document.body:document.documentElement;window.Function.KillEvent=function(){event.cancelBubble=true;event.returnValue=false;return false};registerNamespace("$UI");$UI.Dialog=function(p,e,y,l){var s=document.body.className.indexOf("rtl")>-1,d,m,c=this,f=new $Memory.Groups,a=null,g=null,i=null,k=null,r=document.body,h,n,A,t,j=null,b;this.dock=new $UI.Dialog.Rect(0,0,0,0);if(e&&e<5)e=5;l=l?" "+l:"";function o(){if(d){var b=d.style,a=$B.IE&&$B.V==7?m.offsetLeft/100:1;if(a==0)a=1;if($B.IE&&$B.V==6){b.width=_deScr.scrollWidth-3+"px";b.pixelTop=Math.max(0,_deScr.scrollTop/a)}b.pixelHeight=_de.clientHeight/a}}function q(){var b;if(null!=window["event"]&&event.srcElement==h)b=$UI.Dialog.findFocusableElement(a,n,false);else b=$UI.Dialog.findFocusableElement(a,h,true);if(b)setTimeout(function(){try{b.focus()}catch(a){}},0)}this.dispose=function(){if(j){clearTimeout(j);j=null}if(f){f.dispose();f=null}b=null;d=null;m=null;h=null;n=null};this.setContents=function(m){f.create(null).dispose();var b=f.create(null);a=m;var j=a.parentNode;if(null==j||null==j.tagName){r.appendChild(a);b.Nodes.register(a)}var e={href:"#"},c={position:"absolute"},d=$B.RE_WebKit?"input":"a";n=b.Nodes.create(d,e,c,a);h=b.Nodes.create(d,e,c);if($B.RE_WebKit)if(s)n.style.right=h.style.right="10000px";else n.style.left=h.style.left="-10000px";a.insertAdjacentElement("afterBegin",h);b.Events.register(n,{onfocus:q});b.Events.register(h,{onfocus:q});a.style.position="absolute";a.className+=l;if(!p&&$B.IE&&$B.V<7){g=new $UI.FramePopup;b.Properties.register(g);k=new $UI.FramePopup;b.Properties.register(k)}i=b.Nodes.create("div",{},c,a.parentElement);i.className="UI_Dialog_Shadow"+l;x();return a};this.recalc=function(k){if(!a)return;if(j){clearTimeout(j);j=null}o();var d=a.style;if(!y){var b=$UI.Dialog.getLocation(a);if(!b||b.isEmpty()){var i={visibility:a.currentStyle.visibility||d.visibility||"visible",display:a.currentStyle.display||d.display||"auto"};d.visibility="hidden";d.display="block";b=$UI.Dialog.getLocation(a);d.display=i.display;d.visibility=i.visibility}if(!c.dock)c.dock=new $UI.Dialog.Rect(0,0,0,0);var h=_de.clientWidth/2-b.width/2;if(s){c.dock.x=Math.min(h,0-(b.width-_de.clientWidth)-25);if($B.RE_WebKit)c.dock.x+=_deScr.scrollWidth-_de.clientWidth}else c.dock.x=Math.max(h,25);if(k){var f=_de.clientHeight-b.height-3;c.dock.y=_deScr.scrollTop+Math.min(Math.max(f>200?f:(_de.clientHeight-b.height)/2,0),100)}c.dock.height=b.height;c.dock.width=b.width}d.pixelTop=c.dock.y;d.pixelLeft=c.dock.x;if(g)g.positionAt(c.dock,e?1e3:e-2);w(true)};function w(m){var h=$UI.Dialog.getLocation(a),f=h.height,l=h.width;if(f!=t||m){var b=new $UI.Dialog.Rect,d=i.style;d.width=(b.width=l)+"px";d.height=(b.height=f)+"px";d.left=(b.x=c.dock.x+(s?-3:3))+"px";d.top=(b.y=c.dock.y+3)+"px";if(g)k.positionAt(b,e?1e3:e-2);t=f}j=setTimeout(w,25)}this.show=function(h,j){i.style.backgroundColor="#000";z(i,30);c.recalc(true);a.style.display="block";if(e){i.style.zIndex=e-1;a.style.zIndex=e}if(p){var g=f.create("show");d=_ce("div");u();m=_ce("div");m.className="UI_Dialog_ZoomTest"+l;d.className=d.id="UI_Dialog_BG";d.className+=l;if(e)d.style.zIndex=e-1;r.appendChild(d);r.appendChild(m);var b=Function.KillEvent;g.Events.register(d,{onfocus:q,onclick:b,onmousedown:b,onkeydown:b,onkeypress:b,ondblclick:b});g.Events.register(window,{onresize:function(){setTimeout(o,0)},onfocus:b});g.Nodes.register(d);g.Nodes.register(m);o()}function k(){try{(h?h:$UI.Dialog.findFocusableElement(a)).focus()}catch(b){}}if(!j)setTimeout(k,10)};this.hide=function(){f.create("show").dispose();f.create("ext").dispose();if($B.IE&&$B.V<7)if(b){for(var a=0;a<b.length;a++)if(typeof b[a].wlppHide!="undefined")b[a].style.visibility=b[a].wlppHide;b=null}};this.minimize=function(){i.style.display="none";if(g)g.minimize();if(k)k.minimize();a.style.visibility="hidden";if(p){d.style.display="none";if(b)for(var c=0;c<b.length;c++)b[c].style.visibility=b[c].wlppHide;o()}};this.restore=function(){i.style.display="block";a.style.visibility="visible";if(g)g.restore();if(k)k.restore();c.recalc(true);if(p){d.style.display="block";u();o()}};function z(b,a){var c="undefined"==typeof b.style.filter?"opacity":"filter";b.style[c]=c=="filter"?"alpha(opacity="+a+")":.01*a}function x(){f.create("ext").Events.register(window,{onresize:v,onscroll:v})}function v(){f.create("ext").dispose();c.recalc(false);x()}function u(){if($B.IE&&$B.V<7){b=document.getElementsByTagName("select");var e=a.getElementsByTagName("select");for(var c=0;c<b.length;c++){var f=false;for(var d=0;d<e.length;d++)if(b[c]==e[d]){f=true;break}if(!f){b[c].wlppHide=b[c].style.visibility;b[c].style.visibility="hidden"}}}}};$UI.Dialog.Rect=function(c,d,b,a){return new function(){var e=this;this.x=c;this.y=d;this.width=b;this.height=a;this.isEmpty=function(){return e.width<=0||e.height<=0}}};$UI.Dialog.findFocusableElement=function(b,a,c){function g(a){function c(a){while(a&&a.currentStyle&&a.currentStyle.display!="none"&&a.currentStyle.visibility!="hidden")a=a.parentNode;if(!a||!a.currentStyle)return true;return false}var b="BUTTON|TEXTAREA|FIELDSET|IFRAME|SELECT|";return a.tagName&&!a.disabled&&(b.indexOf(a.tagName+"|")>-1||a.tagName=="A"&&a.href||a.tagName=="INPUT"&&a.type.toLowerCase()!="hidden"&&(!$B.Firefox||a.type.toLowerCase()!="file"))&&c(a)}function d(b){if(!b)return null;var a=c?b.nextSibling:b.previousSibling;while(a&&a.nodeType!=1)a=c?a.nextSibling:a.previousSibling;if(!a)return d(b.parentNode);else return a}function f(b,e){var a=e;if(a&&b.contains(a))while(a!=null)if(!g(a))if(c&&a.firstChild)a=a.firstChild;else if(!c&&a.lastChild)a=a.lastChild;else a=d(a);else return a;return null}if(a)a=d(a);else a=b;var e=f(b,a);if(!e&&a&&a!=b)return f(b,b);else return e};$UI.Dialog.getLocation=function(b){if(!b)return new $UI.Dialog.Rect(0,0,0,0);var c=0,d=0,a=b;while(a){c+=a.offsetLeft;d+=a.offsetTop;a=a.offsetParent}return new $UI.Dialog.Rect(c,d,b.offsetWidth,b.offsetHeight)};$UI.Popover=function(){this.header=null;this.body=null;this.footerText=null;this.width=300;this.bodyPadding=true;this.showHeader=true;this.showFooter=true;this.modal=false;this.zIndex=null;this.addButton=function(e,c,a,b){d.push({name:e,value:c,isDefault:a,isCancel:b})};this.show=function(w,u,s,t){if(e)return;p=w;o=u;if(!a){a=new $UI.Dialog(b.modal,b.zIndex);c=_ce("div");c.style.display="none";c.innerHTML="<div><h3></h3></div><div></div><div><nobr></nobr></div>";a.setContents(c);q();c.className="UI_Popover";var r=c.childNodes;h=r[1];i=r[2];g=r[3];n=h.firstChild;k=g.firstChild;h.className=" Header";i.className=" Body";g.className=" Footer";var m=b.width;c.style.width=parseInt(m,10)==m?m+"px":m;j=null;f=[];for(var l=0;l<d.length;l++)v(d[l].name,d[l].value,d[l].isDefault,d[l].isCancel);if(d.length==0)b.showFooter=false;x()}a.show(s?f[s]:null,t);e=true};this.hide=function(){if(!e)return;if(o)setTimeout(w,10);try{l.dispose();m.dispose();a.hide();a.dispose()}catch(b){}e=false;c=h=g=i=n=k=f=null};this.enableButton=function(a){f[a].disabled=false};this.disableButton=function(a){f[a].disabled=true};function w(){try{o.focus()}catch(a){}}function q(){l.Events.register(b.modal?$B.IE?document.body:window:c,$B.RE_WebKit?{onkeydown:t}:{onkeypress:t})}function u(){l.Events.dispose()}function v(b,g,c,e){k.appendChild(document.createTextNode(" "));var d=_ce("div");d.innerHTML='<button id="popover_btn_{0}" type="{1}" />'.format(b,c?"submit":"button");var a=d.firstChild;m.Nodes.register(a);if(c)a.className+="Default";else if(e)j=b;f[b]=a;a.innerHTML="<nobr>"+g+"</nobr>";m.Events.register(a,{onclick:function(a){r(b);a.returnValue=false}});k.appendChild(a)}function t(a){switch(($B.RE_WebKit?a:event).keyCode){case 27:r(j?j:"$cancel")}}function r(c){var a=true;if(p)a=p(b,c);if(a)b.hide();event.returnValue=false}function x(){function a(a,b){if(a)if(typeof a=="string")b.innerHTML=a;else{b.innerHTML="";b.appendChild(a)}}h.style.display=b.showHeader?"block":"none";g.style.display=b.showFooter?"block":"none";if(!b.bodyPadding)i.style.padding="0";a(b.header,n);a(b.body,i)}this.recalc=function(){if(!e)return;if(a)a.recalc(false)};this.minimize=function(){if(!a||!e)return;a.minimize();u()};this.restore=function(){if(!a||!e)return;a.restore();q()};var e=false,a,b=this,h,i,g,n,k,j,s=new $Memory.Groups,m=s.create("show"),l=s.create("showHide"),f,c,d=[],p=null,o=null};$UI.MsgBoxEx=function(p,l,i,f,q,g,h,j,n){var e="ok",b="cancel",a=new $UI.Popover,k=_ce("div"),o=function(f,d){var c=true;if(d==e){if(q({Popover:f})==false)c=false}else if(d==b&&!!g)g();if(c)a=null;return c};if(h){var c=temp=h;for(var m=0;m<10&&temp;m++){var d=temp.tagName.toLowerCase();if(d=="a"||d=="button"||d=="input"){c=temp;break}temp=temp.parentElement;if(!temp){c=null;break}}}if(l)k.innerHTML='<div style="margin-bottom:10px">'+l+"</div>";a.width=j?j:"416px";a.header=p;a.body=k;a.modal=true;if(i!=false)a.addButton(e,i,true,false);if(f!=false)a.addButton(b,f,false,true);a.show(o,c,n?b:null)};$UI.MsgBox=function(d,e,c,a,b,f){$UI.MsgBoxEx(d,e,c,a,f,null,b,null,false)};registerNamespace("$SA");SA_stat={p:false,tid:null,rc:false,b:false,skyID:null,skyPoll:0,d:true};SA_Code={Success:0,GeneralError:1,Banned:2};new function(){var a=$SA,b=true,n=false,u,g,h,C=true,o=false,q,z=false,y=false,Y="",r=false,c=null,k=0,f=[],m=false,p="";a._strTableCell=$B.IE?"block":"table-cell";var D=true,d,X=true,E=/(^|\s)(http:\/\/|https:\/\/|www\.)\S+(\s|$)/,v="SAInput",s="";a.dispose=function(){if(b)return;g.dispose();u.dispose();g=null;u=null;n=false;b=true;SA_stat.d=true};a.initialize=function(){h=false;b=false;SA_stat.d=false;u=new $Memory.Events;g=new $Memory.Events;q="";k=0;c=null;f=[];m=false;o=false;_lastPsmValue="";u.register(window,{onunload:a.dispose});if(window.$SAConfig){d=$SAConfig.pt;if($SAConfig._BadgeModel){SA_stat.tid="SAUrl";o=true;h=true;g.dispose();var l=document.activeElement,i=$("SAUrlSummary");if(l!=$("SAInput"))H();if(l!=i)a.UrlTADeactivate(i);if(!$SAConfig._BadgePreview)setTimeout($SA.LoadUrlPreview,0);if($SAConfig._IsVideo)d="VideoEmbed";if($SAConfig._BadgePsm!="")setTimeout("$SA.initTextBox('SAInput')",0);if($SAConfig._BadgePreview){setTimeout("$SA.initTextBox('SAUrlTitle')",0);setTimeout("$SA.initTextBox('SAUrlSummary')",0);if($SAConfig._BadgeThumbnail){c={images:[]};c.images.push($SAConfig._BadgeThumbnail);c.images.push("");var e=0;while(e<c.images.length){f[e]=true;e++}j(c.images.length,true)}else{t();a.DisablePaging()}}}}};a.initTextBox=function(a){if(b)return;$SA._focusedTextAreaId=a;$SA.recalc()};a.active=function(e){if(b||$SAConfig._BadgeHasShared)return false;var c=!h&&a.activeRO(e);if(c){if(D){var d=_ge("SAContext");if(d)_ge("SACtrl").appendChild(d.removeChild(_ge("SAActive")));D=false}a.focusInput(e);g.register(document,{onclick:G});W();h=true}return c};function G(){if(b)return;if(!SA_stat.p&&!SA_stat.tid){var f=_ge("SAInput");if(w(f)){var e=20,c=event.srcElement,d=0;while(c&&c.id!="SAActive"&&c.id!="SAInactive"&&d<e){c=c.parentElement;d++}if(!c||d>=e)a.inactive()}}}a.inactive=function(){if(SA_stat.p||!h||b)return;r=false;_lastPsmValue="";p="";a.remove();a.showErr(SA_Code.Success);_ge("SAActive").style.display="none";_ge("SAInactive").style.display="block";v="SAInput";g.dispose();setTimeout(SA_Inactive2,0);h=false};a.rich=function(f,e){if(SA_stat.p||b)return false;c=null;SA_stat.rc=true;var h=_ge("SAInput");if(w(h))h.value=$SAConfig.strRichHint;SA_stat.rc=false;g.dispose();a.showErr(SA_Code.Success);_ge(f).style.display="block";_ge("SASimple").style.display="none";d=e;SA_stat.tid=f;_ge("SAMenu").style.display="none";_ge("SARC").style.display=$SA._strTableCell;if(e=="Url")a.ShowUrl();else if(e=="Photo")SAShowPhoto();else if(e=="Document")SAShowDoc();if(event)event.returnValue=false;return false};a.remove=function(){o=false;k=0;f=[];m=false;p="";if(SA_stat.p||!SA_stat.tid||b)return false;a.showErr(SA_Code.Success);SA_stat.rc=true;var h=_ge("SAInput");if(w(h))h.value="";SA_stat.rc=false;g.register(document,{onclick:G});var c=d;_ge(SA_stat.tid).style.display="none";_ge("SASimple").style.display="block";d="Simple";SA_stat.tid=null;var e=_ge("SARC");if(e)e.style.display="none";var i=_ge("SAMenu");if(i)_ge("SAMenu").style.display=$SA._strTableCell;if(c=="Photo")SAClearPhoto();else if(c=="Document")SAClearDoc();else if(c=="Url"){t();F();_ge("SALoading2").style.display="none"}v="SAInput";a.focusInput(true);return false};a.recalc=function(){if(!h||b)return;SA_stat.rc=true;var a=_ge($SA._focusedTextAreaId);if($SA._focusedTextAreaId=="SAInput")A(a);var d=a.getAttribute("maxlength"),c=false;if(a.value.length>d){a.value=a.value.substring(0,d);if($B.IE){setTimeout($SA.recalc,0);c=true}}if(!c){a.rows=1;var e=2,f=550;if(a.clientHeight<a.scrollHeight-e)while(a.clientHeight<a.scrollHeight-e&&a.rows<f)a.rows+=1}SA_stat.rc=false};a.blur=function(a){if(b)return;q="";if(a.id=="SAInput")setTimeout(H,200)};function B(){if(!SA_stat.tid)return $SAConfig.strTextHint;else return $SAConfig.strRichHint}function w(a){return a.value.length==0||a.value==B(a.id)}function H(){if(q=="SAInput"||b)return;SA_stat.b=true;var a=_ge("SAInput"),c=a.getAttribute("helper")!="help",d=!w(a);if(!c&&d)A(a);else if(c&&!d){a.className="SAInput SAHelp";a.value=B(a.id);a.setAttribute("helper","help")}SA_stat.b=false}function A(a){if(a.getAttribute("helper")=="help"){var b=a.value,c=B(a.id);a.className="SAInput SANormal";if(b.startsWith(c))a.value=b=b.substr(c.length);a.setAttribute("helper","normal")}}a.focus=function(c){if(b)return;q=c.id;a.trackFocus(c);if(q=="SAInput")A(c)};a.trackFocus=function(a){if(b)return;v=a.id};a.focusInput=function(g){if(SA_stat.p||b)return false;var e=false,f=true;if(!g&&event){var c=event.srcElement;while(c&&c.id!="SACtrl"){if(c.nodeName=="A"||c.nodeName=="INPUT"||c.nodeName=="TEXTAREA"){if(c.className=="SAPsaExtra"||c.className=="SAPsaIcon")e=!(SA_stat.p||n);if(c.id!="SAInactiveLink")f=false;while(c&&c.id!="SACtrl"){if(c.id=="SAErr"){e=!(SA_stat.p||n);break}c=c.parentElement}break}c=c.parentElement}}if(f)try{var d=_ge(v);if(d.id=="SAUrlTitle"||d.id=="SAUrlSummary")d=_ge("SAInput");d.focus();a.moveCursorToEnd(d)}catch(h){}return e};a.moveCursorToEnd=function(a){if(a.createTextRange){var c=a.createTextRange();c.move("character",a.value.length);c.select()}else if(a.setSelectionRange){var b=a.value.length;a.setSelectionRange(b,b)}};a.ShowUrl=function(){if(b)return;o=true;var c=$SAConfig.strRemLink.encodeHtml();_ge("SARem").innerHTML=c;_ge("SAUrlBox").style.display="block";a.blur(_ge("SAInput"));a.InitUrlForm(false);N();a.SetLoading(false);setTimeout("$SA.focus(_ge('SAUrlInput'))",0);setTimeout("_ge('SAUrlInput').select()",0)};function N(){if(b)return;var a=_ge("SABtn");a.disabled=false;a.innerHTML=$SAConfig.strPreview.encodeHtml();a.onclick=$SA.LoadUrlPreview}function R(){if(b)return;var a=_ge("SABtn");a.disabled=false;a.innerHTML=$SAConfig.strCancel.encodeHtml();a.onclick=$SA.UrlCancel}function F(){if(b)return;var a=_ge("SABtn");a.disabled=false;a.innerHTML=$SAConfig.strSave.encodeHtml();a.onclick=$SA.startPost}a.UrlCancel=function(){if(b)return;$SA.soxeCallback();a.SetLoading(false);a.ShowUrlPreview()};a.LoadUrlPreview=function(){if(b)return false;var d=_ge("SAUrlInput").value.trim();if(d=="")return false;R();a.SetLoading(true);var c=$SAConfig.SoxeURL;if(c.indexOf("?")==-1)c+="?url="+d.encodeURIComponent();c+="&canary="+$SAConfig.urlCan.encodeURIComponent();$Network.fetchScript(c,$SA.soxeCallback);n=true};a.soxeCallback=function(){n=false;if(!m&&!b&&o){m=true;var e=_ge("SAUrlInput").value.trim();c={title:e,description:$SAConfig.strSummaryHint,videoUrl:"",videoHeight:"",videoWidth:"",url:e};c.images=[];c.images.push("");var d=0;while(d<c.images.length){f[d]=true;d++}a.ShowUrlPreview()}};a.previewResult=function(e){n=false;if(!m&&!b&&o){m=true;if(!e.images)e.images=[];e.images.push("");if(!e.url)e.url=_ge("SAUrlInput").value.trim();if(!e.title)e.title=e.url;if(!e.description)e.description=$SAConfig.strSummaryHint;if(!e.videoUrl)e.videoUrl="";if(!e.videoHeight)e.videoHeight="";if(!e.videoWidth)e.videoWidth="";if(!e.embedParams)e.embedParams="";c=e;if(c.videoUrl)d="VideoEmbed";var g=0;while(g<c.images.length){f[g]=true;g++}a.ShowUrlPreview()}};a.ShowUrlPreview=function(){if(b)return;F();a.SetLoading(false);a.InitUrlForm(true);a.blur(_ge("SAInput"));_ge("SAUrlBox").style.display="none";if(c!=null){x();j(c.images.length,true);_ge("SAUrlTitle").value=c.title;_ge("SAUrlSummary").value=c.description;_ge("SAVideoSource").value=c.videoUrl;_ge("SAVideoHeight").value=c.videoHeight;_ge("SAVideoWidth").value=c.videoWidth;_ge("SAUrlInput").value=c.url;_ge("SAVideoParams").value=c.embedParams}else t();var f=_ge("SAUrlTitle"),e=_ge("SAUrlSummary"),d=_ge("SAPreviewColB").clientWidth;f.style.width=d-10+"px";e.style.width=d-10+"px";setTimeout(U,5);setTimeout("$SA.initTextBox('SAUrlTitle')",0);setTimeout("$SA.initTextBox('SAUrlSummary')",0);setTimeout(function(){try{_ge("SAInput").focus();$SA.focus(_ge("SAInput"));$SA.moveCursorToEnd(_ge("SAInput"))}catch(a){}},10)};function U(){if(p!==""){var c=p,b=_ge("SAInput").value;if(b.startsWith(c))_ge("SAInput").value=b.substr(c.length);a.initTextBox("SAInput");p=""}}a.SetLoading=function(a){if(b)return;_ge("SAUrlInput").disabled=a;_ge("SALoading2").style.display=a?$SA._strTableCell:"none";var c=_ge("SARC");if(c)c.style.display=a?"none":$SA._strTableCell;else _ge("SANoMenu").style.display=a?"none":$SA._strTableCell};a.InitUrlForm=function(a){if(b)return;if(!a){_ge("SAUrlInput").value="http://";_ge("SAUrlSummary").rows=1;_ge("SAUrlTitle").rows=1}else{var c=_ge("SAUrlInput").value.trim();_ge("SAUrlTitle").value=c;_ge("SAUrlSummary").value=$SAConfig.strSummaryHint}_ge("SAUrlInput").style.display=a?"none":"";_ge("SAPreview").style.display=a?"":"none"};a.UrlTAOver=function(a){if(b)return;a.className="SAUrlPreviewActive"};a.UrlTAOut=function(a){if(b)return;if(a.id=="SAUrlSummary"&&!y||a.id=="SAUrlTitle"&&!z)a.className="SAUrlPreviewInactive"};a.UrlTAActivate=function(a){if(b)return;$SA.focus(a);if(a.id=="SAUrlSummary"){y=true;var c=a.value,d=$SAConfig.strSummaryHint;if(c.startsWith(d))a.value=c=c.substr(d.length)}if(a.id=="SAUrlTitle")z=true;a.className="SAUrlPreviewActive"};a.UrlTADeactivate=function(a){if(b)return;$SA.blur(a);if(a.id=="SAUrlSummary"){y=false;if(a.value.trim()=="")a.value=$SAConfig.strSummaryHint}if(a.id=="SAUrlTitle")z=false;a.className="SAUrlPreviewInactive"};a.AutoDetectUrlOnPaste=function(){if(!r){$SA.AutoDetectUrl();if(r){var b=_ge("SAInput").value,a=_ge("SAUrlInput").value.trim();if(b.trim()==a)p=a}}};a.AutoDetectUrl=function(){if(SA_stat.p||d!="Simple"||b||!$SAConfig.urlEnabled)return;var a=_ge("SAInput").value,c=a.match(E);if(!r&&a.match(E)){$SA.rich("SAUrl","Url");_ge("SAUrlInput").value=c[0].trim();$SA.LoadUrlPreview();r=true}};a.DisablePaging=function(){_ge("SAThumbPagingOn").style.display="none";_ge("SAThumbPagingOff").style.display="block"};a.EnablePaging=function(){_ge("SAThumbPagingOn").style.display="block";_ge("SAThumbPagingOff").style.display="none"};function x(){_ge("SALoadingThumbDir").style.display="block";_ge("SANoThumbDir").style.display="none";_ge("SAThumbDir").style.display="none";a.EnablePaging()}function t(){_ge("SAUrlThumbnail").value="";_ge("SAThumbDir").style.display="none";_ge("SALoadingThumbDir").style.display="none";_ge("SANoThumbDir").style.display="block";if(L())a.EnablePaging();else a.DisablePaging()}function L(){for(i=0;i<f.length-1;i++)if(f[i]==true)return true;return false}function T(e){_ge("SAUrlThumbnail").value=e.originalSrc;var d=_ge("SAThumbImg");d.src=e.src;var b=e.width,c=e.height;if(b>=c){c=96*c/b;b=96}else{b=96*b/c;c=96}d.width=b;d.height=c;d.style.paddingLeft=(96-b)/2+"px";d.style.paddingRight=(96-b)/2+"px";_ge("SANoThumbDir").style.display="none";_ge("SALoadingThumbDir").style.display="none";_ge("SAThumbDir").style.display="block";a.EnablePaging()}function j(a,e){if(SA_stat.p||b||!h)return;if(e)a=P(a);else a=O(a);k=a;if(!f[a]){j(a,e);return}if(c.images[a]==""){t();return}else{var d=new Image,i=function(){$SA.ImageLoaded(a,e,d)},g=function(){$SA.ImageFailed(a,e)},l=function(){d.attachEvent("onload",i);d.attachEvent("onerror",g);d.originalSrc=c.images[a];d.src=$ssl.ensureSSLImageUrl(c.images[a])};setTimeout(l,0)}}a.ImageLoaded=function(a,d,c){if(b)return;if(a!=k)return;if(M(c))T(c);else{f[a]=false;j(a,d)}};a.ImageFailed=function(a,c){if(b)return;f[a]=false;if(a!=k)return;j(a,c)};a.prevThumb=function(){if(b)return;x();j(k,false)};a.nextThumb=function(){if(b)return;x();j(k,true)};function P(a){a++;if(a>=c.images.length)a=0;return a}function O(a){a--;if(a<0)a=c.images.length-1;return a}function M(a){if(a==null)return false;if(typeof a.naturalWidth!="undefined"&&a.naturalWidth==0)return false;if(a.width<64||a.height<64)return false;if(a.width>640||a.height>640)return false;return true}function W(){if(C&&!b){if($SAConfig._BadgeModel){C=false;return}var n=_ge("SA_3Table"),c=n.clientWidth;if(c<314)c=314;var d=_ge("SAPSA");if(d)d.style.width=d.clientWidth+"px";var i,g,a=0,f,h=0,m,k,p=_ge("SABtnActive"),o=_ge("SAShare");if(d)h=d.clientWidth;a=e(_ge("SAMenu"),a,false);a=e(_ge("SANoMenu"),a,false);a=e(o,a,true);var j=K();if(j>a)a=j;f=j;f=e(_ge("SALoading2"),f,true);m=_ge("SABtnActive").clientWidth;k=J();i=a+h+m;g=f+h+k;if(c<i)c=i;if(c<g)c=g;_ge("SAActiveWidth").style.width=c+16+"px";n.style.width="100%";if($B.IE_M6){l("SAInput",c-10-8+"px");l("SAUrlInput",c+"px")}else{l("SAInput","100%");l("SAUrlInput","100%")}if($B.IE){l("SAPhotoInput","100%");l("SADocInput","100%")}C=false}}function K(){var b=_ge("SARC"),a=0;if(!b)return a;b.style.display=$SA._strTableCell;var c=_ge("SARem");c.innerHTML=$SAConfig.strRemLink.encodeHtml();a=e(b,a,false);c.innerHTML=$SAConfig.strRemPhoto.encodeHtml();a=e(b,a,false);c.innerHTML=$SAConfig.strRemDoc.encodeHtml();a=e(b,a,false);b.style.display="none";return a}function J(){var c=_ge("SABtnActive"),a=0,b=_ge("SABtn"),d=b.innerHTML;a=e(c,a,false);b.innerHTML=$SAConfig.strSave.encodeHtml();a=e(c,a,false);b.innerHTML=$SAConfig.strCancel.encodeHtml();a=e(c,a,false);b.innerHTML=$SAConfig.strPreview.encodeHtml();a=e(c,a,false);b.innerHTML=d;return a}function e(a,b,c){var d=b;if(a){if(c)a.style.display=$SA._strTableCell;if(a.clientWidth>b)d=a.clientWidth;if(c)a.style.display="none"}return d}function l(c,b){var a=_ge(c);if(a)a.style.width=b}a.setPostState=function(a){if(SA_stat.d)return;_ge("SABtn").disabled=a;_ge("SAInput").disabled=a;if(d=="Photo")SAPhotoDisable(a);else if(d=="Document")SADocDisable(a);else if(d=="Url")SA_UrlDisable(a);var c,b;if(!SA_stat.tid){c=_ge("SAShare");b=_ge("SAMenu")}else{c=_ge("SAShare");b=_ge("SARC")}if(!b)b=_ge("SANoMenu");c.style.display=a?$SA._strTableCell:"none";b.style.display=a?"none":$SA._strTableCell};a.startPost=function(){if(SA_stat.p||SA_stat.d)return;S(d);if(_ge("SABtn").disabled)return;a.showErr(SA_Code.Success);if(d=="Photo")SAUploadImage("SAPhotoForm");else if(d=="Url")V();else if(d=="VideoEmbed")Q();else if(d==="Document")SAUploadImage("SADocForm");else $SA.post()};function S(a){if(SA_stat.d)return;if(a=="Photo")SAPhotoCheck();else if(a=="Document")SADocCheck();else if(!(a=="Url"||a=="VideoEmbed"))_ge("SABtn").disabled=false}function Q(){var a=_ge("SAUrlSummary").value.trim();if(a.startsWith($SAConfig.strSummaryHint))a=a.substr($SAConfig.strSummaryHint.length);var g=_ge("SAUrlTitle").value.trim(),b=_ge("SAUrlThumbnail").value.trim(),i=_ge("SAUrlInput").value.trim(),d=_ge("SAVideoHeight").value.trim(),h=_ge("SAVideoWidth").value.trim(),e=_ge("SAVideoParams").value.trim(),f=_ge("SAVideoSource").value.trim(),c="&up="+a.encodeURIComponent()+"&ut="+g.encodeURIComponent()+"&uth="+b.encodeURIComponent()+"&vh="+d.encodeURIComponent()+"&vw="+h.encodeURIComponent()+"&vp="+e.encodeURIComponent()+"&vs="+f.encodeURIComponent()+"&u="+i.encodeURIComponent();$SA.post(c)}function V(){var a=_ge("SAUrlSummary").value.trim();if(a.startsWith($SAConfig.strSummaryHint))a=a.substr($SAConfig.strSummaryHint.length);var d=_ge("SAUrlTitle").value.trim(),b=_ge("SAUrlThumbnail").value.trim(),e=_ge("SAUrlInput").value.trim(),c="&up="+a.encodeURIComponent()+"&ut="+d.encodeURIComponent()+"&uth="+b.encodeURIComponent()+"&u="+e.encodeURIComponent();$SA.post(c)}function I(c){var a;if(c.indexOf("?")==-1)a="?";else a="&";var b={};$BSI.addHandlerDPs(b);for(var d in b)a+=d+"="+b[d].encodeURIComponent()+"&";return c+a}a.post=function(b){if(SA_stat.d)return;var e=$SAConfig.SAHURL,c={};c["Content-Type"]="application/x-www-form-urlencoded";var f=SA_getPsm(),a="";if(b)a=b+"&";a=a+"s="+f.encodeURIComponent()+"&canary="+$SAConfig.can.encodeURIComponent()+"&saii="+$ic.ic.getICNamespaceCount("wnit")+"&pt="+d.encodeURIComponent()+"&wnint="+$SAConfig.wn.encodeURIComponent();$Network.fetchXML(I(e),SA_postReturn,"POST",a,c);SA_stat.p=true;$SA.setPostState(true)};a.IsFirefoxPaste=function(b){if(b.srcElement.id!="SAInput"||!$B.Firefox)return false;var a=false;if(b.srcElement.value.length-_lastPsmValue.length>5)a=true;return a};a.showErr=function(b,a){if(SA_stat.d)return;_ge("SAErr").style.display="none";if(s){_ge("SAErrMsg").innerHTML=s;s=""}if(b){if(a){s=_ge("SAErrMsg").innerHTML;_ge("SAErrMsg").innerHTML=a}_ge("SAErr").style.display="block"}}};function SA_UrlDisable(a){if(SA_stat.d)return;_ge("SAUrlInput").disabled=a;_ge("SAUrlTitle").disabled=a;_ge("SAUrlSummary").disabled=a;if(a)$SA.DisablePaging();else $SA.EnablePaging()}function SA_Inactive2(){if(SA_stat.d)return;var a=_ge("SAInput");a.value="";a.rows=1}SA_Text=function(a){if(SA_stat.p||SA_stat.rc||SA_stat.d)return;if(!SA_KeyCheck(a))SA_InText(a)};SA_KeyCheck=function(a){if(SA_stat.p||SA_stat.rc||SA_stat.d)return false;var b=a.keyCode;if(b==27&&!$SAConfig._BadgeModel){$SA.inactive();return true}else if(b==13){if(!SA_stat.tid)$SA.startPost();else if(a.srcElement.id=="SAUrlInput"&&!_ge("SABtn").disabled){$SA.LoadUrlPreview();a.returnValue=true}else a.returnValue=false;return true}else if(b==32&&a.srcElement.id=="SAInput")setTimeout($SA.AutoDetectUrl,0);return false};SA_InText=function(a){if(SA_stat.d)return;$SA._focusedTextAreaId=a.srcElement.id;if(SA_stat.p||SA_stat.rc||SA_stat.b)return;if(a.type=="propertychange"&&a.propertyName!="value")return;if(a.type=="paste"||$SA.IsFirefoxPaste(a))setTimeout($SA.AutoDetectUrlOnPaste,0);if(a.srcElement.id=="SAInput")_lastPsmValue=a.srcElement.value;setTimeout($SA.recalc,0)};SA_CheckUrlInput=function(a){if(SA_stat.p||SA_stat.d)return;if($B.IE&&a.propertyName!="value")return;var b=a.srcElement.value.trim();SA_KeyCheck(a)};function SA_getPsm(){if(SA_stat.d)return;var b=_ge("SAInput"),a;if(b.getAttribute("helper")=="help")a="";else{a=b.value.trim();a=a.replace(/[\r\n]/g," ")}return a}SA_postReturn=function(d){if(SA_stat.d)return;SA_stat.p=false;$SA.setPostState(false);var a=SA_Code.GeneralError,f="",h="",i="",e=false;try{e=d&&(d.status==200||d.status==500)}catch(k){e=false}if(e){var c=d.responseText,g=c.length;if(c&&g>0){var b=c.split("^",3);a=parseInt(b[0]);if(isNaN(a))a=SA_Code.GeneralError;else if(b.length==3){f=b[1].replace(/\*2/g,"^").replace(/\*1/g,"*");h=b[2].replace(/\*2/g,"^").replace(/\*1/g,"*");var j=b[0].length+b[1].length+b[2].length+3;if(j<=g)i=c.substring(j)}else if(a==SA_Code.Success)a=SA_Code.GeneralError}}$SA.showErr(a,f);if(a==SA_Code.Success){SA_changePSM(f,h,SA_getPsm());$SA.inactive();SA_WNIns(i);if($SAConfig._BadgeModel){$SAConfig._BadgeHasShared=true;_ge("SAInactive").style.cursor="default"}}};SA_changePSM=function(g,d,h){var c=_ge("SANoPsm"),e=_ge("SAPsm"),b=_ge("SAPsmLC");if(!g){c.style.display="block";e.style.display="none"}else{if(d){b.innerHTML=d;b.style.display=$SA._strTableCell}else b.style.display="none";var a=_ge("SA_PSMin"),f=a.parentElement;if($B.Firefox)f.removeChild(a);a.innerHTML=g;if($B.Firefox)f.appendChild(a);a.title=h;c.style.display="none";e.style.display=$B.IE?"block":"table"}};SA_WNIns=function(a){if($SAConfig.wn=="true"&&window.$wn&&$wn.insertTop&&a)$wn.insertTop(a)};$Do.register("$SA.initialize",$SA.initialize);registerNamespace("$SA");new function(){var d=$SA,b=true;d.activeRO=function(){var k="SAInactive",j=_ge(k),i,p="SA_PSMURLin";if(j.style.display=="none")return false;if(event){var d=event.srcElement;while(d&&d.id!=k){if(d.nodeName=="A"&&(d.id==p||d.parentElement.id=="SA_PSMin")){i=true;break}d=d.parentElement}}if(i)return false;SA_liteupArea(false);if(b){var n={SACloseImg:$SAConfig.themeBase+"hig/img/glyph/close_rest_dark.gif"},g="prev",h="next";if($B.rtl){g="next";h="prev"}var o={SAthumbLoad:$SAConfig.imgBase+"wn/progress_loading_2.gif",SAThumbLeftImgOff:$SAConfig.imgBase+"sa/"+g+"-ina.png",SAThumbRightImgOff:$SAConfig.imgBase+"sa/"+h+"-ina.png",SAThumbLeftImg:$SAConfig.imgBase+"sa/"+g+"-act.png",SAThumbRightImg:$SAConfig.imgBase+"sa/"+h+"-act.png",SAErrImg:$SAConfig.imgBase+"sa/err16.gif",SAShareImg:$SAConfig.imgBase+"wn/progress_loading_2.gif",SALoadingImg:$SAConfig.imgBase+"wn/progress_loading_2.gif"};a(n);var f=Object.fromJSON($SAConfig.imgStrips);if(f)for(var l in f){var e=f[l],m=$IS.Create(e.x,e.y,e.w,e.h,$SAConfig.imgBase,e.img,e.alt);_ge(l).appendChild(m)}if($B.IE_M6)setTimeout(c,0);a(o)}b=false;j.style.display="none";_ge("SAActive").style.display="";return true};function a(a){for(var b in a){var c=_ge(b);if(c)c.src=a[b]}}function c(){var a=_ge("SACtrl");a.className=a.className}};SA_liteupArea=function(c){if(SA_stat.d)return;var a=_ge("SAInactive"),b="SAHover";if(a.style.display!="none")if(c)$css.add(a,b);else $css.remove(a,b)};function SAShowPhoto(){_ge("SARem").innerHTML=$SAConfig.strRemPhoto.encodeHtml();try{_ge("SAPhotoInput").focus()}catch(a){}$SA.blur(_ge("SAInput"));SAPhotoCheck()}function SAClearPhoto(){var a=_ge("SAPhotoInput").parentElement;a.innerHTML=a.innerHTML;_ge("SABtn").disabled=false}function SAPhotoCheck(a){if(a&&a.type=="propertychange"&&a.propertyName!="value")return;if(_ge("SAPhotoInput").value.length>0)_ge("SABtn").disabled=false;else _ge("SABtn").disabled=true}function SAPhotoDisable(a){_ge("SAPhotoInput").disabled=a}function SAShowDoc(){_ge("SARem").innerHTML=$SAConfig.strRemDoc.encodeHtml();try{_ge("SADocInput").focus()}catch(a){}$SA.blur(_ge("SAInput"));SADocCheck()}function SAClearDoc(){var a=_ge("SADocInput").parentElement;a.innerHTML=a.innerHTML;_ge("SABtn").disabled=false}function SADocCheck(a){if(a&&a.type=="propertychange"&&a.propertyName!="value")return;if(_ge("SADocInput").value.length>0)_ge("SABtn").disabled=false;else _ge("SABtn").disabled=true}function SADocDisable(a){_ge("SADocInput").disabled=a}function SAUploadImage(g){if(SA_stat.d)return;var e=false,d=_ge(g),f=_ge("SAHide"),a,c=document.createElement("div");SA_stat.skyID=Math.floor(Math.random()*1e4);c.id="SAiframeC";c.innerHTML='<iframe id="SAiframe" name="SAimageUploadFrame" class="SAiframe"></iframe>';var b=SA_getPsm();if(b.length>255){b=b.substring(0,254);b+=""}d.elements["caption"].value=b;d.elements["id"].value=SA_stat.skyID;d.target="SAimageUploadFrame";a=c.firstChild;a.src="about:blank";if($B.IE)a.onreadystatechange=SAIframeEvent;else a.onload=SAIframeEvent;f.appendChild(c);try{d.submit()}catch(h){$SA.showErr(SA_Code.GeneralError);e=true;a.onload=null;a.onreadystatechange=null}if(!e){SA_stat.p=true;$SA.setPostState(true)}}function SAIframeEvent(){if(SA_stat.d)return;var a=_ge("SAiframe");if(!SA_stat.p)return;SA_stat.skyPoll=0;if($B.IE){if(a.readyState=="complete"){setTimeout(SAFrameResponse,100);a.onreadystatechange=null}}else{setTimeout(SAFrameResponse,100);a.onload=null}}function SAFrameResponse(){if(SA_stat.d)return;var b=$Cookie.getCookie("SDXPostUpload"),a=SAParseFile(b);if(SA_stat.skyPoll>9||a.match){$Cookie.deleteCookie("SDXPostUpload",$SAConfig.domain);SAUploadComplete(a)}else{SA_stat.skyPoll++;setTimeout(SAFrameResponse,100)}}function SAUploadComplete(a){if(SA_stat.d)return;var c=_ge("SAHide"),b=_ge("SAiframeC");c.removeChild(b);if(a.error){$SA.setPostState(false);SA_stat.p=false;$SA.showErr(SA_Code.GeneralError)}else{var d="&cns="+a.cns;$SA.post(d)}}function SAParseFile(c){var b={error:true,match:false};if(!c||SA_stat.d)return b;var a=c.split("|",4);if(a.length>=2){var e=a[0],f=a[1],d;if(a.length>=3)d=a[2];if(f==SA_stat.skyID){b.match=true;var g=/^OK$/i;if(g.test(e)){b.error=false;b.cns=d}}}return b}var $wn={};new function(){var b=$wn,k=false;_wnOptions=null,_options=null,_optionsText="",_optionsLink="",_wnOptionsLink="",_permissionsText="",_permissionsLink="",_wnPermissionsLink="",_optionsHandler="",_insertTopOptionClass="c_wn_opti",_itemFocusClassName="c_wn_i_of",_itemHoverClassName="c_wn_i_oh",_itemMenuOnClassName="c_wn_i_mo",_itemBottomClassName="c_wn_ibp",_itemClassName="c_wn_i",_imageNormal="",_imageAlt="",_itemWithMenuClassName="c_wn_wm",_moreClassName="c_wn_more",_disposed=false,_instanceId=1;_dynamicCanary="",_queryRandomizer=0,_menuEvents='onfocus="return $wn.menuItemOn(this);" onblur="return $wn.menuItemOut(this);"';function e(a){a=a||event;return a.target||a.srcElement}function F(a){n(a,true)}function E(a){n(a,false)}function n(b,d){var a=c(e(b));if(d)$css.add(a,_itemHoverClassName);else $css.remove(a,_itemHoverClassName);if(D(a))$css.add(a,_itemMenuOnClassName);else $css.remove(a,_itemMenuOnClassName)}function c(a,d,b){var c=b?b:d?"c_wn":_itemClassName;while(a&&!$css.has(a,c))a=a.parentNode;return a}function d(d){var c=[],b=d.getElementsByTagName("DIV");for(var a=0;a<b.length;a++)if($css.has(b[a],_itemClassName))c.push(b[a]);return c}function z(c){var b=c.getElementsByTagName("DIV");for(var a=0;a<b.length;a++)if($css.has(b[a],_itemClassName))return b[a];return null}function B(w){var l=e(w),q=l.tagName=="IMG"?l.parentNode.parentNode:l.parentNode,v=l.tagName=="IMG"?l.parentNode:l,d=c(q);if(!q.menu){var k=a(d,"n"),u=a(d,"an"),r=document.createElement("div"),m=q;menuOptions="",i=0;var s=a(d,"cid"),A=a(d,"e"),p=a(d,"ctid"),y=a(d,"ex"),z=a(d,"a");if($css.has(m,_itemWithMenuClassName)==false){r.className="c_m c_om t_hovl";$css.add(m,_itemWithMenuClassName);var h=$css.has(m,_insertTopOptionClass)?g(m):_options;for(var b in h){var j=null,o=null,n=null;if(b=="af"){if((p||s)&&k){n=" class='wn_af'";j=h[b].format(k.encodeHtml(),f(true));if(a(d,"if"))o=" style='display:none'"}}else if(b=="rf"){if((p||s)&&k){n=" class='wn_rf'";j=h[b].format(k.encodeHtml(),f(true));if(!a(d,"if"))o=" style='display:none'"}}else if(b=="n"){if(h[b]&&(s||A||p||y)&&k)j=h[b].format(k.encodeHtml())}else if(b=="a"){if(h[b]&&z&&u)j=h[b].format(u.encodeHtml())}else j=h[b];if(j)menuOptions+=["<li",n,o,'><a href="#" onclick="return $wn.doAction(\'',b,"',this)\">",j,"</a></li>"].join("");i++}m.appendChild(r);var x=_permissionsText&&_permissionsLink?'<li><a target="_top" href="'+_permissionsLink+'">'+_permissionsText+"</a></li>":"",t=_optionsText&&_optionsLink?'<li><a target="_top" href="'+_optionsLink+'">'+_optionsText+"</a></li>":"";r.innerHTML="<ul>"+menuOptions+"</ul>"+(t==""?"":'<div class="lp"><div class="line"></div></div><ul>'+x+t+"</ul>")}try{$menu.bind(w,1)}catch(B){}}if(d.refreshMenu&&v.menu){d.refreshMenu=null;v.menu.update()}return false}function D(a){var b=false;if(a)try{b=a.children[1].children[0].style.visibility=="visible"}catch(c){}return b}function a(a,b){return a.attributes?a.getAttribute(b):null}function g(f,d){var e=d?"o"+d:"o",c={},b=a(f,e).split("|");for(i=0;i<b.length;i++)c[b[i]]=window["$wn_"+b[i]];return c}b.bindOptions=function(j){var d=c(j,1);if(!d.bound){var i=$f.addEvent;_optionsText=_optionsText?_optionsText:$wn_ot;_optionsLink=_optionsLink?_optionsLink:a(d,"ov");_permissionsText=_permissionsText?_permissionsText:$wn_pt;_permissionsLink=_permissionsLink?_permissionsLink:a(d,"pv");_dynamicCanary=_dynamicCanary?_dynamicCanary:a(d,"dc");_optionsHandler=_optionsHandler?_optionsHandler:a(d,"hdlr");var f=d.getElementsByTagName("DIV"),b;_options=_options?_options:g(d);if(!k){_wnOptions=_options;_wnOptionsLink=_optionsLink;_wnPermissionsLink=_permissionsLink;k=true}for(b=0;b<f.length;b++)if($css.has(f[b],_itemClassName)&&!f[b].bound){i(f[b],"onmouseover",F);i(f[b],"onmouseout",E);f[b].bound=true}var e=d.getElementsByTagName("A");for(b=0;b<e.length;b++)if($css.has(e[b],"c_wn_ito")&&!e[b].bound){i(e[b],"onfocus",$wn.menuOn);i(e[b],"onblur",$wn.menuOut);i(e[b],"onclick",B);var h=new Image;h.src=_imageNormal=$wn_oi;h.alt=_imageAlt=$wn_oa;h.title=h.alt;h.className="c_wn_i_opt";e[b].appendChild(h);e[b].bound=true}d.bound=true}return false};b.doAction=function(d,p){var e="",o="none",r=new Image,b=c(p),f;if(d=="d"){b.style.display=o;var m=c(p,0,"wn_ins");if(m){var g=b.parentElement;while(g&&g!=m){g.style.display=o;g=g.parentElement}}var q=a(b,"a");e=a(b,d)+"&a="+q;f="d"}else if(d=="n"){var k=["ctid","cid","e","ex"];for(var j=0;j<k.length;j++){var i=a(b,k[j]);if(i){h(b,k[j],i);e=k[j]+"="+i.encodeURIComponent();break}}f="bu"}else if(d=="a"){var i=a(b,"a");s(b);h(b,"a",i);e="a="+i;f="ba"}else if(d=="af"||d=="rf"){var l=a(b,"cid"),n=a(b,"ctid");if(!l)e="ctid="+n;else e="cid="+l;$wn.updateFavoriteUI(b,n,l,d=="af");f=d}r.src=_optionsHandler+"?dc="+_dynamicCanary+"&"+e+"&act="+f+"&r="+_queryRandomizer++;$menu.closeCurrent();return false};function h(g,f,h){var e=d(c(g,true));for(var b=0;b<e.length;b++)if(e[b]&&a(e[b],f)==h)e[b].style.display="none"}function s(d){if(window.$wn_afmf){var b=$("wn_afm");if(b)b.parentNode.removeChild(b);var c=a(d,"an"),i=c?c.encodeURIComponent().encodeHtml():"";c=c?c.encodeHtml():"";var h=a(d,"a"),f=a(d,"cid");f=f?f:"";var e="",g=$css.getCN("c_wn_itc","div",d);if(g&&g.length>0){e=g[0].innerText;e=e?e.encodeURIComponent().encodeHtml():""}if(c&&h){var j=$wn_afmf.replace(/{appname}/g,c.encodeHtml()).replace(/{ai}/g,h).replace(/{cid}/g,f).replace(/{at}/g,e).replace(/{anp}/g,i);b=document.createElement("div");d.parentNode.insertBefore(b,d);b.id="wn_afm";b.className="c_wn_afm";b.innerHTML=j}}}b.menuOn=function(d){var a=e(d),b=c(a);$css.add(b,_itemFocusClassName)};b.menuOut=function(d){var b=e(d),a=c(b);$css.remove(a,_itemMenuOnClassName);$css.remove(a,_itemFocusClassName)};b.menuItemOn=function(a){b.menuOn(a);var d=c(a);$css.add(d,_itemMenuOnClassName)};b.menuItemOut=function(a){b.menuOut(a);var d=c(a);$css.remove(d,_itemMenuOnClassName)};b.viewMore=function(b){if(window.$wn_ld||_disposed)return;$wn_ld=true;var a=$("wn");if(b)t(a,b);else b=$("wn_viewmore");if(b){var e=p(a,"vmh"),f=b.parentElement,c=x(a),h=!c?"GET":"POST",g=o(a,f);function d(b){l(a,g,b,true)}try{$Network.fetchXML(e,d,h,c)}catch(i){d(null)}}};function t(g,f){var c=g.getElementsByTagName("A"),d=false;for(var b=c.length-1;b>=0;b--)if(c[b]==f)d=true;else if(d){var a=c[b],e=false;while(a&&a.nodeType!=9){if(a.currentStyle.display=="none"||a.currentStyle.visibility=="hidden"){e=true;break}a=a.parentNode}if(!e){try{c[b].focus()}catch(h){}break}}}function x(g){var c=[],h=0,f=d(g);for(var b=0;b<f.length;b++){var e=a(f[b],"aid");if(e)c[h++]=e}return c.join(",")}b.insertTop=function(h){if(!window.$wn_ld){var b=$("wn_nodata"),a=$("wn_insc"),f=c(a,1),e=document.createElement("div"),g=d(f);$css.remove(g[0],"c_wn_fitm");if(b!=null&&b.style!=null)b.style.display="none";if(a.hasChildNodes())a.insertBefore(e,a.firstChild);else a.appendChild(e);$Utility.ajaxInnerHtml(e,h);a.style.display="block";f.bound=false}};b.Load=function(g,c){if(_disposed||window.$wn_ld)return;$wn_ld=true;var b=$("wn"),e=$("wn_insc");if(e){e.innerHTML="";e.style.display="none"}if(g)A(g,b);else c=a(b,"f");w(b,c=="me");q();b.setAttribute("f",c?c:"");var d=$("wn_itms");if(d==null)d=$("wn_err");var j=d.offsetHeight,f=o(b,d);f.style.height=j-13+"px";var i=p(b,"alh",c);function h(a){l(b,f,a,false)}try{$Network.fetchXML(i,h,"GET")}catch(k){h(null)}};function q(){if(window.$ic&&$ic.ic){$ic.ic.removeICsFromNamespace("wn");$ic.ic.removeICsFromNamespace("wnit")}}function r(b,c){$wn_ld=false;var a=document.createElement("div");a.innerText=c;a.id="wn_err";$css.add(a,"c_wn_err");$css.add(a,"ErrorMed");b.parentNode.replaceChild(a,b)}function A(f){if(_disposed)return;var a=f.parentNode,g=c(a,0,"c_wn_fl"),d=g.getElementsByTagName("li");for(var b=0;b<d.length;b++)$css.remove(d[b],"c_wn_fls");if(!$css.has(a.parentNode,"c_wn_fl")){var e=$("wn_other");$css.add(e.parentNode,"c_wn_fls")}$css.add(a,"c_wn_fls");$menu.closeCurrent()}function p(f,e,c){var b=a(f,e);b+="&ii="+$ic.ic.getICNamespaceCount("wn");b+="&wii="+_instanceId++;var d=$ic.ic.getICNamespaceCount("cmtc");b+="&cindx="+d;if(c=="me"){b=b.replace("w=1","w=0");b=b.replace("im=bap","im=da")}else if(c=="recent")b=b+"&re=1";else if(c)b=b+"&tf="+c;return b}function o(d,b){var c=$wn_le,a=document.createElement("div");if(b)b.parentNode.replaceChild(a,b);else d.appendChild(a);a.innerHTML=c;a.id="wn_loading";$css.add(a,"c_wn_loading");return a}function l(f,i,c,k){var n=!c||c.status!=200||!c.responseText||c.responseText.indexOf("c_wn_")<0?true:false;if(_disposed)return;if(n)r(i,$wn_em);else{var b=document.createElement("div");$css.add(b,"c_wn_vm");i.parentNode.replaceChild(b,i);$Utility.ajaxInnerHtml(b,c.responseText);if(!k)b.id="wn_itms";if(b.firstChild){wnEl=$("wn_aa");if(wnEl){if(k){var j=d(f),l=z(wnEl);if(l!=null){var g=-1;for(var e=0;e<j.length;e++)if(j[e]==l){g=e-1;break}if(g>=0)$css.add(j[g],_itemBottomClassName)}}wnEl.id="";var o=f.setAttribute("vmh",a(wnEl,"vmh")),h=$("wn_vmc_aa");if(h){h.id="";if(k){var m=$("wn_itms");m.appendChild(h)}}f.bound=false}}else r(b,$wn_em);$wn_ld=false}}function w(b,c){if(c){_options=g(b,"ra");_permissionsLink=a(b,"pvra");_optionsLink=a(b,"ovra")}else{_options=_wnOptions;_permissionsLink=_wnPermissionsLink;_optionsLink=_wnOptionsLink}}function v(i){if(_disposed)return;var a=i.srcElement,d=document.getElementById("wn");while(a&&a.tagName!="A"&&a!=d)a=a.parentNode;if(a&&a!=d){var f=$wn_expUrl.replace("{0}","SUP_Click"),e=d.getElementsByTagName("A");if(window.$Beacon){var g=-1;for(var c=0;c<e.length;c++)if(e[c]==a){g=c;break}var h=a.href?a.href:"#",b={};b["LinkId"]=g;b["LinkUrl"]=h;if(a.href&&a.href!="#")$Beacon.fireAndHold(f,b);else $Beacon.fire(f,b)}}}function j(){$Beacon.fire($wn_expUrl.replace("{0}","SUP_PV"))}b.RecordComment=function(a){if(window.$wn_inExp)$Beacon.fire($wn_expUrl.replace("{0}","SUP_Comment"),a)};b.InitExp=function(){if(_disposed)return;if($BSI.isLoading())$BSI.addLoadedCallback(j);else j();var a=document.getElementById("wn");$f.addEvent(a,"onclick",v)};b.Dispose=function(){if(_disposed)return;_disposed=true;q();if(window.$Comments&&$Comments.Dispose)$Comments.Dispose();var b=$("wn");if(b){if(window.$IS&&window.$IS.disposeAll)$IS.disposeAll(b);var e=b.getElementsByTagName("IMG");for(var a=e.length-1;a>=0;a--)e[a].parentNode.removeChild(e[a]);var c=b.getElementsByTagName("OBJECT");for(var a=c.length-1;a>=0;a--)c[a].parentNode.removeChild(c[a]);var d=b.getElementsByTagName("EMBED");for(var a=d.length-1;a>=0;a--)d[a].parentNode.removeChild(d[a])}$wn=null};b.SLImages=function(){if(window.$wn_id&&$wn_id>0)setTimeout(C,$wn_id)};function C(){var d=$("wn");if(d){var a=d.getElementsByTagName("IMG");for(var b=a.length;b--;){var c=a[b].getAttribute("SRCTO");if(c){a[b].setAttribute("SRCTO","");a[b].src=c;a[b].setAttribute("SRC",c)}}}}b.updateFavoriteUI=function(n,i,j,h,g){if(!g){var f=$("wn_afs");if(f)f.parentNode.removeChild(f)}var b=c(n);if(b){if(h){m(b);y(b,g)}else m(b);if(!g){var l=d(c(b,true));for(var k=0;k<l.length;k++){var e=l[k];if(e!=b&&(i&&a(e,"ctid")==i||j&&a(e,"cid")==j))$wn.updateFavoriteUI(e,i,j,h,true)}}u(b,h)}};function y(b,h){var e=b.getElementsByTagName("A");for(var c=0;c<e.length;c++)if($css.has(e[c],"c_wn_pn")&&window.$wn_fav){var g=new Image;g.src=$wn_fav;g.onerror="this.style.display='none'";g.className="c_wn_fav";e[c].parentNode.insertBefore(g,e[c].nextSibling)}b.setAttribute("if","1");if(!h&&window.$wn_favs){var i=a(b,"fn"),d=document.createElement("div");b.parentNode.insertBefore(d,b);d.id="wn_afs";d.className="c_wn_afs";d.innerHTML=$wn_favs.format(i,f())}}function m(d){var c=d.getElementsByTagName("IMG"),b=[];for(var a=0;a<c.length;a++)if($css.has(c[a],"c_wn_fav"))b.push(c[a]);for(var a=0;a<b.length;a++)b[a].parentNode.removeChild(b[a]);d.removeAttribute("if")}function u(d,c){var b=d.getElementsByTagName("LI");for(var a=0;a<b.length;a++){if($css.has(b[a],"wn_af"))b[a].style.display=c?"none":"block";if($css.has(b[a],"wn_rf"))b[a].style.display=c?"block":"none"}d.refreshMenu=1}function f(c){var a="",b=c?"c_wn_sfav":"c_wn_fav";if(window.$wn_fav)a='<img class="'+b+'" onerror="this.style.display=\'none\'" src="'+$wn_fav+'"/>';return a}b.Dismiss=function(g,e,f,d){if($wnup_dm=="c"&&d){var c="wnup",a=$Cookie.getCookie(c);a=!a?{}:$Utility.deserialize(a);var h=window.location.hostname;a[d]="1";$Cookie.setCookie(c,$Utility.serialize(a),h,0,new Date(2020,0,1),1)}else if(window.$wnup_du){var b={};if(f)b["type"]=f;if(g)b["apps"]=g;if(e)b["up"]=e;$Beacon.fire($wnup_du,b)}}};window.sn_favHandler=function(b,a,d){var c=$(b);$wn.updateFavoriteUI(c,a,d,true);return true};$wn.SLImages();$Do.register("$wn.Load",$wn.Load);$Do.register("$wn.InitExp",$wn.InitExp);$Do.register("$wn.RecordComment",$wn.RecordComment);$Do.register("$wn.Dismiss",$wn.Dismiss);$Do.register("$wn.viewMore",$wn.viewMore);registerNamespace("$wnWav");new function(){var k=1600,m=1200,p=640,n=480,h=75,g="WhatsNewDialogContents",a=null,e=false,d=null,c=null;$wnWav.show=function(c){if(!e){e=true;var b=_ce("div");b.className="UI_Dialog_Contents";b.id=g;b.innerHTML=c;b.style.color="#fff";b.style.backgroundColor="#000";a=new $UI.Dialog(true,null,true,"wnWav");a.setContents(b);i();f();a.show();window.attachEvent("onunload",l)}};$wnWav.close=function(){b();a.minimize();a.hide();a.dispose();a=null;e=false;if(d)d.focus()};function i(){window.attachEvent("onresize",f);document.attachEvent($B.RE_WebKit?"onkeydown":"onkeypress",j)}function b(){window.detachEvent("onresize",f);document.detachEvent($B.RE_WebKit?"onkeydown":"onkeypress",j)}function l(){window.detachEvent("onunload",l);b()}function j(a){switch(($B.RE_WebKit?a:event).keyCode){case 27:$wnWav.close()}}function f(){b();var d=document.documentElement.clientWidth,j=document.documentElement.clientHeight,l=k/m,c=Math.min(d-h*2,k),e=Math.max(Math.min(Math.floor(c/l),j-h*2),n);c=Math.floor(e*l);var f=Math.max(Math.floor((d-c)/2),0);if(document.body.className.indexOf("rtl")>-1)f=Math.min(f,d-c);var o=($B.RE_WebKit?document.body:document.documentElement).scrollTop,q=Math.max(Math.floor((j-e)/2)+o,o);a.dock.y=q;a.dock.x=f;var p=_ge(g).style;p.pixelWidth=c;p.pixelHeight=e;i();a.recalc()}function o(a){while(a&&!$css.has(a,"c_wn_i"))a=a.parentNode;return a}$wnWav.getBaseUrl=function(a){if(a)return "/Handlers/WavEmbed.mvc";else return $wn_we};$wnWav.popoverSlideshow=function(a,j,e){if(!IsRequiredSilverlightVersionInstalled())return true;else $wnWav.show("<div id='WhatsNewDialogInnerContents' style='height:100%'><table style='height:100%;width:100%;text-align:center;vertical-align:middle'><tr><td>"+$wn_le+"</td></tr></table></div>");d=a;c=a.href;var b=o(a),k=b.getAttribute("a"),i=b.getAttribute("alid"),h=$wnWav.getBaseUrl(e),f="app="+k.encodeURIComponent()+"&album="+i.encodeURIComponent()+"&photo="+j.encodeURIComponent(),g={"Content-Type":"application/x-www-form-urlencoded"};$Network.fetchXML(h,$wnWav.popoverSlideshowCallback,"POST",f,g);return false};$wnWav.ps1=function(b,a){return $wnWav.popoverSlideshow(b,a,false)};$wnWav.ps3=function(b,a){return $wnWav.popoverSlideshow(b,a,true)};$wnWav.popoverSlideshowCallback=function(a){if($("WhatsNewDialogInnerContents"))if(a.status==200&&a.responseText.startsWith("<!--WAVPopover-->"))$Utility.ajaxInnerHtml($("WhatsNewDialogInnerContents"),a.responseText);else if(window.self!=window.top)window.top.location=c;else window.location=c}};IsRequiredSilverlightVersionInstalled=function(){var b="4.0.50401",a=null;return function(){if(a!=null)return a;else return a=Silverlight.isInstalled(b)}}();if(!window.Silverlight)window.Silverlight={};Silverlight.isInstalled=function(b){if(b==undefined)b=null;var a=false,l=null;try{var i=null,j=false;if(window.ActiveXObject)try{i=new ActiveXObject("AgControl.AgControl");if(b===null)a=true;else if(i.IsVersionSupported(b))a=true;i=null}catch(m){j=true}else j=true;if(j){var k=navigator.plugins["Silverlight Plug-In"];if(k)if(b===null)a=true;else{var h=k.description;if(h==="1.0.30226.2")h="2.0.30226.2";var g=h.split(".");while(g.length>4)g.pop();var d=b.split(".");while(d.length>4)d.pop();var c,f,e=0;do{c=parseInt(d[e]);f=parseInt(g[e]);e++}while(e<d.length&&c===f);if(c<=f&&!isNaN(c))a=true}}}catch(m){a=false}return a};var $WebSecurity={};$WebSecurity.FlashDetection=new function(){var h=window["$Config"]||{},a=h.Flash,c=false,b=false;this.HasFlash=function(){if(!c){try{b=1==$Cookie.getSessionCookie(a.Cookie)||g(a.Major,a.Min,a.Rev)}catch(d){b=false}if(b)$Cookie.setSessionCookie(a.Cookie,1);c=true}return b};this.HandleEmbedCode=function(f,e){var b=$(f);if(!b||!b.parentNode)return;var c;if(this.HasFlash())try{var d=_d.createElement("span");d.innerHTML=e;c=d.firstChild;c.setAttribute("wmode","opaque",0)}catch(g){}else{c=_d.createElement("span");c.innerHTML=a.NoFlashHtml}b.parentNode.insertBefore(c,b);b.parentNode.removeChild(b)};this.DetectNow=function(){if(a&&window.flObj)for(var b in window.flObj)this.HandleEmbedCode(b,window.flObj[b])};function d(){var a=null;try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),b=c.GetVariable("$version"),d=b.split(" ");a=d[1].split(",")}catch(e){}return a}function e(){var d=null;if(null!=navigator.plugins&&0<navigator.plugins.length&&(!!navigator.plugins["Shockwave Flash 2.0"]||!!navigator.plugins["Shockwave Flash"])){var g=navigator.plugins["Shockwave Flash 2.0"]?"Shockwave Flash 2.0":"Shockwave Flash",e=navigator.plugins[g].description,a=e.split(" "),b=a[2].split("."),f=""!=a[3]?a[3]:a[4],c=f.split("r");d=[b[0],b[1],c[1]>0?c[1]:0]}return d}function f(){if(null!=navigator.plugins&&0<navigator.plugins.length)return e();else if($B.IE_Win)return d();return null}function g(b,c,d){var a=f();if(!a)return false;if(a[0]>b)return true;else if(a[0]==b)if(a[1]>c)return true;else if(a[1]==c)return a[2]>=d;return false}};$WebSecurity.FlashDetection.DetectNow();$UI.FramePopup=function(){var d=this,a=new $Memory.Groups,b={tabIndex:-1};if(location.protocol=="https:")if(!window.g_UI_FramePopupUrl)b.src=$Config.baseUrl+"empty.htm";else b.src=g_UI_FramePopupUrl;var c=a.create(null).Nodes.create("iframe",b,{position:"absolute",left:"0px",top:"0px",display:"block",width:"100%",height:"100%"},document.body);this.dispose=function(){if(a){a.dispose();a=null}};this.positionAt=function(b,d){var a=c.style;a.pixelTop=b.y;a.pixelLeft=b.x;a.height=b.height;a.width=b.width;a.zIndex=d};this.minimize=function(){c.style.display="none"};this.restore=function(){c.style.display="block"}};$Network.Fpp=function(p_strUrl,cfg){var defaultRetry=2,p_enumFlags=0,oFppHeaders={};oFppHeaders["Content-Type"]="application/x-www-form-urlencoded";if(typeof cfg=="undefined")cfg={};if(typeof cfg.ServerTunnelingUrl=="string"&&(typeof cfg.UseClientXmlProxy=="undefined"||cfg.UseClientXmlProxy==false))oFppHeaders["FPPRPURL"]=cfg.ServerTunnelingUrl;cfg.CommandType=cfg.CommandType||0;cfg.Version=cfg.Version||0;cfg.PartnerId=cfg.PartnerId||0;cfg.SessionId=cfg.SessionId||"";cfg.AuthUser=cfg.AuthUser||"";if(Object.isNumber(cfg.DefaultRetry))defaultRetry=cfg.DefaultRetry;if(Object.isBoolean(cfg.Notify)&&cfg.Notify)p_enumFlags=p_enumFlags|$Network.Flags.NOTIFY;if(Object.isBoolean(cfg.UseClientXmlProxy)&&cfg.UseClientXmlProxy)p_enumFlags=p_enumFlags|$Network.Flags.CLIENTPROXY;if(Object.isBoolean(cfg.AllowDuplicate)&&cfg.AllowDuplicate)p_enumFlags=p_enumFlags|$Network.Flags.DUPLICATE;oFppHeaders["X-FPP-Command"]=cfg.CommandType;function FppFinished(proxy,obj){$Network.Events.onfinished.fire(obj);var pkg={ErrorCode:0,Context:obj.context,Proxy:proxy,Error:null};obj.bRetry=false;try{if(proxy==null)pkg.ErrorCode=-4;else if(proxy.statusText==null||proxy.statusText=="")pkg.ErrorCode=-5;else if(proxy.status!=200&&proxy.status!=500)pkg.ErrorCode=-7}catch(a){pkg.ErrorCode=-5}if(pkg.ErrorCode!=0){if(++obj.nRetry<=defaultRetry){obj.bRetry=true;return}if(obj.cbErr)obj.cbErr(pkg.ErrorCode,pkg.Context,pkg.Proxy,pkg.Error);$Network.Events.onerror.fire(pkg)}else{try{var strUrl=proxy.getResponseHeader("FPPRPURL");if(strUrl!=""&&strUrl!=null)oFppHeaders["FPPRPURL"]=strUrl}catch(a){}try{var oFppPkg;if(cfg.CommandType==0)oFppPkg=eval(proxy.responseText);else if(cfg.CommandType==1)oFppPkg=eval("("+proxy.responseText+")");$Network.Events.onprofile.fire(oFppPkg.ProfilingInfo);if(oFppPkg.Status==0){var arrArgs=oFppPkg.OutRefParams;arrArgs.unshift(obj.context);arrArgs.unshift(oFppPkg.Value);obj.callback.apply(null,arrArgs)}else{pkg.ErrorCode=oFppPkg.Status;pkg.Error=oFppPkg.Error;if(obj.cbErr)obj.cbErr(pkg.ErrorCode,pkg.Context,pkg.Proxy,pkg.Error);$Network.Events.onerror.fire(pkg)}}catch(a){pkg.ErrorCode=-6;pkg.Error=a;if(++obj.nRetry<=defaultRetry){obj.bRetry=true;return}if(obj.cbErr)obj.cbErr(pkg.ErrorCode,pkg.Context,pkg.Proxy,pkg.Error);$Network.Events.onerror.fire(pkg)}}obj.bRetry=false}this.invoke=function(b,e,f,p,d,n,o,i,a,h){if(e==null||f==null||d==null)throw new Error("invalid arguments for $Network.Fpp");if(typeof d!="function")throw new Error("$Network.Fpp arg list mismatch:  cb must be of type function.");if(!h)h=Array.$Prioritizer.Priorities.High;var j="cn="+e+"&mn="+f+"&d="+p+"&v="+cfg.Version,k,c,g=$Network.defaultTimeout,m={context:n,callback:d,cbErr:o,bRetry:false,nRetry:0,bSave:false},l=p_strUrl.indexOf("?")>0?"&":"?";if(b==$Network.Type.XMLPost){k=j;c="{0}{1}cnmn={2}.{3}&ptid={4}&a={5}&au={6}".format(p_strUrl,l,e,f,cfg.PartnerId,cfg.SessionId,cfg.AuthUser)}else if(b==$Network.Type.XMLGet)c="{0}{1}{2}&ptid={3}&a={4}&au={5}".format(p_strUrl,l,j,cfg.PartnerId,cfg.SessionId,cfg.AuthUser);if(a)$Network.abortGroup(a);if(i)g=i;return $Network.fetch(FppFinished,(new $Request(c,b,p_enumFlags,m)).setHeaders(oFppHeaders).setPostString(k).setTimeout(g).setGroup(a).setCanary(cfg.CanaryToken))}};$Network.FppProxy=function(d){var c=this,b,a;this.initialize=function(h,d,e,f,a,b){var g={Version:0,CommandType:0,PartnerId:d,SessionId:e,ServerTunnelingUrl:f,UseClientXmlProxy:a,CanaryToken:b};return c.initializeEx(h,g)};this.initializeEx=function(e,d){b=new $Network.Fpp(e,d);a=d;return c};function f(e,b){function c(){var c={},g=b.length;for(var f=0;f<g;f++)c[b[f]]=arguments[f];c.toString=function(i){var f=[];if(a.CommandType==0&&i)f.push(d,".",e,":");f.push("{");for(var h=0;h<g;h++){if(a.CommandType==1)f.push(typeof b[h].toString()=="undefined"?b[h].type:b[h].toString(),":");f.push(b[h].escape(c[b[h]],a.Version,a.CommandType==0),",")}if(g>0)f.pop();f.push("}");return f.join("")};c.__isFppObject=true;return c}return c}function e(f,c,e,g,d){function h(){var j=[],i=c.length;for(var h=0;h<i;h++){if(a.CommandType==1)j.push(typeof c[h].toString()=="undefined"?c[h].type:c[h].toString(),":");j.push(c[h].escape(arguments[h],a.Version,a.CommandType==0),",")}if(i>0)j.pop();return b.invoke(e||$Network.Type.XMLPost,d,f,j.join(""),arguments[i],arguments[i+1],arguments[i+2],arguments[i+3],g)}return h}this.rfc=this.registerFppClass=function(a,b){this[a]=f(a,b)};this.rfm=this.registerFppMethod=function(a,g,d,c,f,b){this[a]=e(d||a,g,c||$Network.Type.XMLPost,f,b||strDefaultNamespace)};this.seal=function(){this.rfc=this.registerFppClass=this.rfm=this.registerFppMethod=this.seal=null}};new function(){var a=$Network.FppProxy;a.TypeSystem=function(b,a){this.toString=function(){return a};this.type=b;return this};a.dateToISO8601=function(b){var f="{0}-{1}-{2}T{3}:{4}:{5}",e=b.getHours(),c=b.getMinutes(),d=b.getSeconds();if(e<10)e="0"+e;if(c<10)c="0"+c;if(d<10)d="0"+d;return a.escape(f.format(b.getFullYear(),b.getMonth()+1,b.getDate(),e,c,d))};a.arrayToString=function(c,g,e){var f="";if(c==null)return f;if(Object.isArray(c)){var b=[];b.push("[");for(var d=0;d<c.length;d++){b.push(a.objToStringImpl(c[d],g,e));b.push(",")}if(c.length>0)b.pop();b.push("]");return b.join("")}else throw new Error("p_array = "+c+" is not an array");};a.escape=function(a,c){if(a==null)return a;else{var b="";if(c==0)b=encodeURIComponent(a.toString().replace(/([\{|\}\[|\]\,\\])/g,"\\$1"));else b=encodeURIComponent('"'+a.toString().replace(/([\{|\}\[|\]\,\\:\"])/g,"\\$1")+'"');return b}};a.objToStringImpl=function(c,e,d){var b=[];if(c==null||typeof c=="undefined"){if(d)b.push("null:");b.push("null")}else if(typeof c=="string"){if(d)b.push("System.String:");b.push(a.escape(c,e))}else if(c.constructor._typeName=="Date"){if(d)b.push("System.DateTime:");b.push(a.dateToISO8601(c))}else if(Object.isArray(c)){if(d)b.push("System.Array:");b.push(a.arrayToString(c,e,d))}else if(typeof c=="object")if(c.__isFppObject==true)b.push(c.toString(d));else{if(d)b.push("System.Collections.Hashtable:");b.push(a.objToString(c,e,d))}else{if(d)b.push("System.String:");b.push(c.toString())}return b.join("")};a.objToString=function(c,e,f){var b=["{"];for(var d in c){if(!c.hasOwnProperty(d))continue;b.push(a.escape(d,e),":",a.objToStringImpl(c[d],e,f),",")}b.pop();b.push("}");return b.join("")};a.TypeSystem.prototype.escape=function(b,c,d){if(b==null||typeof b=="undefined")return "null";switch(this.type){case "__string":return a.escape(b,c);case "__date":return a.dateToISO8601(b);case "__array":return a.arrayToString(b,c,false);case "__oArray":case "__object":return a.objToStringImpl(b,c,d);case "__primitive":case "__enum":return b;default:if(b.__isFppObject==true)return b;else return a.objToString(b,c,d)}};a.__string=function(b){return new a.TypeSystem("__string",b)};a.__date=function(b){return new a.TypeSystem("__date",b)};a.__array=function(b){return new a.TypeSystem("__array",b)};a.__oArray=function(b){return new a.TypeSystem("__oArray",b)};a.__primitive=function(b){return new a.TypeSystem("__primitive",b)};a.__object=function(b){return new a.TypeSystem("__object",b)};a.__enum=function(b){return new a.TypeSystem("__enum",b)};a.__custom=function(b,c){return new a.TypeSystem(b,c)};a.create=function(f,e){var a=window,d=f.split("."),g=d.length;for(var b=0;b<g-1;b++){var c=d[b];if(!a[c])a[c]=function(){};a=a[c]}a[d[b]]=new e};if(typeof Web!="undefined"&&Web.Network){Web.Network.Fpp=$Network.Fpp;Web.Network.FppProxy=$Network.FppProxy}var c=$Network._fppProxies;for(var b=c.length-1;b>=0;b--){var d=c[b];a.create(d.type,d.classType)}$Network._fppReady=true};$Network.registerScript("FireAnt.js")